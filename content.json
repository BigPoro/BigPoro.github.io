{"meta":{"title":"iDogçš„ç²¾ç¥æ—¶å…‰å±‹","subtitle":null,"description":"ä¸€ä¸ªè®°å½•å·¥ä½œå’Œç”Ÿæ´»çš„å°åœ°æ–¹ã€‚","author":"iDog","url":"https://bigporo.github.io","root":"/"},"pages":[{"title":"","date":"2019-04-19T08:35:22.380Z","updated":"2019-04-19T08:35:22.380Z","comments":true,"path":"404.html","permalink":"https://bigporo.github.io/404.html","excerpt":"","text":"var QZONE = window.QZONE || {}; function imagezoom(imgobj, box_w, box_h) { var src_w = imgobj.width; var src_h = imgobj.height; var r1 = src_w / src_h, r2 = box_w / box_h; var dst_w, dst_h; if (r1 > r2) { dst_w = box_w; dst_h = Math.round(dst_w / src_w * src_h); } else { if (r1 < r2) { dst_h = box_h; dst_w = Math.round(dst_h / src_h * src_w); } else { dst_w = box_w; dst_h = box_h; } } imgobj.style.marginLeft = (box_w - dst_w) / 2 + \"px\"; imgobj.style.marginTop = (box_h - dst_h) / 2 + \"px\"; imgobj.style.width = dst_w + \"px\"; imgobj.style.height = dst_h + \"px\"; imgobj.style.opacity = 1; } (function(_w, _d) { var ha = _d.head || _d.getElementsByTagName(\"head\")[0]; var $scope = {}; var current; var tmnow; var chId; var homePageUrl, homePageName; var scs = document.getElementsByTagName(\"script\"); if (location.href.indexOf(\"fm.qq.com\") > -1 || location.href.indexOf(\"fm.qzone.qq.com\") > -1) { homePageName = \"\\u8fd4\\u56de\\u4f01\\u9e45FM\"; homePageUrl = \"http://fm.qq.com\"; } else { if (location.href.indexOf(\"qzone.qq.com\") > -1) { homePageName = \"\\u8fd4\\u56de\\u6211\\u7684\\u7a7a\\u95f4\"; homePageUrl = \"http://qzone.qq.com\"; } else { homePageName = \"\\u8fd4\\u56de\\u817e\\u8baf\\u7f51\"; homePageUrl = \"http://www.qq.com\"; } } for (var i = 0;i < scs.length;i++) { if (scs[i].src.indexOf(\"404/search_children.js\") > -1) { if (scs[i].getAttribute(\"homePageUrl\")) { homePageUrl = scs[i].getAttribute(\"homePageUrl\"); } if (scs[i].getAttribute(\"homePageName\")) { homePageName = scs[i].getAttribute(\"homePageName\"); } break; } } $scope.rettext = homePageName; $scope.retlink = homePageUrl; function getData(srcUrl, callback) { var sc = _d.createElement(\"script\"); function orc() { if (sc.readyState === \"loaded\") { setTimeout(function() { callback && callback(); }, 0); } } if (sc.addEventListener) { if (callback) { sc.addEventListener(\"load\", callback, false); } } else { sc.attachEvent(\"onreadystatechange\", orc); } ha && ha.appendChild(sc); sc.src = srcUrl; } function resolveData(d) { var tid, len, ddata = [], tdata; if (\"object\" == typeof d && (d.data && (len = d.data.length))) { for (var i = 0;i < len;i++) { var expire = d.data[i].expire; d.data[i]._id = new Date * Math.random() * Math.random() * 1E7; if (expire && tmnow * 1E3 < Date.parse(expire.replace(/\\s[\\s\\S]*$/, \"\").replace(/\\-/g, \"/\"))) { var _c = d.data[i].city, _p = d.data[i].province; if (_c && city) { if ((\"_\" + _c + \"_\").indexOf(\"_\" + city + \"_\") > -1) { ddata.push(d.data[i]); continue; } } if (_p && province) { if ((\"_\" + _p + \"_\").indexOf(\"_\" + province + \"_\") > -1) { ddata.push(d.data[i]); } } } } tid = Math.floor(Math.random() * (ddata.length || len)); tdata = (ddata.length ? ddata : d.data)[chId = tid]; if (_w.foundjsondata) { tdata.ta = tdata.sex.indexOf(\"\\u5973\") > -1 ? \"\\u5979\" : \"\\u4ed6\"; tdata.name = \"\\u201c7\\u00b718\\u7279\\u5927\\u62d0\\u5356\\u5a74\\u513f\\u6848\\u201d\\u544a\\u7834\\uff0c\\u88ab\\u89e3\\u6551\\u768415\\u540d\\u5b69\\u5b50\\u4e2d\\uff0c2\\u4eba\\u7531\\u4eb2\\u751f\\u7236\\u6bcd\\u9886\\u56de\\uff0c\\u4ecd\\u670913\\u540d\\u5b69\\u5b50\\u672a\\u627e\\u5230\\u4eb2\\u751f\\u7236\\u6bcd\\uff0c\\u88ab\\u5b89\\u7f6e\\u5728\\u60e0\\u5dde\\u5e02\\u793e\\u4f1a\\u798f\\u5229\\u9662\\uff0c\" + tdata.ta + \"\\u662f\\u5176\\u4e2d\\u4e4b\\u4e00\\u3002\"; tdata.url = tdata.url.replace(/#p=(\\d{1,2})/, function(a, n) { return \"#p=\" + (+n + 1); }); return format(tmpl2, tdata); } if (!tdata.ext1) { tdata.ext1 = \"\\u4f46\\u6211\\u4eec\\u53ef\\u4ee5\\u4e00\\u8d77\\u5bfb\\u627e\\u5931\\u8e2a\\u5b9d\\u8d1d\"; } return tdata; } } function setTopData(tdata) { current = tdata; $scope.topname = tdata.name; $scope.topgender = tdata.sex; $scope.topbirth = tdata.birth_time; $scope.toplostdate = tdata.lost_time; $scope.toplostplace = tdata.lost_place; $scope.toplostdesc = tdata.child_feature; $scope.toplink = tdata.url; $scope.topimg = tdata.child_pic; $scope.topid = tdata._id; document.body.innerHTML = template(\"body\", $scope); } function init(data) { tmnow = data.tm_now * 1E3; var tdata = resolveData(jsondata); $scope.whichin = 0; jsondata.data.splice(chId, 1); $scope.otherdata = [tdata].concat(jsondata.data.slice(0, 5)); setTopData(tdata); } var timeout; window._Callback = function(d) { clearTimeout(timeout); init(d); }; timeout = setTimeout(function() { _Callback({tm_now:(new Date).getTime() / 1E3}); }, 2E3); _w.share = function(target) { var summary = [\"\\u80cc\\u666f\\uff1a\", current.name, \"\\uff0c\\u6027\\u522b\\uff1a\", current.sex, \"\\uff0c\\u51fa\\u751f\\u65f6\\u95f4\\uff1a\", current.birth_time, \"\\uff0c\\u5931\\u8e2a\\u65f6\\u95f4\\uff1a\", current.lost_time, \"\\uff0c\\u7279\\u5f81\\u63cf\\u8ff0\\uff1a\", current.child_feature].join(\"\"); if (summary) { summary = \"#\\u5bfb\\u627e\\u5931\\u8e2a\\u7684\\u5b9d\\u8d1d#\" + summary; } var stitle = \"\\u5931\\u8e2a\\u7684\\u5b9d\\u8d1d\\u8be6\\u60c5\"; var desc = \"\\u5931\\u8e2a\\u7684\\u5b9d\\u8d1d\\u8981\\u56de\\u5bb6\\uff0c\\u5feb\\u6765\\u53c2\\u4e0e\\u7231\\u5fc3\\u7684\\u4f20\\u9012\\u5427\\uff01\"; var encode = encodeURIComponent; var opts = {\"surl\":\"http://qzone.qq.com/gy/404/\" + current.id + \"/lostchild.html\", \"site\":\"QQ\\u7a7a\\u95f4\", \"summary\":summary || \"#\\u5b9d\\u8d1d\\u56de\\u5bb6#\\u817e\\u8baf\\u5fd7\\u613f\\u8005\\u7528\\u6280\\u672f\\u70b9\\u4eae\\u516c\\u76ca\\uff0c\\u8ba9\\u6211\\u4eec\\u4e00\\u8d77\\u5bfb\\u627e\\u8d70\\u5931\\u7684\\u513f\\u7ae5\\u5427\\uff01\", \"stitle\":stitle, \"pics\":current.child_pic, \"desc\":desc, \"origin_url\":current.url}; var surl = opts.surl || \"http://www.qq.com/404/\", summary = opts.summary || \"\\u8fd9\\u4e2a\\u662f\\u5206\\u4eab\\u7684\\u5185\\u5bb9\", stitle = opts.stitle || \"\\u8fd9\\u4e2a\\u662f\\u5206\\u4eab\\u7684\\u6807\\u9898\", pics = opts.pics || \"http://qzonestyle.gtimg.cn/qzone_v6/act/img/20120422_qzone_7_years/pop_up/icon-pop-seven-years.png\", site = opts.site || \"\\u8fd9\\u4e2a\\u662f\\u5206\\u4eab\\u94fe\\u63a5\\u7684\\u6587\\u5b57\", desc = opts.desc || \"\\u5931\\u8e2a\\u7684\\u5b9d\\u8d1d\\u8981\\u56de\\u5bb6\\uff0c\\u5feb\\u6765\\u53c2\\u4e0e\\u7231\\u5fc3\\u7684\\u4f20\\u9012\\u5427\\uff01\", origin_url = opts.origin_url || \"http://www.qq.com/404/\"; var shareList = {weibo:{method:function(evt) { var w = \"http://v.t.qq.com/share/share.php\", q = [\"?site=\", encode(surl + \"#via=share_t_weib\"), \"&title=\", encode(summary), \"&pic=\", encode(pics), \"&url=\", encode(surl)].join(\"\"), p = [w, q].join(\"\"); openit(p, \"weibo\", \"width=700, height=680, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, location=yes, resizable=no, status=no\"); }}, qzone:{method:function(evt) { var buff = [], ps = {url:surl + \"#via=404-qzoneshare\", desc:desc || \"\\u5931\\u8e2a\\u7684\\u5b9d\\u8d1d\\u8981\\u56de\\u5bb6\\uff0c\\u5feb\\u6765\\u53c2\\u4e0e\\u7231\\u5fc3\\u7684\\u4f20\\u9012\\u5427\\uff01\", summary:summary, title:stitle, pics:pics, site:site}; for (var k in ps) { buff.push(k + \"=\" + encode(ps[k] || \"\")); } var w = \"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?\" + buff.join(\"&\"), q = [\"#via=share_t_qzone\", \"&title=\", encode(summary), \"&pic=\", encode(pics), \"&url=\", encode(surl)].join(\"\"), p = [w, q].join(\"\"); openit(p, \"qzone\", \"width=700, height=680, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, location=yes, resizable=no, status=no\"); }}, sina:{method:function() { var w = \"http://v.t.sina.com.cn/share/share.php\", q = [\"?url=\", encode(surl + \"#via=share_x_weib\"), \"&title=\", encode(summary), \"&source=\", \"&sourceUrl=\", surl, \"&content=utf-8\", \"&pic=\", encode(pics)].join(\"\"), p = [w, q].join(\"\"); openit(p, \"sina\", \"toolbar=0,status=0,resizable=1,width=440,height=430\"); }}, kaixin:{method:function() { var n = \"http://www.kaixin001.com/repaste/bshare.php?rurl=\" + encode(surl + \"#via=share_kaixin\") + \"&rcontent=&rtitle=\" + encode(summary); openit(n, \"kaixin\", \"toolbar=0,status=0,resizable=1,width=600,height=360\"); }}, renren:{method:function() { var n = \"http://www.connect.renren.com/share/sharer?title=\" + encode(summary) + \"&url=\" + encode(surl + \"#via=share_renren\"), p = window.open(n, \"rr\", \"toolbar=0,status=0,resizable=1,width=510,height=300\"); if (p) { p.focus(); } }}, weixin:{method:function() { var n = \"http://qzone.qq.com/gy/404/page/qrcode.html?url=\" + encode(origin_url + \"#via=share_weixin\"), p = window.open(n, \"rr\", \"toolbar=0,status=0,resizable=1,width=620,height=430\"); if (p) { p.focus(); } }}}; var openit = function(u, n, p) { function o() { var z; if (!(z = window.open(u, n, p))) { location.href = u; } else { z.focus(); } } o(); }; shareList[target] && shareList[target].method(); }; _w.toThis = function(id) { for (var i = 0;i < $scope.otherdata.length;i++) { if ($scope.otherdata[i]._id == id) { setTopData($scope.otherdata[i]); break; } } return false; }; var meta = document.createElement(\"meta\"); meta.name = \"viewport\"; meta.content = \"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\"; ha.appendChild(meta); (function registerStyle() { var link = document.createElement(\"link\"); link.rel = \"stylesheet\"; link.type = \"text/css\"; link.href = \"https://qzone.qq.com/gy/404/style/404style.css\"; ha.appendChild(link); })(); (function initStat() { var qqDomainNameRE = /\\.qq\\.com$/i, qzoneDomainNameRE = /\\bqzone\\.qq\\.com$/i, qzsDomainNameRE = /\\bqzonestyle\\.gtimg\\.cn$/i; function cb() { var url = location.host; var src = \"\"; if (qzoneDomainNameRE.test(url)) { src = \"new404.qzone\"; } else { if (qqDomainNameRE.test(url)) { src = \"new404.qq\"; } else { if (qzsDomainNameRE.test(url)) { src = \"new404.qzonestyle\"; } else { src = url.replace(\".\", \"_\"); } } } _w.TCISD && (_w.TCISD.pv && _w.TCISD.pv(\"hat.qzone.qq.com\", \"/gy/lostchild/\" + src)); } getData(\"https://qzonestyle.gtimg.cn/ac/qzfl/stat.js\", cb); })(); })(window, document); !function() { function a(a, b) { return(/string|function/.test(typeof b) ? h : g)(a, b); } function b(a, c) { return \"string\" != typeof a && (c = typeof a, \"number\" === c ? a += \"\" : a = \"function\" === c ? b(a.call(a)) : \"\"), a; } function c(a) { return l[a]; } function d(a) { return b(a).replace(/&(?![\\w#]+;)|[\"']/g, c); } function e(a, b) { if (m(a)) { for (var c = 0, d = a.length;d > c;c++) { b.call(a, a[c], c, a); } } else { for (c in a) { b.call(a, a[c], c); } } } function f(a, b) { var c = /(\\/)[^/]+\\1\\.\\.\\1/, d = (\"./\" + a).replace(/[^/]+$/, \"\"), e = d + b; for (e = e.replace(/\\/\\.\\//g, \"/\");e.match(c);) { e = e.replace(c, \"/\"); } return e; } function g(b, c) { var d = a.get(b) || i({filename:b, name:\"Render Error\", message:\"Template not found\"}); return c ? d(c) : d; } function h(a, b) { if (\"string\" == typeof b) { var c = b; b = function() { return new k(c); }; } var d = j[a] = function(c) { try { return new b(c, a) + \"\"; } catch (d) { return i(d)(); } }; return d.prototype = b.prototype = n, d.toString = function() { return b + \"\"; }, d; } function i(a) { var b = \"{Template Error}\", c = a.stack || \"\"; if (c) { c = c.split(\"\\n\").slice(0, 2).join(\"\\n\"); } else { for (var d in a) { c += \"\\n\" + a[d] + \"\\n\\n\"; } } return function() { return \"object\" == typeof console && console.error(b + \"\\n\\n\" + c), b; }; } var j = a.cache = {}, k = this.String, l = {\"\":\"&#62;\", '\"':\"&#34;\", \"'\":\"&#39;\", \"&\":\"&#38;\"}, m = Array.isArray || function(a) { return \"[object Array]\" === {}.toString.call(a); }, n = a.utils = {$helpers:{}, $include:function(a, b, c) { return a = f(c, a), g(a, b); }, $string:b, $escape:d, $each:e}, o = a.helpers = n.$helpers; a.get = function(a) { return j[a.replace(/^\\.\\//, \"\")]; }, a.helper = function(a, b) { o[a] = b; }, \"function\" == typeof define ? define(function() { return a; }) : \"undefined\" != typeof exports ? module.exports = a : this.template = a, a(\"body\", function(a) { var b = this, c = (b.$helpers, b.$escape), d = a.retlink, e = a.rettext, f = a.topid, g = a.topimg, h = a.topname, i = a.topgender, j = a.topbirth, l = a.toplostdate, m = a.toplostplace, n = a.toplostdesc, o = a.toplink, p = b.$each, q = a.otherdata, r = (a.otheritem, a.index, \"\"); return r += ' 404\\uff0c\\u60a8\\u8bbf\\u95ee\\u7684\\u9875\\u9762\\u627e\\u4e0d\\u56de\\u6765\\u4e86\\uff0c\\u4f46\\u6211\\u4eec\\u53ef\\u4ee5\\u4e00\\u8d77\\u5e2e\\u4ed6\\u4eec\\u56de\\u5bb6\\uff01 ', r += c(e), r += ' ', r += c(h), r += '(', r += c(i), r += ') \\u51fa\\u751f\\u65e5\\u671f\\uff1a', r += c(j), r += ' \\u5931\\u8e2a\\u65f6\\u95f4\\uff1a', r += c(l), r += ' \\u5931\\u8e2a\\u5730\\u70b9\\uff1a', r += c(m), r += ' \\u5931\\u8e2a\\u4eba\\u7279\\u5f81\\u63cf\\u8ff0\\uff1a', r += c(n), r += ' \\u67e5\\u770b\\u8be6\\u60c5 \\u5206\\u4eab \\u817e\\u8baf\\u5fae\\u535a QQ\\u7a7a\\u95f4 \\u65b0\\u6d6a\\u5fae\\u535a \\u5fae\\u4fe1 ', p(q, function(a) { r += ' '; }), r += \" \", new k(r); }); }(); L2Dwidget.init({\"pluginRootPath\":\"live2dw/\",\"pluginJsPath\":\"lib/\",\"pluginModelPath\":\"assets/\",\"tagMode\":false,\"debug\":false,\"model\":{\"jsonPath\":\"/live2dw/assets/hijiki.model.json\"},\"display\":{\"position\":\"right\",\"width\":150,\"height\":300},\"mobile\":{\"show\":true},\"react\":{\"opacity\":0.7},\"log\":false});"},{"title":"å…³äºæˆ‘","date":"2019-04-19T08:40:39.000Z","updated":"2019-04-24T15:15:12.939Z","comments":true,"path":"about/index.html","permalink":"https://bigporo.github.io/about/index.html","excerpt":"","text":"17å¹´æ¯•ä¸šäºé“œé™¢ï¼Œç›®å‰å°±èŒäºå®‰å¾½é£ä¿®ç§‘æŠ€ï¼Œä¸€ä¸ªèœé¸¡iOSå¼€å‘ï¼Œæ²¡äº‹ä¹Ÿå†™å†™å°ç¨‹åºã€‚ å–œè§‚å±±æµ·ï¼Œå–œé£ŸçƒŸç«ã€‚ å¹´è½»æ— ä¸ºï¼Œå–ç ä¸ºç”Ÿã€‚"},{"title":"åˆ†ç±»","date":"2019-04-22T01:59:17.000Z","updated":"2019-04-23T16:27:49.760Z","comments":true,"path":"categories/index.html","permalink":"https://bigporo.github.io/categories/index.html","excerpt":"","text":""},{"title":"æ ‡ç­¾","date":"2019-04-22T01:58:24.000Z","updated":"2019-04-23T16:18:38.800Z","comments":true,"path":"tags/index.html","permalink":"https://bigporo.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"æ€ä¹ˆåº”å¯¹å„ç§å¯Œæ–‡æœ¬è¡¨ç°éœ€æ±‚ï¼Ÿ","slug":"æ€ä¹ˆåº”å¯¹å„ç§å¯Œæ–‡æœ¬è¡¨ç°éœ€æ±‚ï¼Ÿ","date":"2019-05-17T02:23:12.000Z","updated":"2019-05-17T03:06:02.080Z","comments":true,"path":"2019/05/17/æ€ä¹ˆåº”å¯¹å„ç§å¯Œæ–‡æœ¬è¡¨ç°éœ€æ±‚ï¼Ÿ/","link":"","permalink":"https://bigporo.github.io/2019/05/17/æ€ä¹ˆåº”å¯¹å„ç§å¯Œæ–‡æœ¬è¡¨ç°éœ€æ±‚ï¼Ÿ/","excerpt":"å‰è¨€åœ¨iOSçš„æ—¥å¸¸å¼€å‘ä¸­ï¼Œä¼šç»å¸¸ä½¿ç”¨åˆ°å¯Œæ–‡æœ¬ã€‚ ç®€å•æ¥è¯´ï¼Œå¯Œæ–‡æœ¬å°±æ˜¯ä¸€æ®µæœ‰å±æ€§çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥åŒ…å«ä¸åŒå­—ä½“ã€ä¸åŒå­—å·ã€ä¸åŒèƒŒæ™¯ã€ä¸åŒé¢œè‰²ã€ä¸åŒå­—é—´è·çš„æ–‡å­—ï¼Œè¿˜å¯ä»¥è®¾ç½®æ®µè½ã€å›¾æ–‡æ··æ’ç­‰å±æ€§ã€‚ æ­£å¸¸åœ¨ä½¿ç”¨å¯Œæ–‡æœ¬çš„æ—¶å€™ï¼Œæœ‰å¦‚ä¸‹æ–¹å¼ï¼šHTMLã€TextKitã€YYKitã€‚ä¸€èˆ¬åœ¨é•¿åˆ—è¡¨çš„åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨æ€§èƒ½æ›´é«˜ã€å†…å­˜å ç”¨æ›´å°‘çš„TextKitã€YYKitã€‚","text":"å‰è¨€åœ¨iOSçš„æ—¥å¸¸å¼€å‘ä¸­ï¼Œä¼šç»å¸¸ä½¿ç”¨åˆ°å¯Œæ–‡æœ¬ã€‚ ç®€å•æ¥è¯´ï¼Œå¯Œæ–‡æœ¬å°±æ˜¯ä¸€æ®µæœ‰å±æ€§çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥åŒ…å«ä¸åŒå­—ä½“ã€ä¸åŒå­—å·ã€ä¸åŒèƒŒæ™¯ã€ä¸åŒé¢œè‰²ã€ä¸åŒå­—é—´è·çš„æ–‡å­—ï¼Œè¿˜å¯ä»¥è®¾ç½®æ®µè½ã€å›¾æ–‡æ··æ’ç­‰å±æ€§ã€‚ æ­£å¸¸åœ¨ä½¿ç”¨å¯Œæ–‡æœ¬çš„æ—¶å€™ï¼Œæœ‰å¦‚ä¸‹æ–¹å¼ï¼šHTMLã€TextKitã€YYKitã€‚ä¸€èˆ¬åœ¨é•¿åˆ—è¡¨çš„åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨æ€§èƒ½æ›´é«˜ã€å†…å­˜å ç”¨æ›´å°‘çš„TextKitã€YYKitã€‚ WebViewåŠ è½½HTMLè¿™ä¸ªæ˜¯ä¸ªå¸¸è§„æ“ä½œ 1[self.wbView loadHTMLString:articleString baseURL:nil]; ä¸loadRequestæ–¹æ³•ç›¸æ¯”ï¼ŒloadHTMLStringå¯ä»¥ç›´æ¥è¯»å–HTMLä»£ç ï¼Œçœå»äº†ç½‘ç»œè¯·æ±‚çš„æ—¶é—´ï¼Œå±•ç¤ºé€Ÿåº¦å¾ˆå¿«ã€‚ ä¸è¿‡HTMLé‡Œé¢çš„å›¾ç‰‡èµ„æºè¿˜æ˜¯éœ€è¦é€šè¿‡ç½‘ç»œè·å–çš„ï¼Œå¦‚æœèƒ½å¤Ÿåœ¨å±•ç¤ºä¹‹å‰å°±ç¼“å­˜ä¸‹å›¾ç‰‡ï¼Œæ— éœ€ç­‰å¾…ï¼Œå°±èƒ½å¤Ÿå¿«é€Ÿçš„å±•ç¤ºäº†ã€‚ å¦‚ä½•ç¼“å­˜HTMLé‡Œé¢çš„å›¾ç‰‡åœ¨Cocoaå±‚ä½¿ç”¨NSURLProtocolå¯ä»¥æ‹¦æˆªæ‰€æœ‰HTTPè¯·æ±‚ï¼Œæ‰€æœ‰å¯ä»¥åˆ©ç”¨NSURLProtocolæ¥ç¼“å­˜æ–‡ç« ä¸­çš„å›¾ç‰‡ã€‚ æ¨èæˆ´é“­çš„è¿™ä¸ªWebé¡µé¢é¢„åŠ è½½åº“STMURLCacheæ¥é¢„ç¼“å­˜HTMLé‡Œé¢çš„å›¾ç‰‡ã€‚å…·ä½“çš„ä½¿ç”¨æ–¹æ³•éƒ½åœ¨ä»“åº“é‡Œé¢ã€‚ YYTexté›†æˆååˆ†ç®€å•ï¼Œcocoapodså°±å¯ä»¥ã€‚ä¸‹é¢çœ‹ä¸‹å¦‚ä½•ä½¿ç”¨:1234567891011121314151617181920NSMutableAttributedString *text = [NSMutableAttributedString new];UIFont *font = [UIFont systemFontOfSize:16];NSMutableAttributedString *attachment = nil; // åµŒå…¥ UIImageUIImage *image = [UIImage imageNamed:@&quot;dribbble64_imageio&quot;];attachment = [NSMutableAttributedString yy_attachmentStringWithContent:image contentMode:UIViewContentModeCenter attachmentSize:image.size alignToFont:font alignment:YYTextVerticalAlignmentCenter];[text appendAttributedString: attachment]; // åµŒå…¥ UIViewUISwitch *switcher = [UISwitch new];[switcher sizeToFit];attachment = [NSMutableAttributedString yy_attachmentStringWithContent:switcher contentMode:UIViewContentModeBottom attachmentSize:switcher.size alignToFont:font alignment:YYTextVerticalAlignmentCenter];[text appendAttributedString: attachment]; // åµŒå…¥ CALayerCASharpLayer *layer = [CASharpLayer layer];layer.path = ...attachment = [NSMutableAttributedString yy_attachmentStringWithContent:layer contentMode:UIViewContentModeBottom attachmentSize:switcher.size alignToFont:font alignment:YYTextVerticalAlignmentCenter];[text appendAttributedString: attachment]; æœ€åå¯¹æ¯”ä»£ç å¯ä»¥çœ‹åˆ°ï¼ŒåŸå§‹ä»£ç æè¿°å¯Œæ–‡æœ¬è·ŸHTMLæ¯”ï¼Œæ—¢å•°å—¦åˆå¤æ‚ã€‚HTMLä»£ç æ›´å·²è¯»ã€æ›´å®¹æ˜“ç»´æŠ¤ï¼Œæ‰€ä»¥é™¤äº†é•¿åˆ—è¡¨å¤–ï¼Œéƒ½å»ºè®®ä½¿ç”¨HTMLæ¥æè¿°å¯Œæ–‡æœ¬ã€‚","categories":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/categories/iOS/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/tags/iOS/"}]},{"title":"æ•°æ®ç»“æ„","slug":"iOSæ•°æ®ç»“æ„","date":"2019-05-16T07:01:52.000Z","updated":"2019-05-16T09:06:46.934Z","comments":true,"path":"2019/05/16/iOSæ•°æ®ç»“æ„/","link":"","permalink":"https://bigporo.github.io/2019/05/16/iOSæ•°æ®ç»“æ„/","excerpt":"æ•°æ®ç»“æ„å¸¸è§çš„æ•°æ®ç»“æ„ä¸€èˆ¬æœ‰å¦‚ä¸‹å‡ ä¸ªï¼šå­—ç¬¦ä¸²ã€æ•°ç»„ã€é“¾è¡¨ã€æ ‘ã€æ ˆã€é˜Ÿåˆ—ã€‚ä¸‹é¢åˆ†åˆ«è¯´æ˜ã€‚ å­—ç¬¦ä¸² å­—ç¬¦ä¸²æ˜¯ç”±è‹¥å¹²å­—ç¬¦ç»„æˆçš„åºåˆ—ï¼Œä½¿ç”¨é¢‘ç‡å¾ˆé«˜ï¼Œä¸ºäº†ä¼˜åŒ–ï¼Œå¾ˆå¤šè¯­è¨€éƒ½å¯¹å­—ç¬¦ä¸²åšäº†ç‰¹æ®Šçš„è§„å®šã€‚ åœ¨C/C++ä¸­ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²éƒ½ä»¥â€™\\0â€™ç»“å°¾ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾ˆå®¹æ˜“çš„æ‰¾åˆ°å­—ç¬¦ä¸²çš„å°¾éƒ¨ã€‚æ‰€ä»¥æ¯ä¸ªå­—ç¬¦ä¸²éƒ½æœ‰ä¸€ä¸ªé¢å¤–å­—ç¬¦çš„å¼€é”€ã€‚ç¨ä¸ç•™ç¥å°±ä¼šé€ æˆå­—ç¬¦ä¸²çš„è¶Šç•Œã€‚ ä¸ºäº†èŠ‚çœå†…å­˜ï¼ŒC/C++æŠŠå¸¸é‡å­—ç¬¦ä¸²æ”¾åˆ°å•ç‹¬çš„ä¸€ä¸ªå†…å­˜åŒºåŸŸã€‚å½“å‡ ä¸ªæŒ‡é’ˆèµ‹å€¼ç»™ç›¸åŒçš„å¸¸é‡å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä»¬å®é™…ä¸Šä¼šæŒ‡å‘ç›¸åŒçš„å†…å­˜åœ°å€ã€‚ä½†ç”¨å¸¸é‡å†…å­˜åˆå§‹åŒ–æ•°ç»„ï¼Œæƒ…å†µå´æœ‰æ‰€ä¸åŒã€‚","text":"æ•°æ®ç»“æ„å¸¸è§çš„æ•°æ®ç»“æ„ä¸€èˆ¬æœ‰å¦‚ä¸‹å‡ ä¸ªï¼šå­—ç¬¦ä¸²ã€æ•°ç»„ã€é“¾è¡¨ã€æ ‘ã€æ ˆã€é˜Ÿåˆ—ã€‚ä¸‹é¢åˆ†åˆ«è¯´æ˜ã€‚ å­—ç¬¦ä¸² å­—ç¬¦ä¸²æ˜¯ç”±è‹¥å¹²å­—ç¬¦ç»„æˆçš„åºåˆ—ï¼Œä½¿ç”¨é¢‘ç‡å¾ˆé«˜ï¼Œä¸ºäº†ä¼˜åŒ–ï¼Œå¾ˆå¤šè¯­è¨€éƒ½å¯¹å­—ç¬¦ä¸²åšäº†ç‰¹æ®Šçš„è§„å®šã€‚ åœ¨C/C++ä¸­ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²éƒ½ä»¥â€™\\0â€™ç»“å°¾ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾ˆå®¹æ˜“çš„æ‰¾åˆ°å­—ç¬¦ä¸²çš„å°¾éƒ¨ã€‚æ‰€ä»¥æ¯ä¸ªå­—ç¬¦ä¸²éƒ½æœ‰ä¸€ä¸ªé¢å¤–å­—ç¬¦çš„å¼€é”€ã€‚ç¨ä¸ç•™ç¥å°±ä¼šé€ æˆå­—ç¬¦ä¸²çš„è¶Šç•Œã€‚ ä¸ºäº†èŠ‚çœå†…å­˜ï¼ŒC/C++æŠŠå¸¸é‡å­—ç¬¦ä¸²æ”¾åˆ°å•ç‹¬çš„ä¸€ä¸ªå†…å­˜åŒºåŸŸã€‚å½“å‡ ä¸ªæŒ‡é’ˆèµ‹å€¼ç»™ç›¸åŒçš„å¸¸é‡å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä»¬å®é™…ä¸Šä¼šæŒ‡å‘ç›¸åŒçš„å†…å­˜åœ°å€ã€‚ä½†ç”¨å¸¸é‡å†…å­˜åˆå§‹åŒ–æ•°ç»„ï¼Œæƒ…å†µå´æœ‰æ‰€ä¸åŒã€‚ æ•°ç»„ æ•°ç»„å æ®ä¸€æ®µè¿ç»­çš„å†…å­˜å¹¶æŒ‰ç…§é¡ºåºå‚¨å­˜æ•°æ®ã€‚ åœ¨åˆ›å»ºæ•°ç»„æ—¶ï¼Œé¦–å…ˆéœ€è¦æŒ‡å®šæ•°ç»„çš„å®¹é‡å¤§å°ï¼Œç„¶åæ ¹æ®å¤§å°åˆ†é…å†…å­˜ã€‚å› æ­¤æ•°ç»„çš„ç©ºé—´æ•ˆç‡ä¸æ˜¯å¾ˆé«˜ã€‚ æ•°ç»„æ˜¯æœ‰åºçš„ï¼Œåœ¨I/Oæ“ä½œæ—¶å¯ä»¥æ ¹æ®ä¸‹æ ‡è¿›è¡Œç´¢å¼•ï¼Œæ‰€ä»¥æ—¶é—´æ•ˆç‡å¾ˆé«˜ã€‚ åŠ¨æ€æ•°ç»„ï¼šC++çš„STLä¸­çš„vectorã€‚æˆ‘ä»¬å…ˆä¸ºæ•°ç»„å¼€è¾Ÿè¾ƒå°çš„ç©ºé—´ï¼Œç„¶åå¾€æ•°ç»„ä¸­æ·»åŠ æ•°æ®ã€‚å½“æ•°æ®çš„æ•°ç›®è¶…è¿‡æ•°ç»„çš„å®¹é‡æ—¶ï¼Œæˆ‘ä»¬å†é‡æ–°åˆ†é…ä¸€å—æ›´å¤§çš„ç©ºé—´ï¼ˆSTLçš„vectoræ¯æ¬¡æ‰©å……å®¹é‡æ—¶ï¼Œæ–°çš„å®¹é‡éƒ½æ˜¯å‰ä¸€æ¬¡çš„ä¸¤å€ï¼‰ï¼ŒæŠŠä¹‹å‰çš„æ•°æ®å¤åˆ¶åˆ°æ–°çš„æ•°ç»„ä¸­ï¼Œå†æŠŠä¹‹å‰çš„å†…å­˜é‡Šæ”¾ï¼Œè¿™æ ·å°±èƒ½å‡å°‘å†…å­˜çš„æµªè´¹ã€‚ é“¾è¡¨ ç”±è‹¥å¹²ä¸ªæŒ‡é’ˆå°†è‹¥å¹²ä¸ªèŠ‚ç‚¹é“¾æ¥æˆé“¾çŠ¶ç»“æ„ï¼Œæ˜¯ä¸€ç§åŠ¨æ€çš„æ•°æ®ç»“æ„ã€‚ åˆ›å»ºé“¾è¡¨æ—¶æ— éœ€çŸ¥é“é“¾è¡¨çš„é•¿åº¦ã€‚å½“æ’å…¥ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹æ—¶ï¼Œç›´æ¥ä¸ºå…¶åˆ†é…å†…å­˜ï¼Œç„¶åè°ƒæ•´æŒ‡é’ˆçš„æŒ‡å‘ï¼Œä¿è¯æ–°çš„èŠ‚ç‚¹è¢«é“¾æ¥ä¸Šã€‚è¿™æ ·å°±æ²¡æœ‰é—²ç½®çš„å†…å­˜ï¼Œç©ºé—´æ•ˆç‡æ¯”è¾ƒé«˜ã€‚ é“¾è¡¨åœ¨è¿›è¡Œå¾ªç¯éå†æ—¶æ•ˆç‡ä¸é«˜ï¼Œä½†æ˜¯æ’å…¥å’Œåˆ é™¤æ—¶ä¼˜åŠ¿æ˜æ˜¾ã€‚ é“¾è¡¨çš„å‡ ä¸ªç±»å‹å•å‘é“¾è¡¨å•å‘é“¾è¡¨æ˜¯æœ€ç®€å•çš„é“¾è¡¨å½¢å¼ã€‚æˆ‘ä»¬å°†é“¾è¡¨ä¸­æœ€åŸºæœ¬çš„æ•°æ®ç§°ä¸ºèŠ‚ç‚¹(node)ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹åŒ…å«äº†æ•°æ®å—å’ŒæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆã€‚ åŒå‘é“¾è¡¨åŒå‘é“¾è¡¨å°±æ˜¯æœ‰ä¸¤ä¸ªæ–¹å‘çš„é“¾è¡¨ã€‚åŒå•å‘é“¾è¡¨ä¸åŒï¼Œåœ¨åŒå‘é“¾è¡¨ä¸­æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¸ä»…å­˜å‚¨æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œè€Œä¸”å­˜å‚¨æŒ‡å‘å‰ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œèƒ½å¤Ÿé€šè¿‡åœ¨O(1)æ—¶é—´å†…é€šè¿‡ç›®çš„èŠ‚ç‚¹ç›´æ¥æ‰¾åˆ°å‰é©±èŠ‚ç‚¹ï¼Œä½†æ˜¯åŒæ—¶ä¼šå¢åŠ å¤§é‡çš„æŒ‡é’ˆå­˜å‚¨ç©ºé—´ã€‚ å¾ªç¯é“¾è¡¨å¾ªç¯é“¾è¡¨ä¸åŒå‘é“¾è¡¨ç›¸ä¼¼ï¼Œä¸åŒçš„åœ°æ–¹åœ¨äºï¼šåœ¨é“¾è¡¨çš„å°¾éƒ¨å¢åŠ ä¸€ä¸ªæŒ‡å‘å¤´ç»“ç‚¹çš„æŒ‡é’ˆï¼Œå¤´ç»“ç‚¹ä¹Ÿå¢åŠ ä¸€ä¸ªæŒ‡å‘å°¾èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œä»¥åŠç¬¬ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘å¤´èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œä»è€Œæ›´æ–¹ä¾¿ç´¢å¼•é“¾è¡¨å…ƒç´ ã€‚ æ ‘ é™¤äº†æ ¹ç»“ç‚¹ä¹‹å¤–æ¯ä¸ªç»“ç‚¹åªæœ‰ä¸€ä¸ªçˆ¶ç»“ç‚¹ï¼Œæ ¹ç»“ç‚¹æ²¡æœ‰çˆ¶ç»“ç‚¹ï¼›é™¤äº†å¶ç»“ç‚¹ä¹‹å¤–æ‰€æœ‰ç»“ç‚¹éƒ½æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå­ç»“ç‚¹ï¼Œå¶ç»“ç‚¹æ²¡æœ‰å­ç»“ç‚¹ã€‚çˆ¶ç»“ç‚¹å’Œå­ç»“ç‚¹ä¹‹é—´ç”¨æŒ‡é’ˆé“¾æ¥ã€‚ äºŒå‰æ ‘æ˜¯æ ‘çš„ä¸€ç§ç‰¹æ®Šç»“æ„ï¼Œåœ¨äºŒå‰æ ‘ä¸­æ¯ä¸ªç»“ç‚¹æœ€å¤šåªèƒ½æœ‰ä¸¤ä¸ªå­ç»“ç‚¹ã€‚åœ¨äºŒå‰æ ‘ä¸­æœ€é‡è¦çš„æ“ä½œè«è¿‡äºéå†ï¼Œå³æŒ‰ç…§æŸä¸€é¡ºåºè®¿é—®æ ‘ä¸­çš„æ‰€æœ‰ç»“ç‚¹ã€‚ éå†äºŒå‰æ ‘ï¼šå‰åºéå†ã€ååºéå†ã€ä¸­åºéå†ã€‚ æ ˆå’Œé˜Ÿåˆ— æ ˆçš„ç‰¹ç‚¹æ˜¯åè¿›å…ˆå‡ºï¼Œå³æœ€åè¢«å‹å…¥ï¼ˆpushï¼‰æ ˆçš„å…ƒç´ ä¼šç¬¬ä¸€ä¸ªè¢«å¼¹å‡ºï¼ˆpopï¼‰ã€‚ é˜Ÿåˆ—çš„ç‰¹ç‚¹æ˜¯å…ˆè¿›å…ˆå‡ºï¼Œå³ç¬¬ä¸€ä¸ªè¿›å…¥é˜Ÿåˆ—çš„å…ƒç´ å°†ä¼šç¬¬ä¸€ä¸ªå‡ºæ¥ã€‚","categories":[{"name":"åŸºæœ¬åŠŸ","slug":"åŸºæœ¬åŠŸ","permalink":"https://bigporo.github.io/categories/åŸºæœ¬åŠŸ/"}],"tags":[{"name":"åŸºæœ¬åŠŸ","slug":"åŸºæœ¬åŠŸ","permalink":"https://bigporo.github.io/tags/åŸºæœ¬åŠŸ/"}]},{"title":"ã€Šå‰‘æŒ‡Offerã€‹è¯»ä¹¦æ€»ç»“","slug":"ã€Šå‰‘æŒ‡Offerã€‹è¯»ä¹¦æ€»ç»“","date":"2019-04-25T02:42:13.000Z","updated":"2019-05-16T03:46:50.738Z","comments":true,"path":"2019/04/25/ã€Šå‰‘æŒ‡Offerã€‹è¯»ä¹¦æ€»ç»“/","link":"","permalink":"https://bigporo.github.io/2019/04/25/ã€Šå‰‘æŒ‡Offerã€‹è¯»ä¹¦æ€»ç»“/","excerpt":"é¢è¯•çš„ä¸‰ä¸ªç¯èŠ‚è¡Œä¸ºé¢è¯• ä¸»è¦æ˜¯æš–åœºï¼Œéœ€è¦å¿«é€Ÿè°ƒèŠ‚ä»¥è¿›å…¥é¢è¯•çŠ¶æ€ã€‚ é¡¹ç›®ç»éªŒ é¡¹ç›®èƒŒæ™¯ï¼šé¡¹ç›®çš„è§„æ¨¡ï¼Œå¼€å‘çš„è½¯ä»¶çš„åŠŸèƒ½ï¼Œç›®æ ‡ç”¨æˆ·ç­‰ã€‚ ä»»åŠ¡ï¼šè¯¦ç»†ä»‹ç»è‡ªå·±çš„çš„ä»»åŠ¡ï¼Œæ³¨æ„åŒºåˆ†â€œå‚ä¸â€å’Œâ€œè´Ÿè´£â€ã€‚ å…·ä½“å·¥ä½œï¼šä»‹ç»å®Œæˆä»»åŠ¡æ‰€åšçš„å·¥ä½œï¼Œå¯ä»¥å…·ä½“åˆ°ç»“æ„ã€æ¡†æ¶ã€æŠ€æœ¯ç»†èŠ‚ç­‰ã€‚ è´¡çŒ®ï¼šè¯¦ç»†ä»‹ç»åœ¨ä»»åŠ¡ä¸­çš„è´¡çŒ®ï¼Œæœ€å¥½å¯ä»¥æ•°å­—åŒ–ã€‚","text":"é¢è¯•çš„ä¸‰ä¸ªç¯èŠ‚è¡Œä¸ºé¢è¯• ä¸»è¦æ˜¯æš–åœºï¼Œéœ€è¦å¿«é€Ÿè°ƒèŠ‚ä»¥è¿›å…¥é¢è¯•çŠ¶æ€ã€‚ é¡¹ç›®ç»éªŒ é¡¹ç›®èƒŒæ™¯ï¼šé¡¹ç›®çš„è§„æ¨¡ï¼Œå¼€å‘çš„è½¯ä»¶çš„åŠŸèƒ½ï¼Œç›®æ ‡ç”¨æˆ·ç­‰ã€‚ ä»»åŠ¡ï¼šè¯¦ç»†ä»‹ç»è‡ªå·±çš„çš„ä»»åŠ¡ï¼Œæ³¨æ„åŒºåˆ†â€œå‚ä¸â€å’Œâ€œè´Ÿè´£â€ã€‚ å…·ä½“å·¥ä½œï¼šä»‹ç»å®Œæˆä»»åŠ¡æ‰€åšçš„å·¥ä½œï¼Œå¯ä»¥å…·ä½“åˆ°ç»“æ„ã€æ¡†æ¶ã€æŠ€æœ¯ç»†èŠ‚ç­‰ã€‚ è´¡çŒ®ï¼šè¯¦ç»†ä»‹ç»åœ¨ä»»åŠ¡ä¸­çš„è´¡çŒ®ï¼Œæœ€å¥½å¯ä»¥æ•°å­—åŒ–ã€‚ å¯èƒ½ä¼šé—®çš„é—®é¢˜ åœ¨è¯¥é¡¹ç›®ä¸­é‡åˆ°çš„æœ€å¤§çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ ä»è¿™ä¸ªé¡¹ç›®ä¸­å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ ä»€ä¹ˆæ—¶å€™ä¼šå’Œå…¶ä»–æˆå‘˜æœ‰æ€æ ·çš„å†²çªï¼Ÿæ€ä¹ˆè§£å†³çš„ï¼Ÿ ä¸ºä»€ä¹ˆè·³æ§½éœ€è¦é¿å…ä»¥ä¸‹åŸå› ï¼š è€æ¿å¤ªè‹›åˆ» åŒäº‹éš¾ç›¸å¤„ åŠ ç­å¤ªé¢‘ç¹ å·¥èµ„å¤ªä½(å³ä½¿æ˜¯å®é™…åŸå› ä¹Ÿä¸å»ºè®®è¯´) å¸¸è§„å›ç­”ï¼š ç°åœ¨çš„å·¥ä½œåšçš„å¤ªä¹…ï¼Œæ²¡æœ‰æ¿€æƒ…äº†ï¼Œå¸Œæœ›æœ‰ä¸€ä»½æ›´æœ‰æŒ‘æˆ˜æ€§çš„å·¥ä½œã€‚ ç°åœ¨çš„å·¥ä½œçš„æ–¹å‘å’Œè‡ªå·±é¢„æƒ³çš„æœ‰åå·®ã€‚ æŠ€æœ¯é¢è¯•è¿™å—æ˜¯é‡å¤´æˆï¼Œå¯¹é¢è¯•çš„ç»“æœä¼šæœ‰å†³å®šæ€§çš„å½±å“ã€‚ä¸€èˆ¬ä¼šå…³æ³¨å¦‚ä¸‹å‡ ä¸ªæ–¹é¢ï¼š åŸºç¡€çŸ¥è¯†æ‰å®å…¨é¢ï¼ŒåŒ…æ‹¬ç¼–ç¨‹è¯­è¨€ã€æ•°æ®ç»“æ„ã€ç®—æ³•ç­‰ã€‚ èƒ½å†™å‡ºé«˜è´¨é‡çš„ä»£ç ã€‚ èƒ½æ€è·¯æ¸…æ™°çš„åˆ†æå’Œè§£å†³å¤æ‚é—®é¢˜ã€‚ èƒ½ä»æ—¶é—´ã€ç©ºé—´å¤æ‚åº¦ä¸¤ä¸ªæ–¹é¢ä¼˜åŒ–ç®—æ³•çš„æ•ˆç‡ã€‚ å…·å¤‡ä¼˜ç§€çš„æ²Ÿé€šèƒ½åŠ›ã€å­¦ä¹ èƒ½åŠ›ã€å‘æ•£æ€ç»´ç­‰èƒ½åŠ›ã€‚ åº”è˜è€…æé—®ç¯èŠ‚ ä¸è¦é—®ä¸è‡ªå·±å…¥èŒä¹‹åçš„å·¥ä½œæ— å…³çš„é—®é¢˜ã€‚ ä¸è¦é—®è–ªæ°´ï¼ŒæŠ€æœ¯é¢è¯•ä¸æ˜¯é—®è–ªæ°´çš„æ—¶å€™ã€‚ ä¸è¦ç«‹åˆ»æ‰“å¬é¢è¯•çš„ç»“æœã€‚ é¢è¯•éœ€è¦çš„åŸºç¡€çŸ¥è¯†ç¼–ç¨‹è¯­è¨€:C++ã€C#ï¼ˆå’ï¼‰ æ•°æ®ç»“æ„æ•°ç»„ å æ®ä¸€å—è¿ç»­çš„å†…å­˜å¹¶æŒ‰ç…§é¡ºåºå­˜å‚¨æ•°æ®ï¼Œåˆå§‹åŒ–æ—¶å°±å·²ç»ç¡®å®šäº†å¤§å°ï¼Œç„¶åæ ¹æ®å¤§å°åˆ†é…å†…å­˜ã€‚æ‰€ä»¥å¯¼è‡´ç©ºé—´æ•ˆç‡ä¸æ˜¯å¾ˆå¥½ã€‚ æ•°ç»„çš„å†…å­˜æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥æ ¹æ®ä¸‹æ ‡è¿›è¡Œè¯»å†™çš„æ—¶å€™ï¼Œæ—¶é—´æ•ˆç‡å¾ˆé«˜ã€‚ åŠ¨æ€æ•°ç»„å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³ç©ºé—´æ•ˆç‡ä¸é«˜çš„é—®é¢˜ï¼Œä½†æ˜¯æ¯ä¸€æ¬¡æ‰©å……æ•°ç»„çš„æ—¶å€™éƒ½æœ‰å¤§é‡çš„é¢å¤–æ“ä½œï¼Œå¯¹æ—¶é—´æ€§èƒ½æœ‰å½±å“ã€‚ å­—ç¬¦ä¸²åœ¨C#ä¸­ï¼Œå°è£…å­—ç¬¦ä¸²çš„ç±»å‹System.Stringæœ‰ä¸€ä¸ªéå¸¸ç‰¹æ®Šçš„æ€§è´¨ï¼šStringä¸­çš„å†…å®¹æ˜¯ä¸èƒ½æ”¹å˜çš„ã€‚ä¸€æ—¦è¯•å›¾æ”¹å˜Stringçš„å†…å®¹ï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚ é“¾è¡¨å†…å­˜åˆ†é…ä¸æ˜¯åœ¨åˆ›å»ºé“¾è¡¨æ—¶ä¸€æ¬¡æ€§å®Œæˆï¼Œè€Œæ˜¯æ¯æ·»åŠ ä¸€ä¸ªç»“ç‚¹åˆ†é…ä¸€æ¬¡å†…å­˜ã€‚æ²¡æœ‰é—²ç½®çš„å†…å­˜ï¼Œæ‰€ä»¥ç©ºé—´æ•ˆç‡æ¯”è¾ƒé«˜ã€‚ æ ‘é€»è¾‘é™¤äº†æ ¹ç»“ç‚¹ä¹‹å¤–æ¯ä¸ªç»“ç‚¹åªæœ‰ä¸€ä¸ªçˆ¶ç»“ç‚¹ï¼Œæ ¹ç»“ç‚¹æ²¡æœ‰çˆ¶ç»“ç‚¹ï¼›é™¤äº†å¶ç»“ç‚¹ä¹‹å¤–æ‰€æœ‰ç»“ç‚¹éƒ½æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå­ç»“ç‚¹ï¼Œå¶ç»“ç‚¹æ²¡æœ‰å­ç»“ç‚¹ã€‚çˆ¶ç»“ç‚¹å’Œå­ç»“ç‚¹ä¹‹é—´ç”¨æŒ‡é’ˆé“¾æ¥ã€‚ éå†æ–¹å¼ å‰åºéå†ï¼šå…ˆè®¿é—®æ ¹ç»“ç‚¹ï¼Œå†è®¿é—®å·¦å­ç»“ç‚¹ï¼Œæœ€åè®¿é—®å³å­ç»“ç‚¹ã€‚ ä¸­åºéå†ï¼šå…ˆè®¿é—®å·¦å­ç»“ç‚¹ï¼Œå†è®¿é—®æ ¹ç»“ç‚¹ï¼Œæœ€åè®¿é—®å³å­ç»“ç‚¹ã€‚ ååºéå†ï¼šå…ˆè®¿é—®å·¦å­ç»“ç‚¹ï¼Œå†è®¿é—®å³å­ç»“ç‚¹ï¼Œæœ€åè®¿é—®æ ¹ç»“ç‚¹ã€‚ ååºéå†ï¼šå…ˆè®¿é—®å·¦å­ç»“ç‚¹ï¼Œå†è®¿é—®å³å­ç»“ç‚¹ï¼Œæœ€åè®¿é—®æ ¹ç»“ç‚¹ã€‚ å †ï¼šå †åˆ†ä¸ºæœ€å¤§å †å’Œæœ€å°å †ã€‚åœ¨æœ€å¤§å †ä¸­æ ¹ç»“ç‚¹çš„å€¼æœ€å¤§ï¼Œåœ¨æœ€å°å †ä¸­æ ¹ç»“ç‚¹çš„å€¼æœ€å°ã€‚æœ‰å¾ˆå¤šéœ€è¦å¿«é€Ÿæ‰¾åˆ°æœ€å¤§å€¼æˆ–è€…æœ€å°å€¼çš„é—®é¢˜éƒ½å¯ä»¥ç”¨å †æ¥è§£å†³ã€‚ çº¢é»‘æ ‘ï¼šçº¢é»‘æ ‘æ˜¯æŠŠæ ‘ä¸­çš„ç»“ç‚¹å®šä¹‰ä¸ºçº¢ã€é»‘ä¸¤ç§é¢œè‰²ï¼Œå¹¶é€šè¿‡è§„åˆ™ç¡®ä¿ä»æ ¹ç»“ç‚¹åˆ°å¶ç»“ç‚¹çš„æœ€é•¿è·¯å¾„çš„é•¿åº¦ä¸è¶…è¿‡æœ€çŸ­è·¯å¾„çš„ä¸¤å€ã€‚ äºŒå‰æ ‘ï¼šæ•°ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹åªèƒ½æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚ æ ˆå’Œé˜Ÿåˆ—æ ˆç‰¹ç‚¹ï¼šåè¿›å…ˆå‡ºï¼Œå¼¹æ ˆã€‚ é˜Ÿåˆ—ç‰¹ç‚¹ï¼šå…ˆè¿›å…ˆå‡ºã€‚ ç®—æ³•å’Œæ•°æ®æ“ä½œé‡ç‚¹æŒæ¡äºŒåˆ†æŸ¥æ‰¾ã€å½’å¹¶æ’åºå’Œå¿«é€Ÿæ’åºï¼Œåšåˆ°èƒ½éšæ—¶æ­£ç¡®ã€å®Œæ•´åœ°å†™å‡ºå®ƒä»¬çš„ä»£ç ã€‚ æŸ¥æ‰¾å’Œæ’åºæŸ¥æ‰¾é¡ºåºæŸ¥æ‰¾ã€äºŒåˆ†æŸ¥æ‰¾ã€å“ˆå¸Œè¡¨æŸ¥æ‰¾ã€äºŒå‰æ’åºæ ‘æŸ¥æ‰¾ æ’åºæ’å…¥æ’åºã€å†’æ³¡æ’åºã€å½’å¹¶æ’åºã€å¿«é€Ÿæ’åºç­‰ã€‚ é€’å½’å’Œå¾ªç¯é€’å½’ æ–æ³¢æ‹‰å¥‘æ•°åˆ—: f(n) = f(n-1) + f(n-2).é¢è¯•é¢˜ï¼šé’è›™ä¸Šå°é˜¶ã€‚ é€šå¸¸é€’å½’çš„ä»£ç ä¼šæ¯”è¾ƒç®€æ´ã€‚ ä½†æ˜¯é€’å½’ç”±äºæ˜¯å‡½æ•°è°ƒç”¨è‡ªèº«ï¼Œè€Œå‡½æ•°è°ƒç”¨æ˜¯æœ‰æ—¶é—´å’Œç©ºé—´çš„æ¶ˆè€—çš„ï¼šæ¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨ï¼Œéƒ½éœ€è¦åœ¨å†…å­˜æ ˆä¸­åˆ†é…ç©ºé—´ä»¥ä¿å­˜å‚æ•°ã€è¿”å›åœ°å€åŠä¸´æ—¶å˜é‡ï¼Œè€Œä¸”å¾€æ ˆé‡Œå‹å…¥æ•°æ®å’Œå¼¹å‡ºæ•°æ®éƒ½éœ€è¦æ—¶é—´ã€‚ä¸¥é‡çš„è¯ä¼šé€ æˆæ ˆæº¢å‡ºã€‚ é€’å½’ä¸­å¯èƒ½ä¼šæœ‰å¾ˆå¤šé‡å¤çš„è®¡ç®—ï¼Œå¯¹æ€§èƒ½é€ æˆè´Ÿé¢å½±å“ã€‚ ä½è¿ç®—ä½è¿ç®—æ˜¯æŠŠæ•°å­—ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºä¹‹åï¼Œå¯¹æ¯ä¸€ä½ä¸Š0æˆ–è€…1çš„è¿ç®—ã€‚ ä½è¿ç®—æ€»å…±åªæœ‰äº”ç§è¿ç®—ï¼šä¸ã€æˆ–ã€å¼‚æˆ–ã€å·¦ç§»å’Œå³ç§»ã€‚ é«˜è´¨é‡çš„ä»£ç  è‹¥å¹²ç»å…¸é¢è¯•é¢˜ ä¹¦å†™æ¸…æ™°ã€å¸ƒå±€æ¸…æ™°ã€å‘½ååˆç†ã€‚ è€ƒè™‘è¾¹ç•Œæƒ…å†µå’Œç‰¹æ®Šæƒ…å†µï¼Œæå‡ä»£ç çš„å®Œæ•´æ€§ã€‚ æå‡ä»£ç çš„é²æ£’æ€§(å¥å£®æ€§)ã€‚ è§£å†³é¢è¯•é¢˜çš„æ€è·¯ ç”»å›¾è®©æŠ½è±¡é—®é¢˜å…·è±¡åŒ–ã€‚ ä¸¾ä¾‹è®©æŠ½è±¡é—®é¢˜å…·ä½“åŒ–ã€‚ åˆ†è§£è®©å¤æ‚é—®é¢˜ç®€å•åŒ–ã€‚ ä¼˜åŒ–ç©ºé—´æ•ˆç‡å’Œæ—¶é—´æ•ˆç‡æƒè¡¡å¥½ç©ºé—´æ¢æ—¶é—´ã€‚ é¢è¯•ä¸­çš„å„é¡¹èƒ½åŠ›ä¸¤ä¸ªæ¡ˆåˆ—","categories":[{"name":"è¯»ä¹¦","slug":"è¯»ä¹¦","permalink":"https://bigporo.github.io/categories/è¯»ä¹¦/"}],"tags":[{"name":"è¯»ä¹¦","slug":"è¯»ä¹¦","permalink":"https://bigporo.github.io/tags/è¯»ä¹¦/"}]},{"title":"å¼€å§‹ä¸‹ä¸€ç¨‹","slug":"å¼€å§‹ä¸‹ä¸€ç¨‹","date":"2019-04-24T15:29:05.000Z","updated":"2019-04-25T02:56:21.344Z","comments":true,"path":"2019/04/24/å¼€å§‹ä¸‹ä¸€ç¨‹/","link":"","permalink":"https://bigporo.github.io/2019/04/24/å¼€å§‹ä¸‹ä¸€ç¨‹/","excerpt":"æˆ‘åˆå›æ¥äº†å…¶å®æ—©åœ¨18å¹´çš„å¹´åˆå°±å·²ç»æ­äº†ä¸€ä¸ªåšå®¢ï¼Œä½†æ˜¯å½“æ—¶æœ‰å¾ˆå¥‡æ€ªçš„åŒ…è¢±ï¼Œè§‰å¾—å¿…é¡»è¦äº§å‡ºå¾ˆä¼˜è´¨çš„å†…å®¹ï¼Œæ‰å¯ä»¥å†™åœ¨åšå®¢ä¸Šï¼Œç»™äº†è‡ªå·±æ¯”è¾ƒå¤§çš„å‹åŠ›ã€‚ç„¶åå› ä¸ºå·¥ä½œæ¯”è¾ƒå¿™ï¼Œåšå®¢ä¹Ÿæç½®äº†ï¼Œæœ€ç»ˆç´¢æ€§ç›´æ¥åˆ äº†ã€‚å…¶å®éƒ½æ˜¯å€Ÿå£å§ï¼Œæ‰€ä»¥æœ€è¿‘è¶ç€æ¯”è¾ƒç©ºé—²ï¼Œåˆé‡æ–°æ­äº†ä¸€ä¸ªã€‚ è¿™æ¬¡åšå®¢çš„å®šä½å’Œä¹‹å‰æœ‰äº†ä¸€äº›ä¸åŒï¼Œæ›´åƒæ˜¯ä¸€ä¸ªç¬”è®° + ç”Ÿæ´»æ„Ÿæ‚Ÿ + å‘ç‰¢éªšçš„åœ°æ–¹ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰åŒ…è¢±äº†ï¼Œåªæ˜¯å•çº¯çš„è®°å½•ã€‚ æ‰€ä»¥æŠŠä¹‹å‰è®°å½•åœ¨æœ‰é“äº‘ç¬”è®°çš„ä¸€éƒ¨åˆ†å†…å®¹æ¬è¿åˆ°äº†è¿™é‡Œï¼Œå ä¸ªåœ°å§ã€‚","text":"æˆ‘åˆå›æ¥äº†å…¶å®æ—©åœ¨18å¹´çš„å¹´åˆå°±å·²ç»æ­äº†ä¸€ä¸ªåšå®¢ï¼Œä½†æ˜¯å½“æ—¶æœ‰å¾ˆå¥‡æ€ªçš„åŒ…è¢±ï¼Œè§‰å¾—å¿…é¡»è¦äº§å‡ºå¾ˆä¼˜è´¨çš„å†…å®¹ï¼Œæ‰å¯ä»¥å†™åœ¨åšå®¢ä¸Šï¼Œç»™äº†è‡ªå·±æ¯”è¾ƒå¤§çš„å‹åŠ›ã€‚ç„¶åå› ä¸ºå·¥ä½œæ¯”è¾ƒå¿™ï¼Œåšå®¢ä¹Ÿæç½®äº†ï¼Œæœ€ç»ˆç´¢æ€§ç›´æ¥åˆ äº†ã€‚å…¶å®éƒ½æ˜¯å€Ÿå£å§ï¼Œæ‰€ä»¥æœ€è¿‘è¶ç€æ¯”è¾ƒç©ºé—²ï¼Œåˆé‡æ–°æ­äº†ä¸€ä¸ªã€‚ è¿™æ¬¡åšå®¢çš„å®šä½å’Œä¹‹å‰æœ‰äº†ä¸€äº›ä¸åŒï¼Œæ›´åƒæ˜¯ä¸€ä¸ªç¬”è®° + ç”Ÿæ´»æ„Ÿæ‚Ÿ + å‘ç‰¢éªšçš„åœ°æ–¹ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰åŒ…è¢±äº†ï¼Œåªæ˜¯å•çº¯çš„è®°å½•ã€‚ æ‰€ä»¥æŠŠä¹‹å‰è®°å½•åœ¨æœ‰é“äº‘ç¬”è®°çš„ä¸€éƒ¨åˆ†å†…å®¹æ¬è¿åˆ°äº†è¿™é‡Œï¼Œå ä¸ªåœ°å§ã€‚ è¿‘å†µåœ¨é£ä¿®çš„ä¸€å¹´å¤šé‡Œï¼Œè¯´å®è¯ï¼Œæˆé•¿ä¸å¤šï¼ŒiOSçš„æœ¬èŒå·¥ä½œåªèƒ½è¯´æ˜¯åŠæ ¼ï¼Œç©¿æ’ç€çœ‹äº†JSå’Œå°ç¨‹åºã€‚ç°åœ¨å› ä¸ºå…¬å¸çš„ä¸šåŠ¡è°ƒæ•´ï¼Œç§»åŠ¨ç«¯çš„éœ€æ±‚ä¸å¤šï¼Œæ‰€ä»¥ç°åœ¨ä¹Ÿå…¼èŒå†™å†™å°ç¨‹åºã€‚ åœ¨ç”Ÿæ´»ä¸Šï¼Œè¿™ä¸€ä¸¤å¹´åšäº†å¾ˆå¤šã€‚å¥³æœ‹å‹ â€“&gt; æ€€å­• â€“&gt; ç»“å©š â€“&gt; ä¹°æˆ¿ä¹°è½¦ â€“&gt; è£…ä¿®ing,è¿˜æœ‰å®å®å³å°†å‡ºç”Ÿã€‚ å³å°†æˆä¸ºçˆ¶äº²çš„æˆ‘ï¼Œæ¸æ¸çš„æ„Ÿå—åˆ°äº†ç”Ÿæ´»çš„å‹åŠ›ã€‚å’Œä¹‹å‰çš„ä¸€äººåƒé¥±å…¨å®¶ä¸é¥¿ä¸åŒäº†ã€‚ç°åœ¨æ¯å¤©çå¼€çœ¼å°±æ˜¯è€å©†ã€æˆ¿è´·ã€è£…ä¿®ç­‰ç­‰äº‹æƒ…ï¼Œè®©äººå¿ƒåŠ›äº¤ç˜ã€‚çªç„¶æƒ³èµ·äº†ä¸€ä¸ªæœ‹å‹çš„è¯:â€œä¸€ä¸ªç¨‹åºå‘˜æœ€å¼ºå½¢æ€å°±æ˜¯å•èº«ç‹—â€ã€‚ç°åœ¨ä½“ä¼šåˆ°çš„äº‹å®ä¹Ÿå¤§æ¦‚å¦‚æ­¤å§ã€‚ å¯æ˜¯å•Šï¼Œè°ä¸æ˜¯è´Ÿé‡å‰è¡Œå‘¢ï¼Œçˆ¶æ¯æ¸è€ï¼Œä¸€è¾ˆå­çš„ç§¯è“„ç»™æˆ‘æ¢æ¥äº†ä¸€ä¸ªå®‰å®¶ä¹‹æ‰€ï¼Œæˆ‘ä¹Ÿå¿…é¡»ç»™ä»–ä»¬ä¸€ä¸ªç«‹å‘½ä¹‹å¤„ã€‚å’¬ç´§ç‰™å…³ï¼Œä¿æŒçƒ­æƒ…ï¼Œç»§ç»­èµ°ä¸‹å»å§ã€‚","categories":[{"name":"çƒŸç«","slug":"çƒŸç«","permalink":"https://bigporo.github.io/categories/çƒŸç«/"}],"tags":[{"name":"çƒŸç«","slug":"çƒŸç«","permalink":"https://bigporo.github.io/tags/çƒŸç«/"}]},{"title":"Injectionï¼šiOSçƒ­é‡è½½-æ‰€è§å³æ‰€å¾—","slug":"Injectionï¼šiOSçƒ­é‡è½½-æ‰€è§å³æ‰€å¾—","date":"2019-04-23T09:17:43.000Z","updated":"2019-04-24T09:23:45.568Z","comments":true,"path":"2019/04/23/Injectionï¼šiOSçƒ­é‡è½½-æ‰€è§å³æ‰€å¾—/","link":"","permalink":"https://bigporo.github.io/2019/04/23/Injectionï¼šiOSçƒ­é‡è½½-æ‰€è§å³æ‰€å¾—/","excerpt":"","text":"å‚è€ƒåšå®¢ å‚è€ƒåšå®¢","categories":[{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/categories/å·¥å…·é›†/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/tags/iOS/"},{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/tags/å·¥å…·é›†/"}]},{"title":"ImageOptim - å›¾ç‰‡å‹ç¼©","slug":"ImageOptim - å›¾ç‰‡å‹ç¼©","date":"2019-04-23T09:17:43.000Z","updated":"2019-04-24T09:23:32.015Z","comments":true,"path":"2019/04/23/ImageOptim - å›¾ç‰‡å‹ç¼©/","link":"","permalink":"https://bigporo.github.io/2019/04/23/ImageOptim - å›¾ç‰‡å‹ç¼©/","excerpt":"ä¸‹è½½åœ°å€ ImageOptimæ˜¯ä¸€æ¬¾åŸºäºMacçš„å›¾åƒâ€œç˜¦èº«â€è½¯ä»¶ï¼Œå†…ç½®æœ‰6ç§å‹ç¼©ç®—æ³•ï¼Œé€šè¿‡åˆ é™¤å›¾ç‰‡éƒ¨åˆ†æ— ç”¨çš„EXIFç­‰ä¿¡æ¯æ¥å‡å°PNGã€JPEGå’ŒGIFå›¾ç‰‡çš„å¤§å°ã€‚","text":"ä¸‹è½½åœ°å€ ImageOptimæ˜¯ä¸€æ¬¾åŸºäºMacçš„å›¾åƒâ€œç˜¦èº«â€è½¯ä»¶ï¼Œå†…ç½®æœ‰6ç§å‹ç¼©ç®—æ³•ï¼Œé€šè¿‡åˆ é™¤å›¾ç‰‡éƒ¨åˆ†æ— ç”¨çš„EXIFç­‰ä¿¡æ¯æ¥å‡å°PNGã€JPEGå’ŒGIFå›¾ç‰‡çš„å¤§å°ã€‚ImageOptimåˆå¹¶äº†OptiPNGã€PNGCrushã€AdvanceCompã€PNGOUTã€Jpegoptim+Jpegtranå’ŒGifsicleç­‰å‡ ä¸ªå·¥å…·ï¼Œæ—¨åœ¨ä¸ºè®¾è®¡å¸ˆæä¾›æœ€å¥½çš„ä¼˜åŒ–æ•ˆæœã€‚åœ¨æœ€æ–°å‘å¸ƒçš„1.4.4ç‰ˆæœ¬ä¸­ï¼ŒImageOptimæ”¹è¿›äº†æ–‡ä»¶åœ¨æ–‡ä»¶åˆ—è¡¨ä¸­çš„æ‹–æ‹½ã€å¤åˆ¶ã€ç²˜è´´åŠŸèƒ½ã€‚","categories":[{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/categories/å·¥å…·é›†/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/tags/iOS/"},{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/tags/å·¥å…·é›†/"}]},{"title":"LSUnusedResources -æ— ç”¨èµ„æºæŸ¥æ‰¾","slug":"LSUnusedResources -æ— ç”¨èµ„æºæŸ¥æ‰¾","date":"2019-04-23T09:17:43.000Z","updated":"2019-04-24T09:24:02.664Z","comments":true,"path":"2019/04/23/LSUnusedResources -æ— ç”¨èµ„æºæŸ¥æ‰¾/","link":"","permalink":"https://bigporo.github.io/2019/04/23/LSUnusedResources -æ— ç”¨èµ„æºæŸ¥æ‰¾/","excerpt":"ä¸‹è½½åœ°å€","text":"ä¸‹è½½åœ°å€ æ ¸å¿ƒæ­¥éª¤ï¼Œç®€è¿°å¦‚ä¸‹ï¼š æŸ¥æ‰¾ï¼šé€‰å®šçš„ç›®å½•ä¸‹çš„æ‰€æœ‰èµ„æºæ–‡ä»¶ã€‚è¿™ä¸€æ­¥ä¸ä¸Šè¿°æ–¹æ¡ˆ1åŒºåˆ«ä¸å¤§ï¼Œéƒ½æ˜¯è°ƒç”¨ find å‘½ä»¤æŸ¥æ‰¾æŒ‡å®šåç¼€åçš„æ–‡ä»¶ã€‚ åŒ¹é…ï¼šä¸ä¸Šè¿°æ–¹æ¡ˆä¸åŒï¼Œæˆ‘ä¸æ˜¯å¯¹æ¯ä¸ªèµ„æºæ–‡ä»¶åéƒ½åšä¸€æ¬¡å…¨æ–‡æœç´¢åŒ¹é…ï¼Œå› ä¸ºåŠ å…¥é¡¹ç›®çš„èµ„æºå¤ªå¤šï¼Œè¿™é‡Œä¼šå¯¼è‡´æ€§èƒ½å¿«é€Ÿä¸‹é™ã€‚è€Œæˆ‘åªæ˜¯é’ˆå¯¹æºç ã€Xibã€Storyboard å’Œ plist ç­‰æ–‡ä»¶ï¼Œå…ˆå…¨æ–‡æœç´¢å…¶ä¸­å¯èƒ½æ˜¯å¼•ç”¨äº†èµ„æºçš„å­—ç¬¦ä¸²ï¼Œç„¶åç”¨èµ„æºåå’Œå­—ç¬¦ä¸²åšåŒ¹é…ã€‚ ä½¿ç”¨æ–¹æ³• ç‚¹å‡» Browse.. é€‰æ‹©ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼› ç‚¹å‡» Search å¼€å§‹æœç´¢ï¼› ç­‰å¾…ç‰‡åˆ»å³å¯çœ‹åˆ°ç»“æœã€‚","categories":[{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/categories/å·¥å…·é›†/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/tags/iOS/"},{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/tags/å·¥å…·é›†/"}]},{"title":"Reveal 4.0 ä½¿ç”¨æŒ‡å—","slug":"Reveal 4.0 ä½¿ç”¨æŒ‡å—","date":"2019-04-23T09:17:43.000Z","updated":"2019-04-24T09:25:16.212Z","comments":true,"path":"2019/04/23/Reveal 4.0 ä½¿ç”¨æŒ‡å—/","link":"","permalink":"https://bigporo.github.io/2019/04/23/Reveal 4.0 ä½¿ç”¨æŒ‡å—/","excerpt":"Reveal ç®€ä»‹Revealæ˜¯ä¸€æ¬¾iOSç¨‹åºç•Œé¢è°ƒè¯•å·¥å…·ï¼Œå¯ä»¥è®©æˆ‘ä»¬åœ¨å¼€å‘æ—¶åŠ¨æ€çš„æŸ¥çœ‹å’Œä¿®æ”¹APPçš„ç•Œé¢ã€‚å…å»äº†æ¯æ¬¡ä¿®æ”¹å®Œä»£ç é‡æ–°å¯åŠ¨çš„ç—›è‹¦ã€‚ å¯åŠ¨ç•Œé¢å¦‚ä¸‹å›¾ï¼š","text":"Reveal ç®€ä»‹Revealæ˜¯ä¸€æ¬¾iOSç¨‹åºç•Œé¢è°ƒè¯•å·¥å…·ï¼Œå¯ä»¥è®©æˆ‘ä»¬åœ¨å¼€å‘æ—¶åŠ¨æ€çš„æŸ¥çœ‹å’Œä¿®æ”¹APPçš„ç•Œé¢ã€‚å…å»äº†æ¯æ¬¡ä¿®æ”¹å®Œä»£ç é‡æ–°å¯åŠ¨çš„ç—›è‹¦ã€‚ å¯åŠ¨ç•Œé¢å¦‚ä¸‹å›¾ï¼š Reveal çš„å®‰è£…å®‰è£…å¾ˆç®€å•ï¼Œç›´æ¥ä¸‹è½½ä¸€è·¯åˆ°åº•å°±å¯ä»¥ã€‚ å®˜æ–¹æ­£ç‰ˆä¸‹è½½åœ°å€ ç ´è§£ç‰ˆä¸‹è½½åœ°å€ Reveal çš„ä½¿ç”¨é›†æˆæ–¹å¼å®˜æ–¹ä¸€å…±æä¾›äº†ä¸‰ç§é›†æˆæ–¹å¼ ä¸‰ç§é›†æˆæŒ‡å—å¯¹æ¯” ä½¿ç”¨cocoapodsé›†æˆ appå†…é›†æˆReveal Server framework åˆ©ç”¨Xcodeçš„Breakpoint æ–­ç‚¹åŠ è½½Reveal Server å¯¹æ¯”:1å’Œ2åŸºæœ¬ç›¸ä¼¼ï¼Œéœ€è¦ä¿®æ”¹å·¥ç¨‹æ–‡ä»¶ï¼Œ3ä¸éœ€è¦ä¿®æ”¹å·¥ç¨‹æ–‡ä»¶ï¼Œé€‰ç”¨ç¬¬3ç§ã€‚ åˆ©ç”¨Xcodeçš„Breakpoint æ–­ç‚¹åŠ è½½Reveal Server åœ¨Xcodeä¸­æ·»åŠ ä¸€ä¸ªSymbolic Breakpoint.å³å‡»è¿™ä¸ªæ–­ç‚¹ï¼Œç¼–è¾‘å¦‚ä¸‹å›¾: Actioné‡Œé¢å¡«å†™çš„å†…å®¹å¦‚ä¸‹:1expr (Class)NSClassFromString(@&quot;IBARevealLoader&quot;) == nil ? (void *)dlopen(&quot;/Applications/Reveal.app/Contents/SharedSupport/iOS-Libraries/RevealServer.framework/RevealServer&quot;, 0x2) : ((void*)0) å³é”®å½“å‰æ–­ç‚¹,é€‰æ‹©Move Breakpoint To â†’ Userã€‚ Xcode é€‰æ‹©9.0ç³»ç»Ÿ ,æ¨¡æ‹Ÿå™¨è¿è¡Œé¡¹ç›®ã€‚ è¿è¡Œå¥½é¡¹ç›®å,Revealè‡ªåŠ¨æ˜¾ç¤ºï¼ŒåŒå‡»å³å¯æŸ¥çœ‹æ•ˆæœã€‚ Revealåœ¨çœŸæœºä¸­è°ƒè¯•åº”ç”¨åœ¨çœŸæœºä¸­è°ƒè¯•çš„å®‰è£…æ–¹æ³•ï¼Œéœ€è¦æ·»åŠ é™æ€åº“åˆ°å·¥ç¨‹ä¸­ï¼Œç•¥å¾®éº»çƒ¦ã€‚ å°è¯•æ“ä½œäº†ä¸€éï¼Œå¤ªéº»çƒ¦äº†ï¼Œå’ã€‚ Revealåœ¨è°ƒè¯•å…¶å®ƒåº”ç”¨çš„å®‰è£…æ–¹æ³•åœ¨Revealä¸­è°ƒè¯•å…¶å®ƒåº”ç”¨ï¼Œéœ€è¦ä¸€éƒ¨è¶Šç‹±çš„æ‰‹æœºï¼Œæ²¡è¶Šç‹±çš„æ‰‹æœºæ²¡åŠæ³•è°ƒè¯•ã€‚(æœ¬äººæ²¡æœ‰ï¼Œå’©æœ‰å°è¯•) å‚è€ƒåšå®¢","categories":[{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/categories/å·¥å…·é›†/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/tags/iOS/"},{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/tags/å·¥å…·é›†/"}]},{"title":"Fastlane--è‡ªåŠ¨æ‰“åŒ…","slug":"Fastlane-è‡ªåŠ¨æ‰“åŒ…","date":"2019-04-23T09:17:43.000Z","updated":"2019-04-26T15:21:53.346Z","comments":true,"path":"2019/04/23/Fastlane-è‡ªåŠ¨æ‰“åŒ…/","link":"","permalink":"https://bigporo.github.io/2019/04/23/Fastlane-è‡ªåŠ¨æ‰“åŒ…/","excerpt":"Fastlaneæ˜¯ä¸€å¥—ä½¿ç”¨Rubyå†™çš„è‡ªåŠ¨åŒ–å·¥å…·é›†ï¼Œæ—¨åœ¨ç®€åŒ–Androidå’ŒiOSçš„éƒ¨ç½²è¿‡ç¨‹ï¼Œè‡ªåŠ¨åŒ–ä½ çš„å·¥ä½œæµã€‚å®ƒå¯ä»¥ç®€åŒ–ä¸€äº›ä¹å‘³ã€å•è°ƒã€é‡å¤çš„å·¥ä½œï¼Œåƒæˆªå›¾ã€ä»£ç ç­¾åä»¥åŠå‘å¸ƒApp","text":"Fastlaneæ˜¯ä¸€å¥—ä½¿ç”¨Rubyå†™çš„è‡ªåŠ¨åŒ–å·¥å…·é›†ï¼Œæ—¨åœ¨ç®€åŒ–Androidå’ŒiOSçš„éƒ¨ç½²è¿‡ç¨‹ï¼Œè‡ªåŠ¨åŒ–ä½ çš„å·¥ä½œæµã€‚å®ƒå¯ä»¥ç®€åŒ–ä¸€äº›ä¹å‘³ã€å•è°ƒã€é‡å¤çš„å·¥ä½œï¼Œåƒæˆªå›¾ã€ä»£ç ç­¾åä»¥åŠå‘å¸ƒApp å®‰è£…å®‰è£…xcodeå‘½ä»¤è¡Œå·¥å…·xcode-select â€“installï¼Œå¦‚æœæ²¡æœ‰å®‰è£…ï¼Œä¼šå¼¹å‡ºå¯¹è¯æ¡†ï¼Œç‚¹å‡»å®‰è£…ã€‚å¦‚æœæç¤º1xcode-select: error: command line tools are already installed, use &quot;Software Update&quot; to install updates è¡¨ç¤ºå·²ç»å®‰è£… å®‰è£…Fastlanegem install fastlane -NV```æˆ–æ˜¯ ```brew cask install fastlane ```123æˆ‘è¿™é‡Œä½¿ç”¨ç¬¬ä¸€ç§æ–¹å¼å®‰è£…çš„å¦‚æœæŠ¥é”™ï¼š ERROR: While executing gem â€¦ (Errno::EPERM) Operation not permitted - /usr/bin/commander1æ‰§è¡Œ: sudo gem install -n /usr/local/bin fastlane1å®Œæˆä¹‹åæ‰§è¡Œ: fastlane â€“version1ç¡®è®¤ä¸‹æ˜¯å¦å®‰è£…å®Œæˆå’Œå½“å‰ä½¿ç”¨çš„ç‰ˆæœ¬å·ã€‚ fastlane installation at path: /Library/Ruby/Gems/2.3.0/gems/fastlane-2.117.1/bin/fastlane[âœ”] ğŸš€fastlane 2.117.1 123## åˆå§‹åŒ–Fastlanecdåˆ°ä½ çš„é¡¹ç›®ç›®å½•æ‰§è¡Œ``` fastlane init 1234567891. ğŸ“¸ Automate screenshots2. ğŸ‘©â€âœˆï¸ Automate beta distribution to TestFlight3. ğŸš€ Automate App Store distribution4. ğŸ›  Manual setup - manually setup your project to automate your tasks? Ambiguous choice. Please choose one of [1, 2, 3, 4, ğŸ“¸ Automatescreenshots, ğŸ‘©â€âœˆï¸ Automate beta distribution to TestFlight, ğŸš€ AutomateApp Store distribution, ğŸ›  Manual setup - manually setup your project toautomate your tasks]. é€‰å‡ éƒ½è¡Œï¼Œåç»­æˆ‘ä»¬è‡ªè¡Œæ ¹æ®éœ€æ±‚å®Œå–„å°±å¯ä»¥ï¼Œè¿™é‡Œæˆ‘é€‰çš„æ˜¯3ã€‚12[17:38:53]: Please enter your Apple ID developer credentials[17:38:53]: Apple ID Username: æŒ‰ç…§æç¤ºè¾“å…¥å¼€å‘è€…è´¦å·å’Œå¯†ç ï¼Œç™»å½•æˆåŠŸåä¼šæç¤ºä½ æ˜¯å¦éœ€è¦ä¸‹è½½ä½ çš„Appçš„metadataã€‚ç‚¹yç­‰å¾…å°±å¯ä»¥ã€‚ æ–‡ä»¶å¤¹ç»“æ„åˆå§‹åŒ–æˆåŠŸåä¼šåœ¨å½“å‰å·¥ç¨‹ç›®å½•ç”Ÿæˆä¸€ä¸ªfastlaneæ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶ç›®å½•ä¸ºä¸‹ã€‚ metadataå’Œscreenshotsåˆ†åˆ«å¯¹åº”Appå…ƒæ•°æ®å’Œå•†åº—åº”ç”¨æˆªå›¾ã€‚ Appfileä¸»è¦å­˜æ”¾Appçš„apple_id team_id app_identifierç­‰ä¿¡æ¯ Deliverfileä¸­ä¸ºå‘å¸ƒçš„é…ç½®ä¿¡æ¯ï¼Œä¸€èˆ¬æƒ…å†µç”¨ä¸åˆ°ã€‚ Fastfileæ˜¯æˆ‘ä»¬æœ€åº”è¯¥å…³æ³¨çš„æ–‡ä»¶ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬çš„å·¥ä½œæ–‡ä»¶ã€‚ Fastfileæ–‡ä»¶å†…å®¹å¦‚ä¸‹:123456789101112131415161718192021222324# This file contains the fastlane.tools configuration# You can find the documentation at https://docs.fastlane.tools## For a list of all available actions, check out## https://docs.fastlane.tools/actions## For a list of all available plugins, check out## https://docs.fastlane.tools/plugins/available-plugins## Uncomment the line if you want fastlane to automatically update itself# update_fastlanedefault_platform(:ios)platform :ios do desc &quot;Push a new release build to the App Store&quot; lane :release do build_app(workspace: &quot;XXX.xcworkspace&quot;, scheme: &quot;XXX&quot;) upload_to_app_store endend ä¹‹å‰æˆ‘ä»¬äº†è§£äº†actionï¼Œé‚£actionçš„ç»„åˆå°±æ˜¯ä¸€ä¸ªlaneï¼Œæ‰“åŒ…åˆ°è’²å…¬è‹±æ˜¯ä¸€ä¸ªlaneï¼Œæ‰“åŒ…åˆ°åº”ç”¨å•†åº—æ˜¯ä¸€ä¸ªlaneï¼Œæ‰“åŒ…åˆ°testflightä¹Ÿæ˜¯ä¸€ä¸ªlaneã€‚å¯èƒ½ç†è§£ä¸ºä»»åŠ¡ä¼šå¥½ä¸€äº›ã€‚ æ‰“åŒ…åˆ°è’²å…¬è‹±è¿™é‡Œä»¥æ‰“åŒ…ä¸Šä¼ åˆ°è’²å…¬è‹±ä¸ºä¾‹å­ï¼Œå®ç°æˆ‘ä»¬çš„ä¸€è¡Œå‘½ä»¤è‡ªåŠ¨æ‰“åŒ…ã€‚ è’²å…¬è‹±åœ¨Fastlaneæ˜¯ä½œä¸ºä¸€ä¸ªæ’ä»¶å­˜åœ¨çš„ï¼Œæ‰€ä»¥è¦æ‰“åŒ…åˆ°è’²å…¬è‹±å¿…é¡»å…ˆå®‰è£…è’²å…¬è‹±çš„æ’ä»¶ã€‚ æ‰“å¼€ç»ˆç«¯è¾“å…¥fastlane add_plugin pgyer æ›´å¤šä¿¡æ¯æŸ¥çœ‹è’²å…¬è‹±æ–‡æ¡£ æ–°å»ºä¸€ä¸ªlane:12345678910111213desc &quot;æ‰“åŒ…åˆ°pgy&quot;lane :test do |options|gym( clean:true, #æ‰“åŒ…å‰cleané¡¹ç›® export_method: &quot;ad-hoc&quot;, #å¯¼å‡ºæ–¹å¼ scheme:&quot;shangshaban&quot;, #scheme configuration: &quot;Debug&quot;,#ç¯å¢ƒ output_directory:&quot;./app&quot;,#ipaçš„å­˜æ”¾ç›®å½• output_name:get_build_number()#è¾“å‡ºipaçš„æ–‡ä»¶åä¸ºå½“å‰çš„buildå· )#è’²å…¬è‹±çš„é…ç½® æ›¿æ¢ä¸ºè‡ªå·±çš„api_keyå’Œuser_keypgyer(api_key: &quot;xxxxxxx&quot;, user_key: &quot;xxxxxx&quot;,update_description: options[:desc])end optionç”¨äºæ¥æ”¶æˆ‘ä»¬çš„å¤–éƒ¨å‚æ•°ï¼Œè¿™é‡Œå¯ä»¥ä¼ å…¥å½“å‰buildçš„æè¿°ä¿¡æ¯åˆ°è’²å…¬è‹±å¹³å° æ‰§è¡Œåœ¨å·¥ä½œç›®å½•çš„ç»ˆç«¯æ‰§è¡Œ 1fastlane test desc:æµ‹è¯•æ‰“åŒ… æ‰“åŒ…æˆåŠŸ12345678910111213[10:17:35]: Upload success. Visit this URL to see: https://www.pgyer.com/feixiuman+------+------------------+-------------+| fastlane summary |+------+------------------+-------------+| Step | Action | Time (in s) |+------+------------------+-------------+| 1 | default_platform | 0 || 2 | gym | 129 || 3 | pgyer | 12 |+------+------------------+-------------+[10:17:35]: fastlane.tools finished successfully ğŸ‰ å‚è€ƒåšå®¢ å‚è€ƒåšå®¢ Github å®˜ç½‘ æ–‡æ¡£","categories":[{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/categories/å·¥å…·é›†/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/tags/iOS/"},{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/tags/å·¥å…·é›†/"}]},{"title":"è·å–ipaåŒ…ä»¥åŠå›¾ç‰‡èµ„æº","slug":"è·å–ipaåŒ…ä»¥åŠå›¾ç‰‡èµ„æº","date":"2019-04-23T09:17:43.000Z","updated":"2019-04-24T09:20:19.084Z","comments":true,"path":"2019/04/23/è·å–ipaåŒ…ä»¥åŠå›¾ç‰‡èµ„æº/","link":"","permalink":"https://bigporo.github.io/2019/04/23/è·å–ipaåŒ…ä»¥åŠå›¾ç‰‡èµ„æº/","excerpt":"iTunnesé™çº§é¦–å…ˆï¼Œæ˜¯éœ€è¦å°†ç”µè„‘ä¸Šçš„itunesåˆ é™¤ï¼Œç„¶åä¸‹è½½ä¸€ä¸ªä½ç‰ˆæœ¬çš„æ›¿æ¢æœ€æ–°çš„ï¼Œè¿™ä¸ªæ–¹æ³•æ¯”è¾ƒéº»çƒ¦çš„æ˜¯å› ä¸ºitunesæ˜¯ç³»ç»Ÿçš„è½¯ä»¶ï¼Œåˆ é™¤ä¼šæœ‰å½±å“ç³»ç»Ÿçš„é£é™©è€Œä¸”é»˜è®¤æ˜¯ä¸èƒ½åˆ é™¤çš„ã€‚æ‰€ä»¥è¯¥æ–¹æ³•ä¸æ¨èä½¿ç”¨ã€‚ å¯ä»¥å»è¿™é‡Œä¸‹è½½éœ€è¦çš„itunesã€‚","text":"iTunnesé™çº§é¦–å…ˆï¼Œæ˜¯éœ€è¦å°†ç”µè„‘ä¸Šçš„itunesåˆ é™¤ï¼Œç„¶åä¸‹è½½ä¸€ä¸ªä½ç‰ˆæœ¬çš„æ›¿æ¢æœ€æ–°çš„ï¼Œè¿™ä¸ªæ–¹æ³•æ¯”è¾ƒéº»çƒ¦çš„æ˜¯å› ä¸ºitunesæ˜¯ç³»ç»Ÿçš„è½¯ä»¶ï¼Œåˆ é™¤ä¼šæœ‰å½±å“ç³»ç»Ÿçš„é£é™©è€Œä¸”é»˜è®¤æ˜¯ä¸èƒ½åˆ é™¤çš„ã€‚æ‰€ä»¥è¯¥æ–¹æ³•ä¸æ¨èä½¿ç”¨ã€‚ å¯ä»¥å»è¿™é‡Œä¸‹è½½éœ€è¦çš„itunesã€‚ ä½¿ç”¨Apple Configurator 2 å®‰è£…Apple Configurator 2åœ¨macçš„App Storeä¸Šé¢ï¼Œå¯ä»¥æœç´¢åˆ°å…è´¹çš„Apple Configurator 2ç›´æ¥ç‚¹å‡»å®‰è£…å°±å¯ä»¥ã€‚ æ‰“å¼€App Configurator 2 ç‚¹å‡»è´¦æˆ·ï¼Œç”¨æ‰‹æœºä¸Šçš„AppleIDè¿›è¡Œç™»å½•ã€‚ æ‰‹æœºè¿æ¥ç”µè„‘ï¼Œç„¶åç‚¹å‡»â€œæ·»åŠ â€,ç‚¹å‡»åº”ç”¨ä¸‹è½½ ä¸‹è½½å®Œæˆåï¼Œä¼šæœ‰ä¸€ä¸ªå¼¹çª—ï¼Œä¸ç”¨ç‚¹ä»»ä½•æŒ‰é”®ï¼Œç›´æ¥åˆ°ç”µè„‘ä¸Šçš„å¦‚ä¸‹åœ°å€å»æ‰¾åˆ°åˆšä¸‹å¥½çš„åº”ç”¨ç¨‹åºå®‰è£…åŒ…ã€‚ 1~/Library/Group Containers/K36BKF7T3D.group.com.apple.configurator/Library/Caches/Assets/TemporaryItems/MobileApps/ æ‹·è´ipaåŒ…ï¼Œé‡å‘½åä¸º.zipæ ¼å¼æ–‡ä»¶ï¼Œè§£å‹å°±å¯ä»¥äº†ã€‚ å¦‚ä½•è·å–é‡Œé¢çš„pngå›¾ç‰‡èµ„æºå›¾ç‰‡èµ„æºä¸€èˆ¬éƒ½åœ¨Assets.caræ–‡ä»¶ä¸­ï¼Œå¦‚ä½•æ‰“å¼€Assets.carã€‚æˆ‘ä½¿ç”¨çš„æ˜¯iOS Images Extractor,åœ¨è§£å‹åçš„çš„æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°ipaåç¼€çš„æ–‡ä»¶ï¼Œå³å‡»æ˜¾ç¤ºåŒ…å†…å®¹ï¼Œå°±å¯ä»¥çœ‹åˆ°Assets.caræ–‡ä»¶ï¼Œç›´æ¥æ‹–è¿›åˆ°å·¥å…·é‡Œé¢å°±å¯ä»¥è¾“å‡ºå›¾ç‰‡èµ„æºæ–‡ä»¶å¤¹äº†ã€‚ ä¸‹è½½é“¾æ¥","categories":[{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/categories/å·¥å…·é›†/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/tags/iOS/"},{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/tags/å·¥å…·é›†/"}]},{"title":"æ–‡æ¡£ç”Ÿæˆå·¥å…·-appledoc","slug":"æ–‡æ¡£ç”Ÿæˆå·¥å…·-appledoc","date":"2019-04-23T09:17:43.000Z","updated":"2019-04-24T09:31:51.577Z","comments":true,"path":"2019/04/23/æ–‡æ¡£ç”Ÿæˆå·¥å…·-appledoc/","link":"","permalink":"https://bigporo.github.io/2019/04/23/æ–‡æ¡£ç”Ÿæˆå·¥å…·-appledoc/","excerpt":"ç®€ä»‹åšé¡¹ç›®çš„äººå¤šäº†ï¼Œå°±éœ€è¦æ–‡æ¡£äº†ã€‚ä½†æ˜¯å°±æºä»£ç æ¥è¯´ï¼Œæ–‡æ¡£æœ€å¥½å’Œæºç åœ¨ä¸€èµ·ï¼Œè¿™æ ·æ›´æ–°èµ·æ¥æ›´åŠ æ–¹ä¾¿å’Œé¡ºæ‰‹ã€‚è±¡ Java è¯­è¨€æœ¬èº«å°±è‡ªå¸¦ javadoc å‘½ä»¤ï¼Œå¯ä»¥ä»æºç ä¸­æŠ½å–æ–‡æ¡£ã€‚ä»Šå¤©æŠ½ç©ºè°ƒç ”äº†ä¸€ä¸‹ Objective-C è¯­è¨€çš„ç±»ä¼¼å·¥å…·ã€‚","text":"ç®€ä»‹åšé¡¹ç›®çš„äººå¤šäº†ï¼Œå°±éœ€è¦æ–‡æ¡£äº†ã€‚ä½†æ˜¯å°±æºä»£ç æ¥è¯´ï¼Œæ–‡æ¡£æœ€å¥½å’Œæºç åœ¨ä¸€èµ·ï¼Œè¿™æ ·æ›´æ–°èµ·æ¥æ›´åŠ æ–¹ä¾¿å’Œé¡ºæ‰‹ã€‚è±¡ Java è¯­è¨€æœ¬èº«å°±è‡ªå¸¦ javadoc å‘½ä»¤ï¼Œå¯ä»¥ä»æºç ä¸­æŠ½å–æ–‡æ¡£ã€‚ä»Šå¤©æŠ½ç©ºè°ƒç ”äº†ä¸€ä¸‹ Objective-C è¯­è¨€çš„ç±»ä¼¼å·¥å…·ã€‚ appledocæ˜¯å‘½ä»¤è¡Œå·¥å…·ï¼Œå¯å¸®åŠ©Objective-Cå¼€å‘äººå‘˜ä»ç‰¹æ®Šæ ¼å¼çš„æºä»£ç æ³¨é‡Šä¸­ç”Ÿæˆç±»ä¼¼Appleçš„æºä»£ç æ–‡æ¡£ã€‚å®ƒæ—¨åœ¨ä¸ºè¾“å…¥æä¾›å°½å¯èƒ½å¯è¯»çš„æºä»£ç æ³¨é‡Šï¼Œå¹¶ä½¿ç”¨æ³¨é‡Šä»¥åŠå‘¨å›´çš„æºä»£ç ï¼Œä»¥HTMLçš„å½¢å¼ç”Ÿæˆè§†è§‰ä¸Šå¸å¼•äººçš„æ–‡æ¡£ä»¥åŠå®Œå…¨ç´¢å¼•å’Œå¯æµè§ˆçš„Xcodeæ–‡æ¡£é›†ã€‚è™½ç„¶æœ‰å‡ ç§å·¥å…·å¯ä»¥ä¸ºObjective-Cåˆ›å»ºHTMLæ–‡æ¡£ï¼Œä½†æ˜¯æˆ‘æ‰€çŸ¥é“çš„æ‰€æœ‰å·¥å…·éƒ½æ— æ³•æ»¡è¶³ä¸‹é¢æè¿°çš„æœ€ä½ç›®æ ‡ã€‚ appledocçš„ä¸»è¦ç›®æ ‡ï¼š äººç±»å¯è¯»çš„æºä»£ç æ³¨é‡Šã€‚ å¯¹å¯¹è±¡å’Œæˆå‘˜çš„ç®€å•äº¤å‰å¼•ç”¨ã€‚ ç”Ÿæˆç±»ä¼¼Appleçš„æºä»£ç HTMLæ–‡æ¡£ã€‚ ç”Ÿæˆå¹¶å®‰è£…å®Œå…¨ç´¢å¼•å’Œå¯æµè§ˆçš„Xcodeæ–‡æ¡£é›†ã€‚ å•ä¸€å·¥å…·ï¼Œç”¨äºé©±åŠ¨ä»æºä»£ç è§£æåˆ°æ–‡æ¡£é›†å®‰è£…çš„ç”Ÿæˆã€‚ è½»æ¾å®šåˆ¶è¾“å‡ºã€‚ 100ï¼…Objective-Cå®ç°ï¼Œæ˜“äºè°ƒè¯•ã€‚ å®‰è£…é‚£ä¹ˆç®€å•ä»‹ç»ä¸€ä¸‹å¦‚ä½•å®‰è£… appledocï¼Œå®‰è£…éå¸¸ç®€å•ï¼Œåªéœ€è¦ 2 æ­¥ï¼š 123git clone git://github.com/tomaz/appledoc.gitcd appledocsudo sh install-appledoc.sh å®‰è£…æˆåŠŸ:123** INSTALL SUCCEEDED **install: /tmp/Build/Intermediates.noindex/ArchiveIntermediates/appledoc/InstallationBuildProductsLocation/usr/local/bin/appledoc -&gt; /usr/local/bin//appledoc å¦å¤–è¿˜æœ‰Homebrewï¼š 1brew install appledoc Homebrewé»˜è®¤ä¸å®‰è£…æ¨¡æ¿ã€‚ å®‰è£…æç¤ºè¦ä¿æŒæœ€æ–°ï¼Œåªéœ€è½¬åˆ°ç»ˆç«¯å¹¶è¿›å…¥appledocç›®å½•ï¼Œå‘å‡ºgit pullå¹¶é‡æ–°ç¼–è¯‘appledoc.xcodeprojã€‚ä¸è¦å¿˜è®°è¦†ç›–å·²å¤åˆ¶åˆ°$ PATHçš„appledocå¯æ‰§è¡Œæ–‡ä»¶:) å¦‚æœæ‚¨è¿˜æƒ³ç¼–è¯‘å¹¶è¿è¡ŒAppledocTestsï¼ˆå•å…ƒæµ‹è¯•ï¼‰ç›®æ ‡ï¼Œåˆ™éœ€è¦åœ¨æ„å»ºå•å…ƒæµ‹è¯•ç›®æ ‡ä¹‹å‰å°†Librariesï¼†Frameworksç»„ä¸­æŒ‡ç¤ºçš„æ‰€æœ‰æ¡†æ¶å¤åˆ¶åˆ°å…±äº«æ¡†æ¶ç›®å½•ï¼æ„å»ºappledocå·¥å…·æœ¬èº«ä¸éœ€è¦è¿™æ ·åšã€‚ ä½¿ç”¨å‘½ä»¤è¡Œè¾“å…¥:1appledoc --no-create-docset --output ~/Desktop --project-name Runtime_Demo --project-company iDog --company-id com.iDog /Users/idog/Desktop/Object-C_Demo/Runtime_Demo æˆåŠŸä¹‹åå¯ä»¥çœ‹åˆ°:1appledoc version: 2.2.1 (build 1334) å‚æ•°è§£é‡Š: â€“no-create-docset // ä¸ç”Ÿæˆdocsetç±»å‹ï¼Œç”Ÿæˆhtml â€“output ~/Desktop // æ–‡æ¡£ç”Ÿæˆçš„ä½ç½® â€“project-name Runtime_Demo //å·¥ç¨‹çš„åå­—ï¼Œå…¶å®è¿™ä¸ªå¯ä»¥éšä¾¿å–ï¼Œè‡³å°‘å–æˆå·¥ç¨‹çš„åå­—å¯ä»¥çŸ¥é“è¿™ä¸ªæ–‡æ¡£æ˜¯å“ªä¸ª â€“project-company // å…¬å¸çš„åç§° â€“company-id com.ZQD // å…¬å¸çš„id ~/Desktop/JieLin6/JieLin6/Helpers/ //ä½ è¦ç”Ÿæˆæ–‡æ¡£çš„æ³¨é‡Šç±»æ‰€åœ¨çš„æ–‡ä»¶ç›®å½•ï¼ŒåŠå·¥ç¨‹ç›®å½• æ³¨é‡Šçš„æ ‡å‡†æ”¯æŒå¦‚ä¸‹ä¸‰ç§:1231. /*! this a test . */2. /** this a comment. */3. /// this is a long comment. */ ç»å¸¸ä½¿ç”¨çš„æ ‡ç­¾ï¼š 12345678@brief : ä½¿ç”¨å®ƒæ¥å†™ä¸€æ®µä½ æ­£åœ¨æ–‡æ¡£åŒ–çš„method, PRoperty, class, file, struct, æˆ–enumçš„çŸ­æè¿°ä¿¡æ¯ã€‚@discusstion: ç”¨å®ƒæ¥å†™ä¸€æ®µè¯¦å°½çš„æè¿°ã€‚å¦‚æœéœ€è¦ä½ å¯ä»¥æ·»åŠ æ¢è¡Œã€‚@param:é€šè¿‡å®ƒä½ å¯ä»¥æè¿°ä¸€ä¸ª method æˆ– functionçš„å‚æ•°ä¿¡æ¯ã€‚ä½ å¯ä»¥ä½¿ç”¨å¤šä¸ªè¿™ç§æ ‡ç­¾ã€‚@return: ç”¨å®ƒæ¥åˆ¶å®šä¸€ä¸ª method æˆ– functionçš„è¿”å›å€¼ã€‚@see: ç”¨å®ƒæ¥æŒ‡æ˜å…¶ä»–ç›¸å…³çš„ method æˆ– functionã€‚ä½ å¯ä»¥ä½¿ç”¨å¤šä¸ªè¿™ç§æ ‡ç­¾ã€‚@sa:åŒä¸Š@code ï¼š ä½¿ç”¨è¿™ä¸ªæ ‡ç­¾ï¼Œä½ å¯ä»¥åœ¨æ–‡æ¡£å½“ä¸­åµŒå…¥ä»£ç æ®µã€‚å½“åœ¨Help Inspectorå½“ä¸­æŸ¥çœ‹æ–‡æ¡£æ—¶ï¼Œä»£ç é€šè¿‡åœ¨ä¸€ä¸ªç‰¹åˆ«çš„ç›’å­ä¸­ç”¨ä¸€ç§ä¸åŒçš„å­—ä½“æ¥å±•ç¤ºã€‚å§‹ç»ˆè®°ä½åœ¨å†™çš„ä»£ç ç»“å°¾å¤„ä½¿ç”¨@endcodeæ ‡ç­¾ã€‚@remark : åœ¨å†™æ–‡æ¡£æ—¶ï¼Œç”¨å®ƒæ¥å¼ºè°ƒä»»ä½•å…³äºä»£ç çš„ç‰¹æ®Šä¹‹å¤„ã€‚ ä¸¾ä¾‹ï¼š12/*! @brief This property knows my name. */@property (nonatomic, strong) NSString *myName; è®°å½•æ–‡ä»¶å¸¸ç”¨æ ‡ç­¾ï¼š 123456789101112131415161718192021222324252627@file: ä½¿ç”¨è¿™ä¸ªæ ‡ç­¾æ¥æŒ‡å‡ºä½ æ­£åœ¨è®°å½•ä¸€ä¸ªæ–‡ä»¶ï¼ˆheader æ–‡ä»¶æˆ–ä¸æ˜¯ï¼‰ã€‚å¦‚æœä½ å°†ä½¿ç”¨Doxygenæ¥è¾“å‡ºæ–‡æ¡£ï¼Œé‚£ä¹ˆä½ æœ€å¥½åœ¨è¿™ä¸ªæ ‡ç­¾åé¢ç´§æ¥ç€å†™ä¸Šæ–‡ä»¶åå­—ã€‚å®ƒæ˜¯ä¸€ä¸ªtop level æ ‡ç­¾ã€‚@header: è·Ÿä¸Šé¢çš„ç±»ä¼¼ï¼Œä½†æ˜¯æ˜¯åœ¨ HeaderDocä¸­ä½¿ç”¨ã€‚å½“ä½ ä¸ä½¿ç”¨ Doxygenæ—¶ï¼Œä¸è¦ä½¿ç”¨ä¸Šé¢çš„æ ‡ç­¾ã€‚@authorï¼šç”¨å®ƒæ¥å†™ä¸‹è¿™ä¸ªæ–‡ä»¶çš„åˆ›å»ºè€…ä¿¡æ¯@copyright: æ·»åŠ ç‰ˆæƒä¿¡æ¯@version: ç”¨å®ƒæ¥å†™ä¸‹è¿™ä¸ªæ–‡ä»¶çš„å½“å‰ç‰ˆæœ¬ã€‚å¦‚æœåœ¨å·¥ç¨‹ç”Ÿå‘½å‘¨æœŸä¸­ç‰ˆæœ¬ä¿¡æ¯æœ‰å½±å“æ—¶è¿™ä¼šå¾ˆé‡è¦ã€‚å†ä¸€æ¬¡çš„ï¼Œæˆ‘åªç»™å‡ºæœ€å¸¸ç”¨çš„æ ‡ç­¾ã€‚è‡ªå·±æŸ¥çœ‹è¯´æ˜æ–‡æ¡£äº†è§£æ›´å¤šæ ‡ç­¾ä¿¡æ¯ã€‚@class: ç”¨å®ƒæ¥æŒ‡å®šä¸€ä¸ªclassçš„æ³¨é‡Šæ–‡æ¡£å—çš„å¼€å¤´ã€‚å®ƒæ˜¯ä¸€ä¸ªtop levelæ ‡ç­¾ï¼Œåœ¨å®ƒåé¢åº”è¯¥ç»™å‡ºclassåå­—ã€‚@interface: åŒä¸Š@protocol: åŒä¸Šä¸¤ä¸ªä¸€æ ·ï¼Œåªæ˜¯é’ˆå¯¹protocols@superclass: å½“å‰classçš„superclass@classdesign: ç”¨è¿™ä¸ªæ ‡ç­¾æ¥æŒ‡å‡ºä½ ä¸ºå½“å‰classä½¿ç”¨çš„ä»»ä½•ç‰¹æ®Šè®¾è®¡æ¨¡å¼ï¼ˆä¾‹å¦‚ï¼Œä½ å¯ä»¥æåˆ°è¿™ä¸ªclassæ˜¯ä¸æ˜¯å•ä¾‹æ¨¡å¼æˆ–è€…ç±»ä¼¼å…¶å®ƒçš„æ¨¡å¼ï¼‰ã€‚@coclass: ä¸å½“å‰classåˆä½œçš„å¦å¤–ä¸€ä¸ªclassçš„åå­—ã€‚@helps: å½“å‰classå¸®åŠ©çš„classçš„åå­—ã€‚@helper: å¸®åŠ©å½“å‰classçš„classåå­—ã€‚ å‚è€ƒæ–‡æ¡£ é¡¹ç›®ä¸»é¡µ","categories":[{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/categories/å·¥å…·é›†/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/tags/iOS/"},{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/tags/å·¥å…·é›†/"}]},{"title":"Charles ä»å…¥é—¨åˆ°ç²¾é€š","slug":"Charles ä»å…¥é—¨åˆ°ç²¾é€š","date":"2019-04-23T09:17:43.000Z","updated":"2019-04-24T09:22:10.107Z","comments":true,"path":"2019/04/23/Charles ä»å…¥é—¨åˆ°ç²¾é€š/","link":"","permalink":"https://bigporo.github.io/2019/04/23/Charles ä»å…¥é—¨åˆ°ç²¾é€š/","excerpt":"å·§ç¥åŸæ–‡ æœ¬æ–‡æ˜¯åœ¨å·§ç¥åŸæ–‡çš„åŸºç¡€ä¸Šï¼ŒæŒ‰ç…§æµç¨‹èµ°ä¸€éå¹¶è®°å½•ã€‚ ç®€ä»‹Charles æ˜¯åœ¨ Mac ä¸‹å¸¸ç”¨çš„ç½‘ç»œå°åŒ…æˆªå–å·¥å…·ï¼Œåœ¨åšç§»åŠ¨å¼€å‘æ—¶ï¼Œæˆ‘ä»¬ä¸ºäº†è°ƒè¯•ä¸æœåŠ¡å™¨ç«¯çš„ç½‘ç»œé€šè®¯åè®®ï¼Œå¸¸å¸¸éœ€è¦æˆªå–ç½‘ç»œå°åŒ…æ¥åˆ†æã€‚ Charles é€šè¿‡å°†è‡ªå·±è®¾ç½®æˆç³»ç»Ÿçš„ç½‘ç»œè®¿é—®ä»£ç†æœåŠ¡å™¨ï¼Œä½¿å¾—æ‰€æœ‰çš„ç½‘ç»œè®¿é—®è¯·æ±‚éƒ½é€šè¿‡å®ƒæ¥å®Œæˆï¼Œä»è€Œå®ç°äº†ç½‘ç»œå°åŒ…çš„æˆªå–å’Œåˆ†æã€‚ é™¤äº†åœ¨åšç§»åŠ¨å¼€å‘ä¸­è°ƒè¯•ç«¯å£å¤–ï¼ŒCharles ä¹Ÿå¯ä»¥ç”¨äºåˆ†æç¬¬ä¸‰æ–¹åº”ç”¨çš„é€šè®¯åè®®ã€‚é…åˆ Charles çš„ SSL åŠŸèƒ½ï¼ŒCharles è¿˜å¯ä»¥åˆ†æ Https åè®®ã€‚ Charles æ˜¯æ”¶è´¹è½¯ä»¶ï¼Œå¯ä»¥å…è´¹è¯•ç”¨ 30 å¤©ã€‚è¯•ç”¨æœŸè¿‡åï¼Œæœªä»˜è´¹çš„ç”¨æˆ·ä»ç„¶å¯ä»¥ç»§ç»­ä½¿ç”¨ï¼Œä½†æ˜¯æ¯æ¬¡ä½¿ç”¨æ—¶é—´ä¸èƒ½è¶…è¿‡ 30 åˆ†é’Ÿï¼Œå¹¶ä¸”å¯åŠ¨æ—¶å°†ä¼šæœ‰ 10 ç§’ç§çš„å»¶æ—¶ã€‚å› æ­¤ï¼Œè¯¥ä»˜è´¹æ–¹æ¡ˆå¯¹å¹¿å¤§ç”¨æˆ·è¿˜æ˜¯ç›¸å½“å‹å¥½çš„ï¼Œå³ä½¿ä½ é•¿æœŸä¸ä»˜è´¹ï¼Œä¹Ÿèƒ½ä½¿ç”¨å®Œæ•´çš„è½¯ä»¶åŠŸèƒ½ã€‚åªæ˜¯å½“ä½ éœ€è¦é•¿æ—¶é—´è¿›è¡Œå°åŒ…è°ƒè¯•æ—¶ï¼Œä¼šå› ä¸º Charles å¼ºåˆ¶å…³é—­è€Œé‡åˆ°å½±å“ã€‚ Charles ä¸»è¦çš„åŠŸèƒ½åŒ…æ‹¬ï¼š æˆªå– Http å’Œ Https ç½‘ç»œå°åŒ…ã€‚ æ”¯æŒé‡å‘ç½‘ç»œè¯·æ±‚ï¼Œæ–¹ä¾¿åç«¯è°ƒè¯•ã€‚ æ”¯æŒä¿®æ”¹ç½‘ç»œè¯·æ±‚å‚æ•°ã€‚ æ”¯æŒç½‘ç»œè¯·æ±‚çš„æˆªè·å¹¶åŠ¨æ€ä¿®æ”¹ã€‚ æ”¯æŒæ¨¡æ‹Ÿæ…¢é€Ÿç½‘ç»œã€‚","text":"å·§ç¥åŸæ–‡ æœ¬æ–‡æ˜¯åœ¨å·§ç¥åŸæ–‡çš„åŸºç¡€ä¸Šï¼ŒæŒ‰ç…§æµç¨‹èµ°ä¸€éå¹¶è®°å½•ã€‚ ç®€ä»‹Charles æ˜¯åœ¨ Mac ä¸‹å¸¸ç”¨çš„ç½‘ç»œå°åŒ…æˆªå–å·¥å…·ï¼Œåœ¨åšç§»åŠ¨å¼€å‘æ—¶ï¼Œæˆ‘ä»¬ä¸ºäº†è°ƒè¯•ä¸æœåŠ¡å™¨ç«¯çš„ç½‘ç»œé€šè®¯åè®®ï¼Œå¸¸å¸¸éœ€è¦æˆªå–ç½‘ç»œå°åŒ…æ¥åˆ†æã€‚ Charles é€šè¿‡å°†è‡ªå·±è®¾ç½®æˆç³»ç»Ÿçš„ç½‘ç»œè®¿é—®ä»£ç†æœåŠ¡å™¨ï¼Œä½¿å¾—æ‰€æœ‰çš„ç½‘ç»œè®¿é—®è¯·æ±‚éƒ½é€šè¿‡å®ƒæ¥å®Œæˆï¼Œä»è€Œå®ç°äº†ç½‘ç»œå°åŒ…çš„æˆªå–å’Œåˆ†æã€‚ é™¤äº†åœ¨åšç§»åŠ¨å¼€å‘ä¸­è°ƒè¯•ç«¯å£å¤–ï¼ŒCharles ä¹Ÿå¯ä»¥ç”¨äºåˆ†æç¬¬ä¸‰æ–¹åº”ç”¨çš„é€šè®¯åè®®ã€‚é…åˆ Charles çš„ SSL åŠŸèƒ½ï¼ŒCharles è¿˜å¯ä»¥åˆ†æ Https åè®®ã€‚ Charles æ˜¯æ”¶è´¹è½¯ä»¶ï¼Œå¯ä»¥å…è´¹è¯•ç”¨ 30 å¤©ã€‚è¯•ç”¨æœŸè¿‡åï¼Œæœªä»˜è´¹çš„ç”¨æˆ·ä»ç„¶å¯ä»¥ç»§ç»­ä½¿ç”¨ï¼Œä½†æ˜¯æ¯æ¬¡ä½¿ç”¨æ—¶é—´ä¸èƒ½è¶…è¿‡ 30 åˆ†é’Ÿï¼Œå¹¶ä¸”å¯åŠ¨æ—¶å°†ä¼šæœ‰ 10 ç§’ç§çš„å»¶æ—¶ã€‚å› æ­¤ï¼Œè¯¥ä»˜è´¹æ–¹æ¡ˆå¯¹å¹¿å¤§ç”¨æˆ·è¿˜æ˜¯ç›¸å½“å‹å¥½çš„ï¼Œå³ä½¿ä½ é•¿æœŸä¸ä»˜è´¹ï¼Œä¹Ÿèƒ½ä½¿ç”¨å®Œæ•´çš„è½¯ä»¶åŠŸèƒ½ã€‚åªæ˜¯å½“ä½ éœ€è¦é•¿æ—¶é—´è¿›è¡Œå°åŒ…è°ƒè¯•æ—¶ï¼Œä¼šå› ä¸º Charles å¼ºåˆ¶å…³é—­è€Œé‡åˆ°å½±å“ã€‚ Charles ä¸»è¦çš„åŠŸèƒ½åŒ…æ‹¬ï¼š æˆªå– Http å’Œ Https ç½‘ç»œå°åŒ…ã€‚ æ”¯æŒé‡å‘ç½‘ç»œè¯·æ±‚ï¼Œæ–¹ä¾¿åç«¯è°ƒè¯•ã€‚ æ”¯æŒä¿®æ”¹ç½‘ç»œè¯·æ±‚å‚æ•°ã€‚ æ”¯æŒç½‘ç»œè¯·æ±‚çš„æˆªè·å¹¶åŠ¨æ€ä¿®æ”¹ã€‚ æ”¯æŒæ¨¡æ‹Ÿæ…¢é€Ÿç½‘ç»œã€‚ å®‰è£… Charlesä¸‹è½½åœ°å€ å°† Charles è®¾ç½®æˆç³»ç»Ÿä»£ç†ä¹‹å‰æåˆ°ï¼ŒCharles æ˜¯é€šè¿‡å°†è‡ªå·±è®¾ç½®æˆä»£ç†æœåŠ¡å™¨æ¥å®Œæˆå°åŒ…æˆªå–çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ Charles çš„ç¬¬ä¸€æ­¥æ˜¯å°†å…¶è®¾ç½®æˆç³»ç»Ÿçš„ä»£ç†æœåŠ¡å™¨ã€‚ å¯åŠ¨ Charles åï¼Œç¬¬ä¸€æ¬¡ Charles ä¼šè¯·æ±‚ä½ ç»™å®ƒè®¾ç½®ç³»ç»Ÿä»£ç†çš„æƒé™ã€‚ä½ å¯ä»¥è¾“å…¥ç™»å½•å¯†ç æˆäºˆ Charles è¯¥æƒé™ã€‚ä½ ä¹Ÿå¯ä»¥å¿½ç•¥è¯¥è¯·æ±‚ï¼Œç„¶ååœ¨éœ€è¦å°† Charles è®¾ç½®æˆç³»ç»Ÿä»£ç†æ—¶ï¼Œé€‰æ‹©èœå•ä¸­çš„ â€œProxyâ€ -&gt; â€œMac OS X Proxyâ€ æ¥å°† Charles è®¾ç½®æˆç³»ç»Ÿä»£ç†ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š ä¹‹åï¼Œä½ å°±å¯ä»¥çœ‹åˆ°æºæºä¸æ–­çš„ç½‘ç»œè¯·æ±‚å‡ºç°åœ¨ Charles çš„ç•Œé¢ä¸­ã€‚ æ³¨æ„ï¼šå¼€å¯äº†VPNä¹‹åï¼Œä¼šå¯¼è‡´æŠ“å–ä¸åˆ°è¯·æ±‚ï¼Œéœ€è¦å…³é—­VPNã€‚ Charles ä¸»ç•Œé¢ä»‹ç»Charles ä¸»è¦æä¾›ä¸¤ç§æŸ¥çœ‹å°åŒ…çš„è§†å›¾ï¼Œåˆ†åˆ«åä¸º â€œStructureâ€ å’Œ â€œSequenceâ€ã€‚ Structure è§†å›¾å°†ç½‘ç»œè¯·æ±‚æŒ‰è®¿é—®çš„åŸŸååˆ†ç±»ã€‚ Sequence è§†å›¾å°†ç½‘ç»œè¯·æ±‚æŒ‰è®¿é—®çš„æ—¶é—´æ’åºã€‚ å¤§å®¶å¯ä»¥æ ¹æ®å…·ä½“çš„éœ€è¦åœ¨è¿™ä¸¤ç§è§†å›¾ä¹‹å‰æ¥å›åˆ‡æ¢ã€‚è¯·æ±‚å¤šäº†æœ‰äº›æ—¶å€™ä¼šçœ‹ä¸è¿‡æ¥ï¼ŒCharles æä¾›äº†ä¸€ä¸ªç®€å•çš„ Filter åŠŸèƒ½ï¼Œå¯ä»¥è¾“å…¥å…³é”®å­—æ¥å¿«é€Ÿç­›é€‰å‡º URL ä¸­å¸¦æŒ‡å®šå…³é”®å­—çš„ç½‘ç»œè¯·æ±‚ã€‚ å¯¹äºæŸä¸€ä¸ªå…·ä½“çš„ç½‘ç»œè¯·æ±‚ï¼Œä½ å¯ä»¥æŸ¥çœ‹å…¶è¯¦ç»†çš„è¯·æ±‚å†…å®¹å’Œå“åº”å†…å®¹ã€‚å¦‚æœè¯·æ±‚å†…å®¹æ˜¯ POST çš„è¡¨å•ï¼ŒCharles ä¼šè‡ªåŠ¨å¸®ä½ å°†è¡¨å•è¿›è¡Œåˆ†é¡¹æ˜¾ç¤ºã€‚å¦‚æœå“åº”å†…å®¹æ˜¯ JSON æ ¼å¼çš„ï¼Œé‚£ä¹ˆ Charles å¯ä»¥è‡ªåŠ¨å¸®ä½ å°† JSON å†…å®¹æ ¼å¼åŒ–ï¼Œæ–¹ä¾¿ä½ æŸ¥çœ‹ã€‚å¦‚æœå“åº”å†…å®¹æ˜¯å›¾ç‰‡ï¼Œé‚£ä¹ˆ Charles å¯ä»¥æ˜¾ç¤ºå‡ºå›¾ç‰‡çš„é¢„è§ˆã€‚ è¿‡æ»¤ç½‘ç»œè¯·æ±‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ç½‘ç»œè¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œåªç›‘æ§å‘æŒ‡å®šç›®å½•æœåŠ¡å™¨ä¸Šå‘é€çš„è¯·æ±‚ã€‚å¯¹äºè¿™ç§éœ€æ±‚ï¼Œä»¥ä¸‹å‡ ç§åŠæ³•ï¼š æ–¹æ³•ä¸€ï¼šåœ¨ä¸»ç•Œé¢çš„ä¸­éƒ¨çš„ Filter æ ä¸­å¡«å…¥éœ€è¦è¿‡æ»¤å‡ºæ¥çš„å…³é”®å­—ã€‚ä¾‹å¦‚æˆ‘ä»¬çš„æœåŠ¡å™¨çš„åœ°å€æ˜¯ï¼šhttps://www.ifeixiu.com, é‚£ä¹ˆåªéœ€è¦åœ¨ Filter æ ä¸­å¡«å…¥ ifeixiu å³å¯ã€‚ æ–¹æ³•äºŒï¼šåœ¨ Charles çš„èœå•æ é€‰æ‹© â€œProxyâ€-&gt;â€Recording Settingsâ€ï¼Œç„¶åé€‰æ‹© Include æ ï¼Œé€‰æ‹©æ·»åŠ ä¸€ä¸ªé¡¹ç›®ï¼Œç„¶åå¡«å…¥éœ€è¦ç›‘æ§çš„åè®®ï¼Œä¸»æœºåœ°å€ï¼Œç«¯å£å·ã€‚è¿™æ ·å°±å¯ä»¥åªæˆªå–ç›®æ ‡ç½‘ç«™çš„å°åŒ…äº†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šé€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨æ–¹æ³•ä¸€åšä¸€äº›ä¸´æ—¶æ€§çš„å°åŒ…è¿‡æ»¤ï¼Œä½¿ç”¨æ–¹æ³•äºŒåšä¸€äº›ç»å¸¸æ€§çš„å°åŒ…è¿‡æ»¤ã€‚ æ–¹æ³•ä¸‰ï¼šåœ¨æƒ³è¿‡æ»¤çš„ç½‘ç»œè¯·æ±‚ä¸Šå³å‡»ï¼Œé€‰æ‹© â€œFocusâ€ï¼Œä¹‹ååœ¨ Filter ä¸€æ å‹¾é€‰ä¸Š Focussed ä¸€é¡¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æˆªå– iPhone ä¸Šçš„ç½‘ç»œå°åŒ…Charles é€šå¸¸ç”¨æ¥æˆªå–æœ¬åœ°ä¸Šçš„ç½‘ç»œå°åŒ…ï¼Œä½†æ˜¯å½“æˆ‘ä»¬éœ€è¦æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ¥æˆªå–å…¶å®ƒè®¾å¤‡ä¸Šçš„ç½‘ç»œè¯·æ±‚ã€‚ä¸‹é¢æˆ‘å°±ä»¥ iPhone ä¸ºä¾‹ï¼Œè®²è§£å¦‚ä½•è¿›è¡Œç›¸åº”æ“ä½œã€‚ Charles ä¸Šçš„è®¾ç½®è¦æˆªå– iPhone ä¸Šçš„ç½‘ç»œè¯·æ±‚ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å°† Charles çš„ä»£ç†åŠŸèƒ½æ‰“å¼€ã€‚åœ¨ Charles çš„èœå•æ ä¸Šé€‰æ‹© â€œProxyâ€-&gt;â€Proxy Settingsâ€ï¼Œå¡«å…¥ä»£ç†ç«¯å£ 8888ï¼Œå¹¶ä¸”å‹¾ä¸Š â€œEnable transparent HTTP proxyingâ€ å°±å®Œæˆäº†åœ¨ Charles ä¸Šçš„è®¾ç½®ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º: iPhone ä¸Šçš„è®¾ç½®é¦–å…ˆæˆ‘ä»¬éœ€è¦è·å– Charles è¿è¡Œæ‰€åœ¨ç”µè„‘çš„ IP åœ°å€ï¼ŒCharles çš„é¡¶éƒ¨èœå•çš„ â€œHelpâ€-&gt;â€Local IP Addressâ€ï¼Œå³å¯åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­çœ‹åˆ° IP åœ°å€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åœ¨ iPhone çš„ â€œ è®¾ç½® â€œ-&gt;â€ æ— çº¿å±€åŸŸç½‘ â€œ ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰è¿æ¥çš„ wifi åï¼Œé€šè¿‡ç‚¹å‡»å³è¾¹çš„è¯¦æƒ…é”®ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰è¿æ¥ä¸Šçš„ wifi çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ IP åœ°å€ï¼Œå­ç½‘æ©ç ç­‰ä¿¡æ¯ã€‚åœ¨å…¶æœ€åº•éƒ¨æœ‰ã€ŒHTTP ä»£ç†ã€ä¸€é¡¹ï¼Œæˆ‘ä»¬å°†å…¶åˆ‡æ¢æˆæ‰‹åŠ¨ï¼Œç„¶åå¡«ä¸Š Charles è¿è¡Œæ‰€åœ¨çš„ç”µè„‘çš„ IPï¼Œä»¥åŠç«¯å£å· 8888ã€‚ è®¾ç½®å¥½ä¹‹åï¼Œæˆ‘ä»¬æ‰“å¼€ iPhone ä¸Šçš„ä»»æ„éœ€è¦ç½‘ç»œé€šè®¯çš„ç¨‹åºï¼Œå°±å¯ä»¥çœ‹åˆ° Charles å¼¹å‡º iPhone è¯·æ±‚è¿æ¥çš„ç¡®è®¤èœå•ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼Œç‚¹å‡» â€œAllowâ€ å³å¯å®Œæˆè®¾ç½®ã€‚ æˆªå– Https é€šè®¯ä¿¡æ¯å®‰è£…è¯ä¹¦å¦‚æœä½ éœ€è¦æˆªå–åˆ†æ Https åè®®ç›¸å…³çš„å†…å®¹ã€‚é‚£ä¹ˆéœ€è¦å®‰è£… Charles çš„ CA è¯ä¹¦ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ã€‚ é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨ Mac ç”µè„‘ä¸Šå®‰è£…è¯ä¹¦ã€‚ç‚¹å‡» Charles çš„é¡¶éƒ¨èœå•ï¼Œé€‰æ‹© â€œHelpâ€ -&gt; â€œSSL Proxyingâ€ -&gt; â€œInstall Charles Root Certificateâ€ï¼Œç„¶åè¾“å…¥ç³»ç»Ÿçš„å¸å·å¯†ç ï¼Œå³å¯åœ¨ KeyChain çœ‹åˆ°æ·»åŠ å¥½çš„è¯ä¹¦ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿æ˜¯å®‰è£…å®Œè¯ä¹¦ä¹‹åï¼ŒCharles é»˜è®¤ä¹Ÿå¹¶ä¸æˆªå– Https ç½‘ç»œé€šè®¯çš„ä¿¡æ¯ï¼Œå¦‚æœä½ æƒ³å¯¹æˆªå–æŸä¸ªç½‘ç«™ä¸Šçš„æ‰€æœ‰ Https ç½‘ç»œè¯·æ±‚ï¼Œå¯ä»¥åœ¨è¯¥è¯·æ±‚ä¸Šå³å‡»ï¼Œé€‰æ‹© SSL proxyï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æˆªå–ç§»åŠ¨è®¾å¤‡ä¸­çš„ Https é€šè®¯ä¿¡æ¯å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨ iOS æˆ– Android æœºå™¨ä¸Šæˆªå– Https åè®®çš„é€šè®¯å†…å®¹ï¼Œè¿˜éœ€è¦åœ¨æ‰‹æœºä¸Šå®‰è£…ç›¸åº”çš„è¯ä¹¦ã€‚ç‚¹å‡» Charles çš„é¡¶éƒ¨èœå•ï¼Œé€‰æ‹© â€œHelpâ€ -&gt; â€œSSL Proxyingâ€ -&gt; â€œInstall Charles Root Certificate on a Mobile Device or Remote Browserâ€ï¼Œç„¶åå°±å¯ä»¥çœ‹åˆ° Charles å¼¹å‡ºçš„ç®€å•çš„å®‰è£…æ•™ç¨‹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è¿™æ ·ï¼Œå¯¹äºè¯¥ Host çš„æ‰€æœ‰ SSL è¯·æ±‚å¯ä»¥è¢«æˆªå–åˆ°äº†ã€‚ æŒ‰ç…§æˆ‘ä»¬ä¹‹å‰è¯´çš„æ•™ç¨‹ï¼Œåœ¨è®¾å¤‡ä¸Šè®¾ç½®å¥½ Charles ä¸ºä»£ç†åï¼Œåœ¨æ‰‹æœºæµè§ˆå™¨ä¸­è®¿é—®åœ°å€ï¼šhttp://charlesproxy.com/getsslï¼Œå³å¯æ‰“å¼€è¯ä¹¦å®‰è£…çš„ç•Œé¢ï¼Œå®‰è£…å®Œè¯ä¹¦åï¼Œå°±å¯ä»¥æˆªå–æ‰‹æœºä¸Šçš„ Https é€šè®¯å†…å®¹äº†ã€‚ä¸è¿‡åŒæ ·éœ€è¦æ³¨æ„ï¼Œé»˜è®¤æƒ…å†µä¸‹ Charles å¹¶ä¸åšæˆªå–ï¼Œä½ è¿˜éœ€è¦åœ¨è¦æˆªå–çš„ç½‘ç»œè¯·æ±‚ä¸Šå³å‡»ï¼Œé€‰æ‹© SSL proxy èœå•é¡¹ã€‚ å¯èƒ½é‡åˆ°çš„é—®é¢˜Charlesä¹±ç  3.10ç‰ˆæœ¬ä¹‹å‰: å»http://www.charlesproxy.com/ssl.zip ä¸‹è½½ CA è¯ä¹¦æ–‡ä»¶ï¼Œç„¶ååŒå‡» .crt æ–‡ä»¶ï¼Œé€‰æ‹©â€˜æ€»æ˜¯ä¿¡ä»»â€™æŒ‰é’®ï¼Œåœ¨é’¥åŒ™ä¸²è®¿é—®ä¸­å³å¯çœ‹åˆ°æ·»åŠ æˆåŠŸçš„è¯ä¹¦ã€‚ 4.02ç‰ˆæœ¬ä»¥å å…ˆç‚¹proxyä¸­çš„macOS Proxy ï¼Œå¦‚æœè¿›è¡Œäº†ç½‘ç»œè¯·æ±‚ï¼Œä½†æ˜¯Charlesæ²¡æœ‰å‡ºç°æ•°æ®çš„è¯ï¼ŒæŠŠç¿»å¢™è½¯ä»¶å…³äº†ã€‚ ç„¶åå»é’¥åŒ™ä¸²æ‰¾åˆ°Charlesçš„CAè¯ä¹¦ï¼ŒåŒå‡»ä¿®æ”¹å¦‚ä¸‹ã€‚ å…³é—­çª—å£å°±å¯ä»¥çœ‹åˆ°è¯ä¹¦å˜æˆ: æ¥ä¸‹æ¥ç‚¹å‡»proxyä¸­çš„SSL Proxying Settingsï¼Œå‡ºç°å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç„¶åç‚¹add åœ¨Hosté‡Œå¡« * å· ï¼Œåœ¨Porté‡Œå¡«443ï¼Œç„¶åç‚¹okï¼šæ¨¡æ‹Ÿæ…¢é€Ÿç½‘ç»œåœ¨åšç§»åŠ¨å¼€å‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦æ¨¡æ‹Ÿæ…¢é€Ÿç½‘ç»œæˆ–è€…é«˜å»¶è¿Ÿçš„ç½‘ç»œï¼Œä»¥æµ‹è¯•åœ¨ç§»åŠ¨ç½‘ç»œä¸‹ï¼Œåº”ç”¨çš„è¡¨ç°æ˜¯å¦æ­£å¸¸ã€‚Charles å¯¹æ­¤éœ€æ±‚æä¾›äº†å¾ˆå¥½çš„æ”¯æŒã€‚ åœ¨ Charles çš„èœå•ä¸Šï¼Œé€‰æ‹© â€œProxyâ€-&gt;â€Throttle Settingâ€ é¡¹ï¼Œåœ¨ä¹‹åå¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å‹¾é€‰ä¸Š â€œEnable Throttlingâ€ï¼Œå¹¶ä¸”å¯ä»¥è®¾ç½® Throttle Preset çš„ç±»å‹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å¦‚æœæˆ‘ä»¬åªæƒ³æ¨¡æ‹ŸæŒ‡å®šç½‘ç«™çš„æ…¢é€Ÿç½‘ç»œï¼Œå¯ä»¥å†å‹¾é€‰ä¸Šå›¾ä¸­çš„ â€œOnly for selected hostsâ€ é¡¹ï¼Œç„¶ååœ¨å¯¹è¯æ¡†çš„ä¸‹åŠéƒ¨åˆ†è®¾ç½®ä¸­å¢åŠ æŒ‡å®šçš„ hosts é¡¹å³å¯ã€‚ ä¿®æ”¹ç½‘ç»œè¯·æ±‚å†…å®¹æœ‰äº›æ—¶å€™ä¸ºäº†è°ƒè¯•æœåŠ¡å™¨çš„æ¥å£ï¼Œæˆ‘ä»¬éœ€è¦åå¤å°è¯•ä¸åŒå‚æ•°çš„ç½‘ç»œè¯·æ±‚ã€‚Charles å¯ä»¥æ–¹ä¾¿åœ°æä¾›ç½‘ç»œè¯·æ±‚çš„ä¿®æ”¹å’Œé‡å‘åŠŸèƒ½ã€‚åªéœ€è¦åœ¨ä»¥å¾€çš„ç½‘ç»œè¯·æ±‚ä¸Šç‚¹å‡»å³é”®ï¼Œé€‰æ‹© â€œEditâ€ï¼Œå³å¯åˆ›å»ºä¸€ä¸ªå¯ç¼–è¾‘çš„ç½‘ç»œè¯·æ±‚ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š ç»™æœåŠ¡å™¨åšå‹åŠ›æµ‹è¯•æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Charles çš„ Repeat åŠŸèƒ½æ¥ç®€å•åœ°æµ‹è¯•æœåŠ¡å™¨çš„å¹¶å‘å¤„ç†èƒ½åŠ›ï¼Œæ–¹æ³•å¦‚ä¸‹ã€‚ æˆ‘ä»¬åœ¨æƒ³æ‰“å‹çš„ç½‘ç»œè¯·æ±‚ä¸Šï¼ˆPOST æˆ– GET è¯·æ±‚å‡å¯ï¼‰å³å‡»ï¼Œç„¶åé€‰æ‹© ã€ŒRepeat Advancedã€èœå•é¡¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š æ¥ç€æˆ‘ä»¬å°±å¯ä»¥åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ï¼Œé€‰æ‹©æ‰“å‹çš„å¹¶å‘çº¿ç¨‹æ•°ä»¥åŠæ‰“å‹æ¬¡æ•°ï¼Œç¡®å®šä¹‹åï¼Œå³å¯å¼€å§‹æ‰“å‹ã€‚ æ‚„æ‚„è¯´ä¸€å¥ï¼Œä¸€äº›å†™å¾—å¾ˆå¼±çš„æŠ•ç¥¨ç½‘ç«™ï¼Œä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªåŠæ³•æ¥å¿«é€ŸæŠ•ç¥¨ã€‚å½“ç„¶ï¼Œæˆ‘ä¹Ÿå¯ä»¥ç”¨ Charles çš„ Repeat åŠŸèƒ½ç»™ä¸€äº›è¯ˆéª—çš„é’“é±¼ç½‘ç«™å–‚äº†ä¸å°‘åƒåœ¾æ•°æ®ã€‚ ä¿®æ”¹æœåŠ¡å™¨è¿”å›å†…å®¹æœ‰äº›æ—¶å€™æˆ‘ä»¬æƒ³è®©æœåŠ¡å™¨è¿”å›ä¸€äº›æŒ‡å®šçš„å†…å®¹ï¼Œæ–¹ä¾¿æˆ‘ä»¬è°ƒè¯•ä¸€äº›ç‰¹æ®Šæƒ…å†µã€‚ä¾‹å¦‚åˆ—è¡¨é¡µé¢ä¸ºç©ºçš„æƒ…å†µï¼Œæ•°æ®å¼‚å¸¸çš„æƒ…å†µï¼Œéƒ¨åˆ†è€—æ—¶çš„ç½‘ç»œè¯·æ±‚è¶…æ—¶çš„æƒ…å†µç­‰ã€‚å¦‚æœæ²¡æœ‰ Charlesï¼Œè¦æœåŠ¡å™¨é…åˆæ„é€ ç›¸åº”çš„æ•°æ®æ˜¾å¾—ä¼šæ¯”è¾ƒéº»çƒ¦ã€‚è¿™ä¸ªæ—¶å€™ï¼Œä½¿ç”¨ Charles ç›¸å…³çš„åŠŸèƒ½å°±å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚ æ ¹æ®å…·ä½“çš„éœ€æ±‚ï¼ŒCharles æä¾›äº† Map åŠŸèƒ½ã€ Rewrite åŠŸèƒ½ä»¥åŠ Breakpoints åŠŸèƒ½ï¼Œéƒ½å¯ä»¥è¾¾åˆ°ä¿®æ”¹æœåŠ¡å™¨è¿”å›å†…å®¹çš„ç›®çš„ã€‚è¿™ä¸‰è€…åœ¨åŠŸèƒ½ä¸Šçš„å·®å¼‚æ˜¯ï¼š Map åŠŸèƒ½é€‚åˆé•¿æœŸåœ°å°†æŸä¸€äº›è¯·æ±‚é‡å®šå‘åˆ°å¦ä¸€ä¸ªç½‘ç»œåœ°å€æˆ–æœ¬åœ°æ–‡ä»¶ã€‚ Rewrite åŠŸèƒ½é€‚åˆå¯¹ç½‘ç»œè¯·æ±‚è¿›è¡Œä¸€äº›æ­£åˆ™æ›¿æ¢ã€‚ Breakpoints åŠŸèƒ½é€‚åˆåšä¸€äº›ä¸´æ—¶æ€§çš„ä¿®æ”¹ã€‚ Map åŠŸèƒ½Charles çš„ Map åŠŸèƒ½åˆ† Map Remote å’Œ Map Local ä¸¤ç§ã€‚é¡¾åæ€ä¹‰ï¼ŒMap Remote æ˜¯å°†æŒ‡å®šçš„ç½‘ç»œè¯·æ±‚é‡å®šå‘åˆ°å¦ä¸€ä¸ªç½‘å€è¯·æ±‚åœ°å€ï¼ŒMap Local æ˜¯å°†æŒ‡å®šçš„ç½‘ç»œè¯·æ±‚é‡å®šå‘åˆ°æœ¬åœ°æ–‡ä»¶ã€‚ åœ¨ Charles çš„èœå•ä¸­ï¼Œé€‰æ‹© â€œToolsâ€-&gt;â€Map Remoteâ€ æˆ– â€œMap Localâ€ å³å¯è¿›å…¥åˆ°ç›¸åº”åŠŸèƒ½çš„è®¾ç½®é¡µé¢ã€‚ä¹Ÿå¯ä»¥é€‰ä¸­ä¸€ä¸ªè¯·æ±‚ï¼Œå³å‡»é€‰æ‹©å¯¹åº”çš„æ“ä½œã€‚ å¯¹äº Map Remote åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦åˆ†åˆ«å¡«å†™ç½‘ç»œé‡å®šå‘çš„æºåœ°å€å’Œç›®çš„åœ°å€ï¼Œå¯¹äºä¸éœ€è¦é™åˆ¶çš„æ¡ä»¶ï¼Œå¯ä»¥ç•™ç©ºã€‚ä¸‹å›¾æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œæˆ‘å°†æ‰€æœ‰ dev.ifeixiu.comï¼ˆæµ‹è¯•æœåŠ¡å™¨ï¼‰çš„è¯·æ±‚é‡å®šå‘åˆ°äº† ifeixiu.comï¼ˆçº¿ä¸ŠæœåŠ¡å™¨ï¼‰ã€‚ å¯¹äº Map Local åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦å¡«å†™çš„é‡å®šå‘çš„æºåœ°å€å’Œæœ¬åœ°çš„ç›®æ ‡æ–‡ä»¶ã€‚å¯¹äºæœ‰ä¸€äº›å¤æ‚çš„ç½‘ç»œè¯·æ±‚ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä½¿ç”¨ Charles æä¾›çš„ â€œSave Responseâ€¦â€ åŠŸèƒ½ï¼Œå°†è¯·æ±‚ç»“æœä¿å­˜åˆ°æœ¬åœ°ï¼Œç„¶åç¨åŠ ä¿®æ”¹ï¼Œæˆä¸ºæˆ‘ä»¬çš„ç›®æ ‡æ˜ å°„æ–‡ä»¶ã€‚ ä¸‹å›¾æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œæˆ‘å°†ä¸€ä¸ªæŒ‡å®šçš„ç½‘ç»œè¯·æ±‚é€šè¿‡ Map Local åŠŸèƒ½æ˜ å°„åˆ°äº†æœ¬åœ°çš„ä¸€ä¸ªç»è¿‡ä¿®æ”¹çš„æ–‡ä»¶ä¸­ã€‚ Map Local åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªæ½œåœ¨çš„é—®é¢˜ï¼Œå°±æ˜¯å…¶è¿”å›çš„ Http Response Header ä¸æ­£å¸¸çš„è¯·æ±‚å¹¶ä¸ä¸€æ ·ã€‚è¿™ä¸ªæ—¶å€™å¦‚æœå®¢æˆ·ç«¯æ ¡éªŒäº† Http Response Header ä¸­çš„éƒ¨åˆ†å†…å®¹ï¼Œå°±ä¼šä½¿å¾—è¯¥åŠŸèƒ½å¤±æ•ˆã€‚è§£å†³åŠæ³•æ˜¯åŒæ—¶ä½¿ç”¨ Map Local ä»¥ä¸‹é¢æåˆ°çš„ Rewrite åŠŸèƒ½ï¼Œå°†ç›¸å…³çš„ Http å¤´ Rewrite æˆæˆ‘ä»¬å¸Œæœ›çš„å†…å®¹ã€‚ Rewrite åŠŸèƒ½Rewrite åŠŸèƒ½åŠŸèƒ½é€‚åˆå¯¹æŸä¸€ç±»ç½‘ç»œè¯·æ±‚è¿›è¡Œä¸€äº›æ­£åˆ™æ›¿æ¢ï¼Œä»¥è¾¾åˆ°ä¿®æ”¹ç»“æœçš„ç›®çš„ã€‚ Breakpoints åŠŸèƒ½ä¸Šé¢æä¾›çš„ Rewrite åŠŸèƒ½æœ€é€‚åˆåšæ‰¹é‡å’Œé•¿æœŸçš„æ›¿æ¢ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬åªæ˜¯æƒ³ä¸´æ—¶ä¿®æ”¹ä¸€æ¬¡ç½‘ç»œè¯·æ±‚ç»“æœï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä½¿ç”¨ Rewrite åŠŸèƒ½è™½ç„¶ä¹Ÿå¯ä»¥è¾¾åˆ°ç›®çš„ï¼Œä½†æ˜¯è¿‡äºéº»çƒ¦ï¼Œå¯¹äºä¸´æ—¶æ€§çš„ä¿®æ”¹ï¼Œæˆ‘ä»¬æœ€å¥½ä½¿ç”¨ Breakpoints åŠŸèƒ½ã€‚ Breakpoints åŠŸèƒ½ç±»ä¼¼æˆ‘ä»¬åœ¨ Xcode ä¸­è®¾ç½®çš„æ–­ç‚¹ä¸€æ ·ï¼Œå½“æŒ‡å®šçš„ç½‘ç»œè¯·æ±‚å‘ç”Ÿæ—¶ï¼ŒCharles ä¼šæˆªè·è¯¥è¯·æ±‚ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Charles ä¸­ä¸´æ—¶ä¿®æ”¹ç½‘ç»œè¯·æ±‚çš„è¿”å›å†…å®¹ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨ Breakpoints åŠŸèƒ½å°†ç½‘ç»œè¯·æ±‚æˆªè·å¹¶ä¿®æ”¹è¿‡ç¨‹ä¸­ï¼Œæ•´ä¸ªç½‘ç»œè¯·æ±‚çš„è®¡æ—¶å¹¶ä¸ä¼šæš‚åœï¼Œæ‰€ä»¥é•¿æ—¶é—´çš„æš‚åœå¯èƒ½å¯¼è‡´å®¢æˆ·ç«¯çš„è¯·æ±‚è¶…æ—¶ã€‚ åå‘ä»£ç†Charles çš„åå‘ä»£ç†åŠŸèƒ½å…è®¸æˆ‘ä»¬å°†æœ¬åœ°çš„ç«¯å£æ˜ å°„åˆ°è¿œç¨‹çš„å¦ä¸€ä¸ªç«¯å£ä¸Šã€‚ è®¾ç½®å¤–éƒ¨ä»£ç†ï¼Œè§£å†³ä¸ç¿»å¢™è½¯ä»¶çš„å†²çªCharles çš„åŸç†æ˜¯æŠŠè‡ªå·±è®¾ç½®æˆç³»ç»Ÿçš„ä»£ç†æœåŠ¡å™¨ï¼Œä½†æ˜¯åœ¨ä¸­å›½ï¼Œç”±äºå·¥ä½œéœ€è¦ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦ä½¿ç”¨ Google æœç´¢ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†ç¨‹åºå‘˜éƒ½æœ‰è‡ªå·±çš„ç¿»å¢™è½¯ä»¶ï¼Œè€Œè¿™äº›è½¯ä»¶çš„åŸºæœ¬åŸç†ï¼Œä¹Ÿæ˜¯æŠŠè‡ªå·±è®¾ç½®æˆç³»ç»Ÿçš„ä»£ç†æœåŠ¡å™¨ï¼Œæ¥åšåˆ°é€æ˜çš„ç¿»å¢™ã€‚ ä¸ºäº†ä½¿å¾—ä¸¤è€…èƒ½å¤Ÿå’Œå¹³å…±å¤„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Charles çš„ External Proxy Settings ä¸­ï¼Œè®¾ç½®ç¿»å¢™çš„ä»£ç†ç«¯å£ä»¥åŠç›¸å…³ä¿¡æ¯ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿè¦å…³é—­ç›¸å…³ç¿»å¢™è½¯ä»¶çš„è‡ªåŠ¨è®¾ç½®ï¼Œä½¿å…¶ä¸ä¸»åŠ¨ä¿®æ”¹ç³»ç»Ÿä»£ç†ï¼Œé¿å… Charles å¤±æ•ˆã€‚ æ€»ç»“é€šè¿‡ Charles è½¯ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆªå–å’Œè°ƒè¯•ç½‘ç»œè¯·æ±‚å†…å®¹ï¼Œåˆ†æå°åŒ…åè®®ä»¥åŠæ¨¡æ‹Ÿæ…¢é€Ÿç½‘ç»œã€‚ç”¨å¥½ Charles å¯ä»¥æå¤§çš„æ–¹ä¾¿æˆ‘ä»¬å¯¹äºå¸¦æœ‰ç½‘ç»œè¯·æ±‚çš„ App çš„å¼€å‘å’Œè°ƒè¯•ã€‚","categories":[{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/categories/å·¥å…·é›†/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/tags/iOS/"},{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/tags/å·¥å…·é›†/"}]},{"title":"cocoapodså®‰è£…åŠä½¿ç”¨","slug":"cocoapodså®‰è£…åŠä½¿ç”¨","date":"2019-04-23T09:17:43.000Z","updated":"2019-04-24T09:22:31.375Z","comments":true,"path":"2019/04/23/cocoapodså®‰è£…åŠä½¿ç”¨/","link":"","permalink":"https://bigporo.github.io/2019/04/23/cocoapodså®‰è£…åŠä½¿ç”¨/","excerpt":"å‚è€ƒæ–‡æ¡£ å‚è€ƒæ–‡æ¡£ CocoaPods ç®€ä»‹æ¯ç§è¯­è¨€å‘å±•åˆ°ä¸€ä¸ªé˜¶æ®µï¼Œå°±ä¼šå‡ºç°ç›¸åº”çš„ä¾èµ–ç®¡ç†å·¥å…·ï¼Œä¾‹å¦‚ Java è¯­è¨€çš„ Mavenï¼Œnodejs çš„ npmã€‚éšç€ iOS å¼€å‘è€…çš„å¢å¤šï¼Œä¸šç•Œä¹Ÿå‡ºç°äº†ä¸º iOS ç¨‹åºæä¾›ä¾èµ–ç®¡ç†çš„å·¥å…·ï¼Œå®ƒçš„åå­—å«åšï¼šCocoaPodsã€‚ CocoaPodsé¡¹ç›®çš„æºç  åœ¨ Github ä¸Šç®¡ç†ã€‚è¯¥é¡¹ç›®å¼€å§‹äº 2011 å¹´ 8 æœˆ 12 æ—¥ï¼Œç»è¿‡å¤šå¹´å‘å±•ï¼Œç°åœ¨å·²ç»æˆä¸º iOS å¼€å‘äº‹å®ä¸Šçš„ä¾èµ–ç®¡ç†æ ‡å‡†å·¥å…·ã€‚å¼€å‘ iOS é¡¹ç›®ä¸å¯é¿å…åœ°è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹å¼€æºåº“ï¼ŒCocoaPods çš„å‡ºç°ä½¿å¾—æˆ‘ä»¬å¯ä»¥èŠ‚çœè®¾ç½®å’Œæ›´æ–°ç¬¬ä¸‰æ–¹å¼€æºåº“çš„æ—¶é—´ã€‚","text":"å‚è€ƒæ–‡æ¡£ å‚è€ƒæ–‡æ¡£ CocoaPods ç®€ä»‹æ¯ç§è¯­è¨€å‘å±•åˆ°ä¸€ä¸ªé˜¶æ®µï¼Œå°±ä¼šå‡ºç°ç›¸åº”çš„ä¾èµ–ç®¡ç†å·¥å…·ï¼Œä¾‹å¦‚ Java è¯­è¨€çš„ Mavenï¼Œnodejs çš„ npmã€‚éšç€ iOS å¼€å‘è€…çš„å¢å¤šï¼Œä¸šç•Œä¹Ÿå‡ºç°äº†ä¸º iOS ç¨‹åºæä¾›ä¾èµ–ç®¡ç†çš„å·¥å…·ï¼Œå®ƒçš„åå­—å«åšï¼šCocoaPodsã€‚ CocoaPodsé¡¹ç›®çš„æºç  åœ¨ Github ä¸Šç®¡ç†ã€‚è¯¥é¡¹ç›®å¼€å§‹äº 2011 å¹´ 8 æœˆ 12 æ—¥ï¼Œç»è¿‡å¤šå¹´å‘å±•ï¼Œç°åœ¨å·²ç»æˆä¸º iOS å¼€å‘äº‹å®ä¸Šçš„ä¾èµ–ç®¡ç†æ ‡å‡†å·¥å…·ã€‚å¼€å‘ iOS é¡¹ç›®ä¸å¯é¿å…åœ°è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹å¼€æºåº“ï¼ŒCocoaPods çš„å‡ºç°ä½¿å¾—æˆ‘ä»¬å¯ä»¥èŠ‚çœè®¾ç½®å’Œæ›´æ–°ç¬¬ä¸‰æ–¹å¼€æºåº“çš„æ—¶é—´ã€‚ CocoaPods çš„å®‰è£…å’Œä½¿ç”¨ä»‹ç»å®‰è£… å‡çº§ gem: 1sudo gem update --system æ¥ä¸‹æ¥è¾“å…¥ç³»ç»Ÿå¯†ç å°±å¯ä»¥å®‰è£…äº†ï¼Œè¾“å…¥å¯†ç æ—¶ä¸ä¼šæ˜¾ç¤ºçš„ï¼Œè¾“å®Œå›è½¦å°±è¡Œäº† å¦å¤–ï¼Œruby çš„è½¯ä»¶æº https://rubygems.org å› ä¸ºä½¿ç”¨çš„æ˜¯äºšé©¬é€Šçš„äº‘æœåŠ¡ï¼Œæ‰€ä»¥è¢«å¢™äº†ï¼Œéœ€è¦æ›´æ–°ä¸€ä¸‹ ruby çš„æºï¼Œä½¿ç”¨å¦‚ä¸‹ä»£ç å°†å®˜æ–¹çš„ ruby æºæ›¿æ¢æˆå›½å†…çš„æºï¼š 12gem sources --remove https://rubygems.org/gem sources --add https://gems.ruby-china.com/ æ¥ä¸‹æ¥æŸ¥çœ‹ä¸‹æºè·¯å¾„æ˜¯å¦æ›´æ¢äº† 1gem sources -l å¦‚æœæ˜¯ä»¥ä¸‹ç»“æœè¯´æ˜æ­£ç¡®.123*** CURRENT SOURCES ***https://gems.ruby-china.com/ è¿™æ—¶å€™æ‰æ­£å¼å¼€å§‹å®‰è£…CocoaPods1sudo gem install cocoapods å¦‚æœå‡ºç°è¿™ä¸ªäº†,æŒ‡çš„æ˜¯ä½ æ²¡æœ‰æƒé™ è¾“å…¥è¿™ä¸ª1sudo gem install -n /usr/local/bin cocoapods å¦‚æœæ˜¾ç¤ºè¿™ä¸ªè¡¨ç¤ºå®‰è£…æˆåŠŸ å®‰è£…æœ¬åœ°åº“ 1pod setup æ‰§è¡Œä»¥ä¸Šå‘½ä»¤åå°±æ˜¯æ¼«é•¿çš„ç­‰å¾…ï¼Œå½“ç„¶,ç½‘ç»œå¥½çš„æƒ…å†µä¸‹ä¼šæ›´å¿« 123456Setting up CocoaPods master repo $ /usr/bin/git clone https://github.com/CocoaPods/Specs.git master --progress Cloning into &apos;master&apos;... remote: Counting objects: 1879515, done. remote: Compressing objects: 100% (321/321), done. Receiving objects: 21% (404525/1879515), 73.70 MiB | 22.00 KiB/ è¦æŸ¥çœ‹æ–‡ä»¶ä¸‹è½½è¿›åº¦çš„å¯ä»¥å¦å¤–æ‰“å¼€ä¸€ä¸ªç»ˆç«¯çª—å£(å¿«æ·é”®:é€‰ä¸­ç»ˆç«¯æŒ‰ä¸‹Command+Nç»„åˆé”®)ï¼Œè¾“å…¥ä»¥ä¸‹ä¸¤è¡Œå‘½ä»¤å›è½¦æ‰§è¡Œ 123cd ~/.cocoapodsdu -sh * æ‰§è¡Œdu -sh *ä¹‹åä¼šæ˜¾ç¤ºå·²ä¸‹è½½çš„æ–‡ä»¶å¤§å°ï¼Œå¯ä»¥å¤šæ¬¡æ‰§è¡Œæ¥ç›‘çœ‹ä¸‹è½½è¿›åº¦ï¼Œå¦‚æœä¹‹å‰è¿˜æœ‰æ–‡ä»¶å¤§å°ï¼Œåæ¥å˜æˆ0äº†ï¼Œå¯èƒ½æ˜¯ç½‘ç»œé—®é¢˜ï¼Œä¸‹è½½å·²ç»ä¸­æ–­äº†,éœ€è¦ç»“æŸå‘½ä»¤å¹¶ä»æ–°æ‰§è¡Œ pod setup ä¸‹è½½å®‰è£…å®Œæˆä¹‹åå¯æ‰§è¡Œä¸‹åˆ—å‘½ä»¤æ£€æŸ¥æ˜¯å¦å¯ç”¨ï¼ˆç¬¬ä¸€æ¬¡ä½¿ç”¨å¯èƒ½è¦ç­‰ä¸€ä¼šï¼‰1pod search AFNetworking ç»“æœæ˜¯è¿™æ ·çš„å°±å¦¥äº†(è¾“å…¥qå›åˆ°ç»ˆç«¯æ§åˆ¶ç•Œé¢) ä½¿ç”¨ CocoaPodsä½¿ç”¨æ—¶éœ€è¦æ–°å»ºä¸€ä¸ªåä¸º Podfile çš„æ–‡ä»¶ï¼Œä»¥å¦‚ä¸‹æ ¼å¼ï¼Œå°†ä¾èµ–çš„åº“åå­—ä¾æ¬¡åˆ—åœ¨æ–‡ä»¶ä¸­å³å¯ 1234platform :ios, &apos;7.0&apos;target &apos;demo&apos; dopod &apos;SDWebImage&apos;ï¼Œend ç„¶åä½ å°†ç¼–è¾‘å¥½çš„ Podfile æ–‡ä»¶æ”¾åˆ°ä½ çš„é¡¹ç›®æ ¹ç›®å½•ä¸­ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯ï¼š 12cd &quot;your project home&quot;pod install ç°åœ¨ï¼Œä½ çš„æ‰€æœ‰ç¬¬ä¸‰æ–¹åº“éƒ½å·²ç»ä¸‹è½½å®Œæˆå¹¶ä¸”è®¾ç½®å¥½äº†ç¼–è¯‘å‚æ•°å’Œä¾èµ–ï¼Œä½ åªéœ€è¦è®°ä½å¦‚ä¸‹ 2 ç‚¹å³å¯ï¼š ä½¿ç”¨ CocoaPods ç”Ÿæˆçš„ .xcworkspace æ–‡ä»¶æ¥æ‰“å¼€å·¥ç¨‹ï¼Œè€Œä¸æ˜¯ä»¥å‰çš„ .xcodeproj æ–‡ä»¶ã€‚ æ¯æ¬¡æ›´æ”¹äº† Podfile æ–‡ä»¶ï¼Œä½ éœ€è¦é‡æ–°æ‰§è¡Œä¸€æ¬¡pod updateå‘½ä»¤ã€‚ å¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜ å½“åœ¨ç»ˆç«¯è¾“å…¥,pod search AFNetworkingå¯èƒ½ä¼šå‡ºç°è¿™ç§æƒ…å†µ è¿™æ˜¯å› ä¸ºä¹‹å‰pod searchçš„æ—¶å€™ç”Ÿæˆäº†ç¼“å­˜æ–‡ä»¶search_index.json 1rm ~/Library/Caches/CocoaPods/search_index.json æ¥åˆ é™¤è¯¥æ–‡ä»¶ç„¶åå†æ¬¡è¾“å…¥pod search AFNetworkingè¿›è¡Œæœç´¢è¿™æ—¶ä¼šæç¤ºCreating search index for spec repo â€˜masterâ€™.. å½“è¿è¡Œpod å‘½ä»¤å‡ºç° 1command not found è§£å†³åŠæ³•:1sudo gem install -n /usr/local/bin cocoapods ä¹‹åpodå‘½ä»¤å¯ä»¥ä½¿ç”¨äº† å¦‚æœpod update / pod install å¡åœ¨ï¼š1Updating local specs repositories ç­‰å¾…å³å¯ï¼Œæˆ–è€… å¯ä»¥ä½¿ç”¨ â€œpod install â€“verbose â€“no-repo-updateâ€ è¿›è¡Œä¸‹è½½ï¼ŒåŸå› å¯èƒ½xè¢«å¢™ã€‚ å‡ºç°å¦‚ä¸‹é”™è¯¯:12345678Cloning into &apos;master&apos;...remote: Enumerating objects: 395, done. remote: Counting objects: 100% (395/395), done. remote: Compressing objects: 100% (308/308), done. error: RPC failed; curl 56 LibreSSL SSL_read: SSL_ERROR_SYSCALL, errno 60fatal: The remote end hung up unexpectedlyfatal: early EOFfatal: index-pack failed è§£å†³åŠæ³•:1gem install rails å¦‚ä¸‹:1234Successfully installed rails-5.0.1Parsing documentation for rails-5.0.1Done installing documentation for rails after 0 seconds1 gem installed ç„¶åç»§ç»­:1pod setup ä½¿ç”¨ CocoaPods çš„é•œåƒç´¢å¼•æ‰€æœ‰çš„é¡¹ç›®çš„ Podspec æ–‡ä»¶éƒ½æ‰˜ç®¡åœ¨https://github.com/CocoaPods/Specsã€‚ç¬¬ä¸€æ¬¡æ‰§è¡Œpod setupæ—¶ï¼ŒCocoaPods ä¼šå°†è¿™äº›podspecç´¢å¼•æ–‡ä»¶æ›´æ–°åˆ°æœ¬åœ°çš„ ~/.cocoapods/ç›®å½•ä¸‹ï¼Œè¿™ä¸ªç´¢å¼•æ–‡ä»¶æ¯”è¾ƒå¤§ï¼Œæœ‰ 80M å·¦å³ã€‚æ‰€ä»¥ç¬¬ä¸€æ¬¡æ›´æ–°æ—¶éå¸¸æ…¢ã€‚ ä¸€ä¸ªå« akinliu çš„æœ‹å‹åœ¨ gitcafe å’Œ oschina ä¸Šå»ºç«‹äº† CocoaPods ç´¢å¼•åº“çš„é•œåƒï¼Œå› ä¸º gitcafe å’Œ oschina éƒ½æ˜¯å›½å†…çš„æœåŠ¡å™¨ï¼Œæ‰€ä»¥åœ¨æ‰§è¡Œç´¢å¼•æ›´æ–°æ“ä½œæ—¶ï¼Œä¼šå¿«å¾ˆå¤šã€‚å¦‚ä¸‹æ“ä½œå¯ä»¥å°† CocoaPods è®¾ç½®æˆä½¿ç”¨ gitcafe é•œåƒï¼š123pod repo remove masterpod repo add master https://gitcafe.com/akuandev/Specs.gitpod repo update å°†ä»¥ä¸Šä»£ç ä¸­çš„ https://gitcafe.com/akuandev/Specs.git æ›¿æ¢æˆ http://git.oschina.net/akuandev/Specs.git å³å¯ä½¿ç”¨ oschina ä¸Šçš„é•œåƒã€‚ æŸ¥æ‰¾ç¬¬ä¸‰æ–¹åº“ä½ å¦‚æœä¸çŸ¥é“ cocoaPods ç®¡ç†çš„åº“ä¸­ï¼Œæ˜¯å¦æœ‰ä½ æƒ³è¦çš„åº“ï¼Œé‚£ä¹ˆä½ å¯ä»¥é€šè¿‡ pod search å‘½ä»¤è¿›è¡ŒæŸ¥æ‰¾ï¼Œä»¥ä¸‹æ˜¯æˆ‘ç”¨ pod search json æŸ¥æ‰¾åˆ°çš„æ‰€æœ‰å¯ç”¨çš„åº“ï¼š 123456789101112$ pod search json-&gt; AnyJSON (0.0.1) Encode / Decode JSON by any means possible. - Homepage: https://github.com/mattt/AnyJSON - Source: https://github.com/mattt/AnyJSON.git - Versions: 0.0.1 [master repo]-&gt; JSONKit (1.5pre) A Very High Performance Objective-C JSON Library. - Homepage: https://github.com/johnezang/JSONKit - Source: git://github.com/johnezang/JSONKit.git - Versions: 1.5pre, 1.4 [master repo]// ... ä»¥ä¸‹çœç•¥è‹¥å¹²è¡Œ Podfile.lockå½“ä½ æ‰§è¡Œpod installä¹‹åï¼Œé™¤äº† Podfile å¤–ï¼ŒCocoaPods è¿˜ä¼šç”Ÿæˆä¸€ä¸ªåä¸ºPodfile.lockçš„æ–‡ä»¶ï¼ŒPodfile.lock åº”è¯¥åŠ å…¥åˆ°ç‰ˆæœ¬æ§åˆ¶é‡Œé¢ï¼Œä¸åº”è¯¥æŠŠè¿™ä¸ªæ–‡ä»¶åŠ å…¥åˆ°.gitignoreä¸­ã€‚å› ä¸ºPodfile.lockä¼šé”å®šå½“å‰å„ä¾èµ–åº“çš„ç‰ˆæœ¬ï¼Œä¹‹åå¦‚æœå¤šæ¬¡æ‰§è¡Œpod install ä¸ä¼šæ›´æ”¹ç‰ˆæœ¬ï¼Œè¦pod updateæ‰ä¼šæ”¹Podfile.lockäº†ã€‚è¿™æ ·å¤šäººåä½œçš„æ—¶å€™ï¼Œå¯ä»¥é˜²æ­¢ç¬¬ä¸‰æ–¹åº“å‡çº§æ—¶é€ æˆå¤§å®¶å„è‡ªçš„ç¬¬ä¸‰æ–¹åº“ç‰ˆæœ¬ä¸ä¸€è‡´ã€‚ CocoaPods çš„è¿™ç¯‡ å®˜æ–¹æ–‡æ¡£ ä¹Ÿåœ¨What is a Podfile.lockä¸€èŠ‚ä¸­ä»‹ç»äº†Podfile.lockçš„ä½œç”¨ï¼Œå¹¶ä¸”æŒ‡å‡ºï¼š This file should always be kept under version control. ä¸ºè‡ªå·±çš„é¡¹ç›®åˆ›å»º podspec æ–‡ä»¶æˆ‘ä»¬å¯ä»¥ä¸ºè‡ªå·±çš„å¼€æºé¡¹ç›®åˆ›å»ºpodspecæ–‡ä»¶ï¼Œé¦–å…ˆé€šè¿‡å¦‚ä¸‹å‘½ä»¤åˆå§‹åŒ–ä¸€ä¸ªpodspecæ–‡ä»¶ï¼š 1pod spec create your_pod_spec_name è¯¥å‘½ä»¤æ‰§è¡Œä¹‹åï¼ŒCocoaPods ä¼šç”Ÿæˆä¸€ä¸ªåä¸ºyour_pod_spec_name.podspecçš„æ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬ä¿®æ”¹å…¶ä¸­çš„ç›¸å…³å†…å®¹å³å¯ã€‚ å…·ä½“æ­¥éª¤å¯ä»¥å‚è€ƒè¿™ä¸¤ç¯‡åšæ–‡ä¸­çš„ç›¸å…³å†…å®¹ï¼š åˆ›å»º podspec æ–‡ä»¶ï¼Œç»™è‡ªå·±å†™çš„æ¡†æ¶æ·»åŠ  CocoaPos æ”¯æŒ åˆ›å»ºpodspecæ–‡ä»¶ï¼Œä¸ºè‡ªå·±çš„é¡¹ç›®æ·»åŠ podæ”¯æŒ ä½¿ç”¨ç§æœ‰çš„ podsæˆ‘ä»¬å¯ä»¥ç›´æ¥æŒ‡å®šæŸä¸€ä¸ªä¾èµ–çš„podspecï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨å…¬å¸å†…éƒ¨çš„ç§æœ‰åº“ã€‚è¯¥æ–¹æ¡ˆæœ‰åˆ©äºä½¿ä¼ä¸šå†…éƒ¨çš„å…¬å…±é¡¹ç›®æ”¯æŒ CocoaPodsã€‚å¦‚ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š 1pod &apos;MyCommon&apos;, :podspec =&gt; &apos;https://yuantiku.com/common/myCommon.podspec&apos; ä¸æ›´æ–° podspecCocoaPods åœ¨æ‰§è¡Œpod installå’Œpod updateæ—¶ï¼Œä¼šé»˜è®¤å…ˆæ›´æ–°ä¸€æ¬¡podspecç´¢å¼•ã€‚ä½¿ç”¨â€“no-repo-updateå‚æ•°å¯ä»¥ç¦æ­¢å…¶åšç´¢å¼•æ›´æ–°æ“ä½œã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š12pod install --no-repo-updatepod update --no-repo-update å…¶ä»–æ“ä½œç”Ÿæˆç¬¬ä¸‰æ–¹åº“çš„å¸®åŠ©æ–‡æ¡£å¦‚æœä½ æƒ³è®© CococaPods å¸®ä½ ç”Ÿæˆç¬¬ä¸‰æ–¹åº“çš„å¸®åŠ©æ–‡æ¡£ï¼Œå¹¶é›†æˆåˆ° Xcode ä¸­ï¼Œé‚£ä¹ˆç”¨ brew å®‰è£… appledoc å³å¯ï¼š1brew install appledoc å…³äº appledocï¼Œå”å·§åœ¨å¦ä¸€ç¯‡åšå®¢ ã€Šä½¿ç”¨ Objective-C çš„æ–‡æ¡£ç”Ÿæˆå·¥å…·:appledocã€‹ ä¸­æœ‰ä¸“é—¨ä»‹ç»ã€‚å®ƒæœ€å¤§çš„ä¼˜ç‚¹æ˜¯å¯ä»¥å°†å¸®åŠ©æ–‡æ¡£é›†æˆåˆ° Xcode ä¸­ï¼Œè¿™æ ·ä½ åœ¨æ•²ä»£ç çš„æ—¶å€™ï¼ŒæŒ‰ä½ opt é”®å•å‡»ç±»åæˆ–æ–¹æ³•åï¼Œå°±å¯ä»¥æ˜¾ç¤ºå‡ºç›¸åº”çš„å¸®åŠ©æ–‡æ¡£ã€‚ åŸç†&lt;å·§ç¥è¯´çš„&gt;å¤§æ¦‚ç ”ç©¶äº†ä¸€ä¸‹ CocoaPods çš„åŸç†ï¼Œå®ƒæ˜¯å°†æ‰€æœ‰çš„ä¾èµ–åº“éƒ½æ”¾åˆ°å¦ä¸€ä¸ªåä¸º Pods é¡¹ç›®ä¸­ï¼Œç„¶åè®©ä¸»é¡¹ç›®ä¾èµ– Pods é¡¹ç›®ï¼Œè¿™æ ·ï¼Œæºç ç®¡ç†å·¥ä½œéƒ½ä»ä¸»é¡¹ç›®ç§»åˆ°äº† Pods é¡¹ç›®ä¸­ã€‚å‘ç°çš„ä¸€äº›æŠ€æœ¯ç»†èŠ‚æœ‰ï¼š Pods é¡¹ç›®æœ€ç»ˆä¼šç¼–è¯‘æˆä¸€ä¸ªåä¸º libPods.a çš„æ–‡ä»¶ï¼Œä¸»é¡¹ç›®åªéœ€è¦ä¾èµ–è¿™ä¸ª .a æ–‡ä»¶å³å¯ã€‚ å¯¹äºèµ„æºæ–‡ä»¶ï¼ŒCocoaPods æä¾›äº†ä¸€ä¸ªåä¸º Pods-resources.sh çš„ bash è„šæœ¬ï¼Œè¯¥è„šæœ¬åœ¨æ¯æ¬¡é¡¹ç›®ç¼–è¯‘çš„æ—¶å€™éƒ½ä¼šæ‰§è¡Œï¼Œå°†ç¬¬ä¸‰æ–¹åº“çš„å„ç§èµ„æºæ–‡ä»¶å¤åˆ¶åˆ°ç›®æ ‡ç›®å½•ä¸­ã€‚ CocoaPods é€šè¿‡ä¸€ä¸ªåä¸º Pods.xcconfig çš„æ–‡ä»¶æ¥åœ¨ç¼–è¯‘æ—¶è®¾ç½®æ‰€æœ‰çš„ä¾èµ–å’Œå‚æ•°ã€‚","categories":[{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/categories/å·¥å…·é›†/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/tags/iOS/"},{"name":"å·¥å…·é›†","slug":"å·¥å…·é›†","permalink":"https://bigporo.github.io/tags/å·¥å…·é›†/"}]},{"title":"Runtimeåº”ç”¨ç¯‡","slug":"Runtimeåº”ç”¨ç¯‡","date":"2019-04-23T09:17:43.000Z","updated":"2019-04-24T08:58:26.133Z","comments":true,"path":"2019/04/23/Runtimeåº”ç”¨ç¯‡/","link":"","permalink":"https://bigporo.github.io/2019/04/23/Runtimeåº”ç”¨ç¯‡/","excerpt":"å‰è¨€Runtimeç®€ç›´å°±æ˜¯åšå¤§å‹æ¡†æ¶çš„åˆ©å™¨ã€‚å®ƒçš„åº”ç”¨åœºæ™¯éå¸¸å¤šï¼Œä¸‹é¢å°±ä»‹ç»ä¸€äº›å¸¸è§çš„åº”ç”¨åœºæ™¯ã€‚ å…³è”å¯¹è±¡(Objective-C Associated Objects)ç»™åˆ†ç±»å¢åŠ å±æ€§ æ–¹æ³•é­”æ³•(Method Swizzling)æ–¹æ³•æ·»åŠ å’Œæ›¿æ¢å’ŒKVOå®ç° æ¶ˆæ¯è½¬å‘(çƒ­æ›´æ–°)è§£å†³Bug(JSPatch) å®ç°NSCodingçš„è‡ªåŠ¨å½’æ¡£å’Œè‡ªåŠ¨è§£æ¡£ å®ç°å­—å…¸å’Œæ¨¡å‹çš„è‡ªåŠ¨è½¬æ¢(MJExtension)","text":"å‰è¨€Runtimeç®€ç›´å°±æ˜¯åšå¤§å‹æ¡†æ¶çš„åˆ©å™¨ã€‚å®ƒçš„åº”ç”¨åœºæ™¯éå¸¸å¤šï¼Œä¸‹é¢å°±ä»‹ç»ä¸€äº›å¸¸è§çš„åº”ç”¨åœºæ™¯ã€‚ å…³è”å¯¹è±¡(Objective-C Associated Objects)ç»™åˆ†ç±»å¢åŠ å±æ€§ æ–¹æ³•é­”æ³•(Method Swizzling)æ–¹æ³•æ·»åŠ å’Œæ›¿æ¢å’ŒKVOå®ç° æ¶ˆæ¯è½¬å‘(çƒ­æ›´æ–°)è§£å†³Bug(JSPatch) å®ç°NSCodingçš„è‡ªåŠ¨å½’æ¡£å’Œè‡ªåŠ¨è§£æ¡£ å®ç°å­—å…¸å’Œæ¨¡å‹çš„è‡ªåŠ¨è½¬æ¢(MJExtension) å…³è”å¯¹è±¡(Objective-C Associated Objects)æˆ‘ä»¬éƒ½æ˜¯çŸ¥é“åˆ†ç±»æ˜¯ä¸èƒ½è‡ªå®šä¹‰å±æ€§å’Œå˜é‡çš„ã€‚å¦‚æœåœ¨åˆ†ç±»çš„å£°æ˜ä¸­å†™@property åªèƒ½ä¸ºå…¶ç”Ÿæˆget å’Œ set æ–¹æ³•çš„å£°æ˜ï¼Œä½†æ— æ³•ç”Ÿæˆæˆå‘˜å˜é‡ï¼Œå°±æ˜¯è™½ç„¶ç‚¹è¯­æ³•èƒ½è°ƒç”¨å‡ºæ¥ï¼Œä½†ç¨‹åºæ‰§è¡Œåä¼šcrashã€‚ ä¸‹é¢é€šè¿‡å…³è”å¯¹è±¡å®ç°ç»™åˆ†ç±»æ·»åŠ å±æ€§ã€‚ å…³è”å¯¹è±¡Runtimeæä¾›äº†ä¸‹é¢å‡ ä¸ªæ¥å£ï¼š 123456//å…³è”å¯¹è±¡void objc_setAssociatedObject(id object, const void *key, id value, objc_AssociationPolicy policy)//è·å–å…³è”çš„å¯¹è±¡id objc_getAssociatedObject(id object, const void *key)//ç§»é™¤å…³è”çš„å¯¹è±¡void objc_removeAssociatedObjects(id object) å‚æ•°è§£é‡Š 1234id objectï¼šè¢«å…³è”çš„å¯¹è±¡const void *keyï¼šå…³è”çš„keyï¼Œè¦æ±‚å”¯ä¸€id valueï¼šå…³è”çš„å¯¹è±¡objc_AssociationPolicy policyï¼šå†…å­˜ç®¡ç†çš„ç­–ç•¥ é€šè¿‡å…³è”å¯¹è±¡å®ç°çš„å±æ€§çš„å†…å­˜ç®¡ç†ä¹Ÿæ˜¯æœ‰ARCç®¡ç†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç»™å®šé€‚å½“çš„å†…å­˜ç­–ç•¥å°±è¡Œäº†ï¼Œä¸éœ€è¦æ“å¿ƒå¯¹è±¡çš„é‡Šæ”¾ã€‚ å†…å­˜ç®¡ç†ç­–ç•¥ å†…å­˜ç­–ç•¥ å±æ€§ä¿®é¥° æè¿° OBJC_ASSOCIATION_ASSIGN @property (assign) æˆ– @property (unsafe_unretained) æŒ‡å®šä¸€ä¸ªå…³è”å¯¹è±¡çš„å¼±å¼•ç”¨ã€‚ OBJC_ASSOCIATION_RETAIN_NONATOMIC @property (nonatomic, strong) æŒ‡å®šä¸€ä¸ªå…³è”å¯¹è±¡çš„å¼ºå¼•ç”¨ï¼Œä¸èƒ½è¢«åŸå­åŒ–ä½¿ç”¨ã€‚ OBJC_ASSOCIATION_COPY_NONATOMIC @property (nonatomic, copy) æŒ‡å®šä¸€ä¸ªå…³è”å¯¹è±¡çš„copyå¼•ç”¨ï¼Œä¸èƒ½è¢«åŸå­åŒ–ä½¿ç”¨ OBJC_ASSOCIATION_RETAIN @property (atomic, strong) æŒ‡å®šä¸€ä¸ªå…³è”å¯¹è±¡çš„å¼ºå¼•ç”¨ï¼Œèƒ½è¢«åŸå­åŒ–ä½¿ç”¨ã€‚ OBJC_ASSOCIATION_COPY @property (atomic, copy) æŒ‡å®šä¸€ä¸ªå…³è”å¯¹è±¡çš„copyå¼•ç”¨ï¼Œèƒ½è¢«åŸå­åŒ–ä½¿ç”¨ã€‚ ä¸‹é¢å®ç°ä¸€ä¸ªUIViewçš„Categoryæ·»åŠ è‡ªå®šä¹‰å±æ€§defaultColorã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041#import &quot;ViewController.h&quot;#import &quot;objc/runtime.h&quot;@interface UIView (DefaultColor)@property (nonatomic, strong) UIColor *defaultColor;@end@implementation UIView (DefaultColor)@dynamic defaultColor;static char kDefaultColorKey;- (void)setDefaultColor:(UIColor *)defaultColor &#123;objc_setAssociatedObject(self, &amp;kDefaultColorKey, defaultColor, OBJC_ASSOCIATION_RETAIN_NONATOMIC);&#125;- (id)defaultColor &#123;return objc_getAssociatedObject(self, &amp;kDefaultColorKey);&#125;@end@interface ViewController ()@end@implementation ViewController- (void)viewDidLoad &#123;[super viewDidLoad];// Do any additional setup after loading the view, typically from a nib.UIView *test = [UIView new];test.defaultColor = [UIColor blackColor];NSLog(@&quot;%@&quot;, test.defaultColor);&#125;@end æ–¹æ³•é­”æ³•(Method Swizzling)æ–¹æ³•æ·»åŠ 12//class_addMethod(Class _Nullable __unsafe_unretained cls, SEL _Nonnull name, IMP _Nonnull imp, const char * _Nullable types)class_addMethod([self class], sel, (IMP)fooMethod, &quot;v@:&quot;); å‚æ•°è§£é‡Š cls è¢«æ·»åŠ æ–¹æ³•çš„ç±» name æ·»åŠ çš„æ–¹æ³•çš„åç§°çš„SEL imp æ–¹æ³•çš„å®ç°ã€‚è¯¥å‡½æ•°å¿…é¡»è‡³å°‘è¦æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œself,_cmd ç±»å‹ç¼–ç  æ–¹æ³•æ›¿æ¢12345678// è·å¾—æŸä¸ªç±»çš„ç±»æ–¹æ³•Method class_getClassMethod(Class cls , SEL name)// è·å¾—æŸä¸ªç±»çš„å®ä¾‹å¯¹è±¡æ–¹æ³•Method class_getInstanceMethod(Class cls , SEL name)// äº¤æ¢ä¸¤ä¸ªæ–¹æ³•çš„å®ç°void method_exchangeImplementations(Method m1 , Method m2) ç¤ºä¾‹å¦‚ä¸‹:1234567891011121314151617181920212223242526272829303132333435@implementation ViewController+ (void)load &#123;static dispatch_once_t onceToken;dispatch_once(&amp;onceToken, ^&#123;Class class = [self class];SEL originalSelector = @selector(viewDidLoad);SEL swizzledSelector = @selector(jkviewDidLoad);Method originalMethod = class_getInstanceMethod(class,originalSelector);Method swizzledMethod = class_getInstanceMethod(class,swizzledSelector);//judge the method named swizzledMethod is already existed.BOOL didAddMethod = class_addMethod(class, originalSelector, method_getImplementation(swizzledMethod), method_getTypeEncoding(swizzledMethod));// if swizzledMethod is already existed.if (didAddMethod) &#123;class_replaceMethod(class, swizzledSelector, method_getImplementation(originalMethod), method_getTypeEncoding(originalMethod));&#125;else &#123;method_exchangeImplementations(originalMethod, swizzledMethod);&#125;&#125;);&#125;- (void)jkviewDidLoad &#123;NSLog(@&quot;æ›¿æ¢çš„æ–¹æ³•&quot;);[self jkviewDidLoad];&#125;- (void)viewDidLoad &#123;NSLog(@&quot;è‡ªå¸¦çš„æ–¹æ³•&quot;);[super viewDidLoad];&#125; åœ¨ Objective-C çš„è¿è¡Œæ—¶ä¸­ï¼Œæ¯ä¸ªç±»æœ‰ä¸¤ä¸ªæ–¹æ³•éƒ½ä¼šè‡ªåŠ¨è°ƒç”¨ã€‚+load æ˜¯åœ¨ä¸€ä¸ªç±»è¢«åˆå§‹è£…è½½æ—¶è°ƒç”¨ï¼Œ+initialize æ˜¯åœ¨åº”ç”¨ç¬¬ä¸€æ¬¡è°ƒç”¨è¯¥ç±»çš„ç±»æ–¹æ³•æˆ–å®ä¾‹æ–¹æ³•å‰è°ƒç”¨çš„ã€‚ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯å¯é€‰çš„ï¼Œå¹¶ä¸”åªæœ‰åœ¨æ–¹æ³•è¢«å®ç°çš„æƒ…å†µä¸‹æ‰ä¼šè¢«è°ƒç”¨ã€‚ å®ç°å›¾è§£å¦‚ä¸‹å›¾ã€‚ ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬é€šè¿‡swizzlingç‰¹æ€§ï¼Œå°†selectorCçš„æ–¹æ³•å®ç°IMPcä¸selectorNçš„æ–¹æ³•å®ç°IMPnäº¤æ¢äº†ï¼Œå½“æˆ‘ä»¬è°ƒç”¨selectorCï¼Œä¹Ÿå°±æ˜¯ç»™å¯¹è±¡å‘é€selectorCæ¶ˆæ¯æ—¶ï¼Œæ‰€æŸ¥æ‰¾åˆ°çš„å¯¹åº”çš„æ–¹æ³•å®ç°å°±æ˜¯IMPnè€Œä¸æ˜¯IMPcäº†ã€‚ KVOå®ç°è´¨é‡åšå®¢è§£è¯» å…¨ç§°æ˜¯Key-value observingï¼Œç¿»è¯‘æˆé”®å€¼è§‚å¯Ÿã€‚æä¾›äº†ä¸€ç§å½“å…¶å®ƒå¯¹è±¡å±æ€§è¢«ä¿®æ”¹çš„æ—¶å€™èƒ½é€šçŸ¥å½“å‰å¯¹è±¡çš„æœºåˆ¶ã€‚åœ¨MVCå¤§è¡Œå…¶é“çš„Cocoaä¸­ï¼ŒKVOæœºåˆ¶å¾ˆé€‚åˆå®ç°modelå’Œcontrollerç±»ä¹‹é—´çš„é€šè®¯ã€‚ KVOçš„å®ç°ä¾èµ–äº Objective-C å¼ºå¤§çš„ Runtimeï¼Œå½“è§‚å¯ŸæŸå¯¹è±¡ A æ—¶ï¼ŒKVO æœºåˆ¶åŠ¨æ€åˆ›å»ºä¸€ä¸ªå¯¹è±¡Aå½“å‰ç±»çš„å­ç±»ï¼Œå¹¶ä¸ºè¿™ä¸ªæ–°çš„å­ç±»é‡å†™äº†è¢«è§‚å¯Ÿå±æ€§ keyPath çš„ setter æ–¹æ³•ã€‚setter æ–¹æ³•éšåè´Ÿè´£é€šçŸ¥è§‚å¯Ÿå¯¹è±¡å±æ€§çš„æ”¹å˜çŠ¶å†µã€‚ Apple ä½¿ç”¨äº† isa-swizzling æ¥å®ç° KVO ã€‚å½“è§‚å¯Ÿå¯¹è±¡Aæ—¶ï¼ŒKVOæœºåˆ¶åŠ¨æ€åˆ›å»ºä¸€ä¸ªæ–°çš„åä¸ºï¼šNSKVONotifying_Açš„æ–°ç±»ï¼Œè¯¥ç±»ç»§æ‰¿è‡ªå¯¹è±¡Açš„æœ¬ç±»ï¼Œä¸” KVO ä¸º NSKVONotifying_A é‡å†™è§‚å¯Ÿå±æ€§çš„ setter æ–¹æ³•ï¼Œsetter æ–¹æ³•ä¼šè´Ÿè´£åœ¨è°ƒç”¨åŸ setter æ–¹æ³•ä¹‹å‰å’Œä¹‹åï¼Œé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿå¯¹è±¡å±æ€§å€¼çš„æ›´æ”¹æƒ…å†µã€‚ æ‰€ä»¥å½“æˆ‘ä»¬ä»åº”ç”¨å±‚é¢ä¸Šçœ‹æ¥ï¼Œå®Œå…¨æ²¡æœ‰æ„è¯†åˆ°æœ‰æ–°çš„ç±»å‡ºç°ï¼Œè¿™æ˜¯ç³»ç»Ÿâ€œéšç’â€äº†å¯¹ KVO çš„åº•å±‚å®ç°è¿‡ç¨‹ï¼Œè®©æˆ‘ä»¬è¯¯ä»¥ä¸ºè¿˜æ˜¯åŸæ¥çš„ç±»ã€‚ä½†æ˜¯æ­¤æ—¶å¦‚æœæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„åä¸ºâ€œNSKVONotifying_Aâ€çš„ç±»ï¼Œå°±ä¼šå‘ç°ç³»ç»Ÿè¿è¡Œåˆ°æ³¨å†Œ KVO çš„é‚£æ®µä»£ç æ—¶ç¨‹åºå°±å´©æºƒï¼Œå› ä¸ºç³»ç»Ÿåœ¨æ³¨å†Œç›‘å¬çš„æ—¶å€™åŠ¨æ€åˆ›å»ºäº†åä¸º NSKVONotifying_A çš„ä¸­é—´ç±»ï¼Œå¹¶æŒ‡å‘è¿™ä¸ªä¸­é—´ç±»äº†ã€‚ å­ç±»setteræ–¹æ³•å‰–æ KVO çš„é”®å€¼è§‚å¯Ÿé€šçŸ¥ä¾èµ–äº NSObject çš„ä¸¤ä¸ªæ–¹æ³•:willChangeValueForKey:å’Œ didChangeValueForKey: ï¼Œåœ¨å­˜å–æ•°å€¼çš„å‰ååˆ†åˆ«è°ƒç”¨ 2 ä¸ªæ–¹æ³•ï¼šè¢«è§‚å¯Ÿå±æ€§å‘ç”Ÿæ”¹å˜ä¹‹å‰ï¼ŒwillChangeValueForKey:è¢«è°ƒç”¨ï¼Œé€šçŸ¥ç³»ç»Ÿè¯¥ keyPath çš„å±æ€§å€¼å³å°†å˜æ›´ï¼›å½“æ”¹å˜å‘ç”Ÿåï¼Œ didChangeValueForKey: è¢«è°ƒç”¨ï¼Œé€šçŸ¥ç³»ç»Ÿè¯¥keyPath çš„å±æ€§å€¼å·²ç»å˜æ›´ï¼›ä¹‹åï¼Œ observeValueForKey:ofObject:change:context:ä¹Ÿä¼šè¢«è°ƒç”¨ã€‚ä¸”é‡å†™è§‚å¯Ÿå±æ€§çš„setter æ–¹æ³•è¿™ç§ç»§æ‰¿æ–¹å¼çš„æ³¨å…¥æ˜¯åœ¨è¿è¡Œæ—¶è€Œä¸æ˜¯ç¼–è¯‘æ—¶å®ç°çš„ã€‚KVO ä¸ºå­ç±»çš„è§‚å¯Ÿè€…å±æ€§é‡å†™è°ƒç”¨å­˜å–æ–¹æ³•çš„å·¥ä½œåŸç†åœ¨ä»£ç ä¸­ç›¸å½“äºï¼š 12345- (void)setName:(NSString *)newName &#123; [self willChangeValueForKey:@&quot;name&quot;]; //KVO åœ¨è°ƒç”¨å­˜å–æ–¹æ³•ä¹‹å‰æ€»è°ƒç”¨ [super setValue:newName forKey:@&quot;name&quot;]; //è°ƒç”¨çˆ¶ç±»çš„å­˜å–æ–¹æ³• [self didChangeValueForKey:@&quot;name&quot;]; //KVO åœ¨è°ƒç”¨å­˜å–æ–¹æ³•ä¹‹åæ€»è°ƒç”¨&#125; ç¤ºä¾‹å¦‚ä¸‹ï¼š 123456789101112131415161718- (void)dealloc&#123;[self.person removeObserver:self forKeyPath:@&quot;name&quot;];&#125;- (void)viewDidLoad &#123;[super viewDidLoad];self.person = [Person new];[self.person addObserver:self forKeyPath:@&quot;name&quot; options:NSKeyValueObservingOptionNew context:@&quot;ä¼ ä¸ªå€¼ï¼Ÿ&quot;];&#125;#pragma mark KVO- (void)KVO&#123;self.person.name = @&quot;new name&quot;;&#125;- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary&lt;NSKeyValueChangeKey,id&gt; *)change context:(void *)context&#123;NSLog(@&quot;%@å¯¹è±¡çš„%@å±æ€§æ”¹å˜äº†ï¼š%@,ä¼ å€¼:%@&quot;, object, keyPath, change,context);&#125; è¾“å‡ºå¦‚ä¸‹ 1234&lt;Person: 0x600000907280&gt;å¯¹è±¡çš„nameå±æ€§æ”¹å˜äº†ï¼š&#123;kind = 1;new = &quot;new name&quot;;&#125;,ä¼ å€¼:ä¼ ä¸ªå€¼ï¼Ÿ æ¶ˆæ¯è½¬å‘(çƒ­æ›´æ–°)è§£å†³Bug(JSPatch) JSPatch æ˜¯ä¸€ä¸ª iOS åŠ¨æ€æ›´æ–°æ¡†æ¶ï¼Œåªéœ€åœ¨é¡¹ç›®ä¸­å¼•å…¥æå°çš„å¼•æ“ï¼Œå°±å¯ä»¥ä½¿ç”¨ JavaScript è°ƒç”¨ä»»ä½• Objective-C åŸç”Ÿæ¥å£ï¼Œè·å¾—è„šæœ¬è¯­è¨€çš„ä¼˜åŠ¿ï¼šä¸ºé¡¹ç›®åŠ¨æ€æ·»åŠ æ¨¡å—ï¼Œæˆ–æ›¿æ¢é¡¹ç›®åŸç”Ÿä»£ç åŠ¨æ€ä¿®å¤ bugã€‚ æ¶ˆæ¯è½¬å‘åˆ†ä¸ºä¸‰çº§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯çº§å®ç°æ›¿æ¢åŠŸèƒ½ï¼Œå®ç°æ¶ˆæ¯è½¬å‘ï¼Œä»è€Œä¸ä¼šé€ æˆå´©æºƒã€‚JSPatchä¸ä»…èƒ½å¤Ÿå®ç°æ¶ˆæ¯è½¬å‘ï¼Œè¿˜å¯ä»¥å®ç°æ–¹æ³•æ·»åŠ ã€æ›¿æ¢èƒ½ä¸€ç³»åˆ—åŠŸèƒ½ã€‚ è·å¾—ä¸€ä¸ªç±»çš„æ‰€æœ‰æˆå‘˜å˜é‡ç”¨runtimeæä¾›çš„å‡½æ•°éå†Modelè‡ªèº«æ‰€æœ‰å±æ€§ã€‚ 12345678910111213unsigned int outCount = 0;Ivar *ivars = class_copyIvarList([Person class], &amp;outCount);// éå†æ‰€æœ‰æˆå‘˜å˜é‡for (int i = 0; i &lt; outCount; i++) &#123;// å–å‡ºiä½ç½®å¯¹åº”çš„æˆå‘˜å˜é‡Ivar ivar = ivars[i];const char *name = ivar_getName(ivar);const char *type = ivar_getTypeEncoding(ivar);NSLog(@&quot;æˆå‘˜å˜é‡åï¼š%s æˆå‘˜å˜é‡ç±»å‹ï¼š%s&quot;,name,type);&#125;// æ³¨æ„é‡Šæ”¾å†…å­˜ï¼free(ivars); å®ç°NSCodingçš„è‡ªåŠ¨å½’æ¡£å’Œè‡ªåŠ¨è§£æ¡£åŸç†æè¿°ï¼šç”¨runtimeæä¾›çš„å‡½æ•°éå†Modelè‡ªèº«æ‰€æœ‰å±æ€§ï¼Œå¹¶å¯¹å±æ€§è¿›è¡Œencodeå’Œdecodeæ“ä½œã€‚ æ ¸å¿ƒæ–¹æ³•ï¼šåœ¨Modelçš„åŸºç±»ä¸­é‡å†™æ–¹æ³•ï¼š 12345678910111213141516171819202122- (id)initWithCoder:(NSCoder *)aDecoder &#123;if (self = [super init]) &#123;unsigned int outCount;Ivar * ivars = class_copyIvarList([self class], &amp;outCount);for (int i = 0; i &lt; outCount; i ++) &#123;Ivar ivar = ivars[i];NSString * key = [NSString stringWithUTF8String:ivar_getName(ivar)];[self setValue:[aDecoder decodeObjectForKey:key] forKey:key];&#125;&#125;return self;&#125;- (void)encodeWithCoder:(NSCoder *)aCoder &#123;unsigned int outCount;Ivar * ivars = class_copyIvarList([self class], &amp;outCount);for (int i = 0; i &lt; outCount; i ++) &#123;Ivar ivar = ivars[i];NSString * key = [NSString stringWithUTF8String:ivar_getName(ivar)];[aCoder encodeObject:[self valueForKey:key] forKey:key];&#125;&#125; å®ç°å­—å…¸å’Œæ¨¡å‹çš„è‡ªåŠ¨è½¬æ¢(MJExtension)åŸç†æè¿°ï¼šç”¨runtimeæä¾›çš„å‡½æ•°éå†Modelè‡ªèº«æ‰€æœ‰å±æ€§ï¼Œå¦‚æœå±æ€§åœ¨jsonä¸­æœ‰å¯¹åº”çš„å€¼ï¼Œåˆ™å°†å…¶èµ‹å€¼ã€‚æ ¸å¿ƒæ–¹æ³•ï¼šåœ¨NSObjectçš„åˆ†ç±»ä¸­æ·»åŠ æ–¹æ³•12345678910111213141516171819202122232425262728293031323334- (instancetype)initWithDict:(NSDictionary *)dict &#123;if (self = [self init]) &#123;//(1)è·å–ç±»çš„å±æ€§åŠå±æ€§å¯¹åº”çš„ç±»å‹NSMutableArray * keys = [NSMutableArray array];NSMutableArray * attributes = [NSMutableArray array];/** ä¾‹å­* name = value3 attribute = T@&quot;NSString&quot;,C,N,V_value3* name = value4 attribute = T^i,N,V_value4*/unsigned int outCount;objc_property_t * properties = class_copyPropertyList([self class], &amp;outCount);for (int i = 0; i &lt; outCount; i ++) &#123;objc_property_t property = properties[i];//é€šè¿‡property_getNameå‡½æ•°è·å¾—å±æ€§çš„åå­—NSString * propertyName = [NSString stringWithCString:property_getName(property) encoding:NSUTF8StringEncoding];[keys addObject:propertyName];//é€šè¿‡property_getAttributeså‡½æ•°å¯ä»¥è·å¾—å±æ€§çš„åå­—å’Œ@encodeç¼–ç NSString * propertyAttribute = [NSString stringWithCString:property_getAttributes(property) encoding:NSUTF8StringEncoding];[attributes addObject:propertyAttribute];&#125;//ç«‹å³é‡Šæ”¾propertiesæŒ‡å‘çš„å†…å­˜free(properties);//(2)æ ¹æ®ç±»å‹ç»™å±æ€§èµ‹å€¼for (NSString * key in keys) &#123;if ([dict valueForKey:key] == nil) continue;[self setValue:[dict valueForKey:key] forKey:key];&#125;&#125;return self;&#125;","categories":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/categories/iOS/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/tags/iOS/"}]},{"title":"ã€ŠiOSå¼€å‘è¿›é˜¶ã€‹è¯»ä¹¦æ€»ç»“","slug":"ã€ŠiOSå¼€å‘è¿›é˜¶ã€‹è¯»ä¹¦æ€»ç»“","date":"2019-04-23T09:17:43.000Z","updated":"2019-04-24T09:11:17.557Z","comments":true,"path":"2019/04/23/ã€ŠiOSå¼€å‘è¿›é˜¶ã€‹è¯»ä¹¦æ€»ç»“/","link":"","permalink":"https://bigporo.github.io/2019/04/23/ã€ŠiOSå¼€å‘è¿›é˜¶ã€‹è¯»ä¹¦æ€»ç»“/","excerpt":"iOSå¼€å‘å·¥å…·","text":"iOSå¼€å‘å·¥å…· ä¾èµ–åŒ…ç®¡ç†å·¥å…·-CocoapPodshttp://note.youdao.com/noteshare?id=afbf57911d0ba85e6ae7073d6c8b2c83 ç½‘ç»œå°åŒ…åˆ†æå·¥å…·-Charleshttp://note.youdao.com/noteshare?id=c758ee77fa20a7888e89d035dec8906a ç•Œé¢è°ƒè¯•å·¥å…·-Revealhttp://note.youdao.com/noteshare?id=b06327cef4d357e2da55bd1cfe33cb7c ç§»åŠ¨ç»Ÿè®¡å·¥å…·Flurryç°åœ¨å’±ç”¨å‹ç›Ÿäº† å´©æºƒæ—¥å¿—è®°å½•å·¥å…·-Crashlyticsç°åœ¨ç”¨çš„æ˜¯Bugtags App Storeç»Ÿè®¡å·¥å…·-App Annieç°åœ¨çš„App Store Connect åšçš„è¿˜å¯ä»¥çš„ã€‚ Xcode æ’ä»¶æœ€æ–°çš„Xcode 10 å·²ç»ä¸æ”¯æŒè¿™äº›èŠ±é‡Œèƒ¡å“¨(å¾ˆå®ç”¨)çš„ä¸œè¥¿äº†ã€‚ ä¸è¿‡Appleå°†ä¸€äº›ä¼˜ç§€çš„æ’ä»¶ç›´æ¥é›†æˆåˆ°Xcodeé‡Œé¢äº†ã€‚æ¯”å¦‚: å¿«é€Ÿæ·»åŠ æ³¨é‡Š1âŒ¥ Option + âŒ˜ Command + / è¯¥å¿«æ·é”®çš„å‰ç”Ÿæ˜¯å–µç¥çš„VVDocumenter-Xcode å…¶å®ƒå·¥å…·ä»‹ç»å–è‰²å™¨åŸºæ“ å…¶å®ƒå›¾å½¢å·¥å…·ImageOptimhttp://note.youdao.com/noteshare?id=60cd5fb3f8e7b20e6a4663946e52daa3 é©¬å…‹é³—ä¸»è¦æ˜¯ç”¨æ¥æ ‡æ³¨è®¾è®¡å›¾çš„ã€‚å®˜ç½‘ Dashæ˜¯ä¸€æ¬¾APIæ–‡æ¡£æŸ¥è¯¢åŠä»£ç ç‰‡æ®µç®¡ç†çš„å·¥å…·ã€‚ è’²å…¬è‹±æ˜¯ä¸€ä¸ªåº”ç”¨çš„å†…æµ‹åˆ†å‘å·¥å…·ï¼Œä½¿ç”¨é¢‘ç‡è¿˜æ˜¯è›®é«˜çš„ï¼Œå…·ä½“çš„ä½¿ç”¨æ–‡æ¡£è§å®˜ç½‘ã€‚ å‘½ä»¤è¡Œå·¥å…·nomadå·¥å…·ä¸»é¡µï¼šhttps://nomad-cli.com/ ä¸è¿‡ç°åœ¨å¥½åƒfaltlaneæ›´åŠ å¥½ç”¨ã€‚ xctoolå·¥å…·ä¸»é¡µï¼šhttps://github.com/facebook/xctool å‚è€ƒåšå®¢ xctoolæ˜¯ facebook å¼€æºçš„ä¸€ä¸ª iOS ç¼–è¯‘å’Œæµ‹è¯•çš„å·¥å…·ã€‚ä½¿ç”¨å®ƒè€Œä¸æ˜¯ç”¨ Xcode çš„ UI ç•Œé¢æ˜¯å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªçº¯å‘½ä»¤è¡Œå·¥å…·ã€‚æ¯”å¦‚ï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ xctool åœ¨å‘½ä»¤ç”Ÿä¸‹è¿›è¡Œç¼–è¯‘å’Œå•å…ƒæµ‹è¯•ï¼Œç„¶åå°†æµ‹è¯•ç»“æœé›†æˆåˆ° Jenkins ä¸­ï¼Œè¿™æ ·å°±å®ç°äº†è‡ªåŠ¨åŒ–çš„æŒç»­é›†æˆã€‚è™½ç„¶è‹¹æœä¹Ÿåœ¨ OSX Server ä¸Šæ¨å‡ºäº†è‡ªå·±çš„è‡ªåŠ¨åŒ–é›†æˆå·¥å…· BOTï¼Œä½†å…¶é…ç½®å’Œä½¿ç”¨ä¸Šç°åœ¨ä»ç„¶ä¸å¤ªæ–¹ä¾¿ã€‚ appledocæ˜¯ä¸€ä¸ªä»æºä»£ç ä¸­æŠ½å–æ–‡æ¡£çš„å·¥å…·å·¥å…·ä¸»é¡µï¼šhttps://github.com/tomaz/appledoc ä½¿ç”¨æ•™ç¨‹ iOSå¼€å‘å®è·µç†è§£å†…å­˜ç®¡ç†å¾ªç¯å¼•ç”¨çš„ç›‘æµ‹å¤§éƒ¨åˆ†å†…å®¹éƒ½æ˜¯å¹¿ä¸ºäººçŸ¥çš„ï¼Œç½‘ä¸Šçš„èµ„æ–™ä¹Ÿå¾ˆå¤šï¼Œè¿™é‡Œç€é‡è¯´ä¸€ä¸‹é€šè¿‡Xcodedçš„Instrumentså·¥å…·é›†æ¥ç›‘æµ‹å¾ªç¯å¼•ç”¨ã€‚ æ•°ç»„Aå’Œæ•°ç»„Bæ„æˆäº†å¾ªç¯å¼•ç”¨ 12345678910- (void)viewDidLoad &#123;[super viewDidLoad];// æµ‹è¯•å¾ªç¯å¼•ç”¨çš„ç›‘æµ‹NSMutableArray *arrA = [NSMutableArray new];NSMutableArray *arrB = [NSMutableArray new];[arrA addObject:arrB];[arrB addObject:arrA];&#125; Xcodeçš„èœå•æ  -&gt; Product -&gt; Profile ç‚¹å‡»å³ä¸Šè§’å¼€å§‹ç›‘æµ‹ ç‚¹å‡»åˆ‡æ¢åˆ°â€Leaksâ€,ç‚¹å‡»é€‰ä¸­â€Cycles &amp; Rootsâ€å°±å¯ä»¥çœ‹åˆ°å¾ªç¯å¼•ç”¨äº†ï¼Œä¹Ÿå¯ä»¥å¾ˆæ–¹ä¾¿çš„æ‰¾åˆ°æºå¤´ã€‚ Core Foundationå¯¹è±¡çš„å†…å­˜ç®¡ç†Core Foundationå¯¹è±¡éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨ç®¡ç†å…¶å†…å­˜ GCDä¹¦ä¸­ä¹Ÿåªæ˜¯è¯´äº†ä¸€äº›GCDçš„å¸¸ç”¨APIï¼Œå¹¶ä¸æ¶‰åŠåº•å±‚æºç å’Œå®ç°åŸç†ã€‚ ä½¿ç”¨UIWindowå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç«  åŠ¨æ€ä¸‹è½½ç³»ç»Ÿæä¾›çš„å¤šç§ä¸­æ–‡å­—ä½“æ“ä½œä¸éš¾ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼Œä¹¦ä¸­çš„è¯´æ˜ä¹Ÿå¾ˆè¯¦ç»†ã€‚ ä½¿ç”¨åº”ç”¨å†…æ”¯ä»˜å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç«  åŸºäºUIWebViewçš„æ··åˆç¼–ç¨‹ç°åœ¨åŸºæœ¬éƒ½æ˜¯WKWebViewï¼Œä½†æ˜¯åŸºæœ¬åŸç†ç›¸ä¼¼ã€‚ å®‰å…¨æ€§é—®é¢˜ç½‘ç»œå®‰å…¨ å®‰å…¨çš„ä¼ è¾“ç”¨æˆ·å¯†ç  ä¸»è¦æ˜¯åŠ å¯† é˜²æ­¢é€šè®¯åè®®è¢«è½»æ˜“ç ´è§£ ä½¿ç”¨äºŒè¿›åˆ¶é€šè®¯åè®®æˆ–è€…è‡ªå®šä¹‰é€šè®¯åè®® éªŒè¯åº”ç”¨å†…æ”¯ä»˜çš„å‡­è¯æœ¬åœ°æ–‡ä»¶å’Œæ•°æ®å®‰å…¨ ç¨‹åºæ–‡ä»¶çš„å®‰å…¨ å°†JavaScriptæºç è¿›è¡Œæ··æ·†å’ŒåŠ å¯†ã€‚ æœ¬åœ°æ•°æ®å®‰å…¨ æœ¬åœ°çš„é‡è¦æ•°æ®éœ€è¦åŠ å¯†æˆ–è€…ä¿å­˜åˆ°keychianä¸­ æºä»£ç å®‰å…¨é€šè¿‡ä¸€äº›å·¥å…·å¯ä»¥åˆ†æç¼–è¯‘ä¹‹åçš„äºŒè¿›åˆ¶ç¨‹åºæ–‡ä»¶ï¼Œæ¯”å¦‚IDAã€‚è¿™ç§æƒ…å†µæ¯”è¾ƒæ— è§£ï¼Œé™¤éå°†ä¸€äº›å…³é”®çš„é€»è¾‘ä½¿ç”¨Cæ¥å®ç°ã€‚ åŸºäºCoreTextçš„æ’ç‰ˆå¼•æ“ä¸»è¦ä»‹ç»å¦‚ä½•åŸºæœ¬CoreTextè‡ªå®šä¹‰ä¸€ä¸ªæ’ç‰ˆå¼•æ“ã€‚ å®æˆ˜æŠ€å·§App Storeä¸å®¡æ ¸ æ’¤é”€æ­£åœ¨å®¡æ ¸çš„åº”ç”¨ ç”³è¯·åŠ æ€¥å®¡æ ¸ æµ‹è¯•è®¾å¤‡æ•°çš„é™åˆ¶ å¦‚ä½•å°†åº”ç”¨ä¸‹æ¶ å¦‚ä½•ä¸¾æŠ¥åˆ«çš„åº”ç”¨ä¾µæƒå¼€å‘æŠ€å·§ å¤§éƒ¨åˆ†æ¯”è¾ƒç†ŸçŸ¥ï¼Œå•ç‹¬æå‡ ç‚¹ï¼š æŸ¥æ‰¾æŠ€å·§ Xcodeçš„æŸ¥æ‰¾æ›¿æ¢åŠŸèƒ½æä¾›äº†Insert Patternçš„æ–¹å¼ï¼Œæ–¹ä¾¿è¾“å…¥å¸¸è§çš„æŸ¥æ‰¾è§„åˆ™ã€‚ ä»£ç ç‰‡æ®µç®¡ç† ç‚¹å‡»å¯ä»¥çœ‹åˆ°ç³»ç»Ÿæä¾›çš„ä¸€äº›ä»£ç ç‰‡æ®µï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±è‡ªå®šä¹‰ä»£ç ç‰‡æ®µã€‚ é€‰ä¸­ä»£ç åº“ï¼Œå³å‡»é€‰æ‹©â€Create Code Snippetâ€œ,å°±å¯ä»¥å°†å…¶ä¿å­˜ã€‚å¦‚æœæœ‰äº›åœ°æ–¹æƒ³è¦æ›¿æ¢æ‰ï¼Œä½¿ç”¨&lt;#è¢«æ›¿æ¢çš„å†…å®¹#&gt;çš„æ ¼å¼ï¼Œè¿™æ ·ä»£ç ç‰‡æ®µå¸¦ä½¿ç”¨åï¼Œç„¦ç‚¹ä¼šè‡ªåŠ¨ç§»åˆ°æ­¤å¤„ã€‚ è‡ªå®šä¹‰çš„ä»£ç ç‰‡æ®µä¿å­˜åœ¨ ~/Library/Developer/Xcode/UserData/CodeSnippets/ ç›®å½•ä¸‹ï¼Œå¯ä»¥å°†å…¶è®¾ç½®ä¸ºGitä»“åº“ï¼Œç„¶åå°†ä»£ç ç‰‡æ®µéƒ½æ”¾åœ¨Githubä¸Šï¼Œæ–¹ä¾¿ç®¡ç†ã€‚ iOSåº•å±‚å¼€å‘åŸç†Objective-Cå¯¹è±¡æ¨¡å‹isaæŒ‡é’ˆ Objective-Cæ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„è¯­éŸ³ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½æ˜¯ä¸€ä¸ªç±»çš„å®ä¾‹ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªisaæŒ‡é’ˆï¼ŒæŒ‡å‘è¯¥å¯¹è±¡çš„ç±»ã€‚æ¯ä¸€ä¸ªç±»æè¿°äº†å®ƒçš„å®ä¾‹çš„ç‰¹ç‚¹ï¼ŒåŒ…æ‹¬æˆå‘˜å˜é‡çš„çš„åˆ—è¡¨ï¼Œæˆå‘˜å‡½æ•°çš„åˆ—è¡¨ç­‰ã€‚ ç±»ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥æ˜¯å¦ä¸€ä¸ªç±»çš„å®ä¾‹ï¼Œè¿™ä¸ªç±»å°±æ˜¯å…ƒç±»ã€‚å…ƒç±»ä¿å­˜äº†ç±»æ–¹æ³•åˆ—è¡¨ï¼Œå½“ä¸€ä¸ªç±»æ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œå…ƒç±»ä¼šé¦–å…ˆæŸ¥æ‰¾å®ƒè‡ªèº«æ˜¯å¦æœ‰è¯¥æ–¹æ³•çš„æ—¶å€™ï¼Œæ²¡æœ‰çš„è¯å°±ä¼šå‘å…¶çˆ¶ç±»æŸ¥æ‰¾æ–¹æ³•ï¼Œè¿™æ ·å¯ä»¥ä¸€ç›´æ‰¾åˆ°ç»§æ‰¿é“¾çš„å¤´ã€‚ å…ƒç±»ä¹Ÿæ˜¯å¯¹è±¡ï¼Œå…¶isaæŒ‡é’ˆæŒ‡å‘æ ¹å…ƒç±»ã€‚æ ¹å…ƒç±»çš„isaæŒ‡é’ˆæŒ‡å‘è‡ªå·±ï¼Œè¿™æ ·å°±å½¢æˆäº†ä¸€ä¸ªé—­ç¯ã€‚ ç±»çš„æˆå‘˜å˜é‡ å¯¹è±¡åœ¨å†…å­˜ä¸­çš„æ’å¸ƒå¯ä»¥çœ‹æˆä¸€ä¸ªç»“æ„ä½“ï¼Œè¯¥ç»“æ„ä½“çš„å¤§å°ä¸èƒ½åŠ¨æ€å˜åŒ–ï¼Œæ‰€ä»¥æ— æ³•å†è¿è¡Œæ—¶åŠ¨æ€çš„æ·»åŠ æˆå‘˜å˜é‡ã€‚ æ–¹æ³•çš„å®šä¹‰åˆ—è¡¨æ˜¯ä¸€ä¸ªåä¸ºmethodListsçš„æŒ‡é’ˆçš„æŒ‡é’ˆï¼Œé€šè¿‡ä¿®æ”¹è¯¥æŒ‡é’ˆæŒ‡å‘çš„æŒ‡é’ˆçš„å€¼ï¼Œå¯ä»¥åŠ¨æ€çš„ä¸ºæŸä¸ªç±»å¢åŠ æˆå‘˜æ–¹æ³•ï¼Œè¿™ä¹Ÿæ˜¯åˆ†ç±»çš„å®ç°åŸç†ã€‚ isaæœ¬èº«ä¹Ÿæ˜¯æŒ‡é’ˆï¼Œæˆ‘ä»¬å¯ä»¥åŠ¨æ€çš„ä¿®æ”¹æŒ‡é’ˆçš„å€¼ï¼Œè¾¾åˆ°æ›¿æ¢å¯¹è±¡æ•´ä¸ªè¡Œä¸ºçš„ç›®çš„ï¼Œä¸è¿‡ç”¨çš„è¾ƒå°‘ã€‚ å¯¹è±¡æ¨¡å‹çš„åº”ç”¨è¿™ä¸€å°èŠ‚ç®€å•ä»‹ç»äº†ä¸€äº›Runtimeçš„åº”ç”¨ï¼Œå…·ä½“æŸ¥çœ‹è¿™ç¯‡ç¬”è®°ã€‚ Tagged Pointerå¯¹è±¡èƒŒæ™¯å‡è®¾è¦å­˜å‚¨ä¸€ä¸ªNSNumberå¯¹è±¡ï¼Œå…¶å€¼æ˜¯ä¸€ä¸ªæ•´æ•°ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœè¿™ä¸ªæ•´æ•°åªæ˜¯ä¸€ä¸ªNSIntegerçš„æ™®é€šå˜é‡ï¼Œé‚£ä¹ˆå®ƒæ‰€å ç”¨çš„å†…å­˜æ˜¯ä¸CPUçš„ä½æ•°æœ‰å…³ï¼Œåœ¨32ä½CPUä¸‹å 4ä¸ªå­—èŠ‚ï¼Œåœ¨64ä½CPUä¸‹æ˜¯å 8ä¸ªå­—èŠ‚çš„ã€‚è€ŒæŒ‡é’ˆç±»å‹çš„å¤§å°é€šå¸¸ä¹Ÿæ˜¯ä¸CPUä½æ•°ç›¸å…³ï¼Œä¸€ä¸ªæŒ‡é’ˆæ‰€å ç”¨çš„å†…å­˜åœ¨32ä½CPUä¸‹ä¸º4ä¸ªå­—èŠ‚ï¼Œåœ¨64ä½CPUä¸‹ä¹Ÿæ˜¯8ä¸ªå­—èŠ‚ã€‚æ‰€ä»¥ä¸€ä¸ªæ™®é€šçš„iOSç¨‹åºï¼Œå¦‚æœæ²¡æœ‰Tagged Pointerå¯¹è±¡ï¼Œä»32ä½æœºå™¨è¿ç§»åˆ°64ä½æœºå™¨ä¸­åï¼Œè™½ç„¶é€»è¾‘æ²¡æœ‰ä»»ä½•å˜åŒ–ï¼Œä½†è¿™ç§NSNumberã€NSDateä¸€ç±»çš„å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ä¼šç¿»å€ã€‚ åŸç†æŠŠæŒ‡é’ˆæŒ‡å‘çš„å†…å®¹ç›´æ¥æ”¾åœ¨äº†æŒ‡é’ˆå˜é‡çš„å†…å­˜åœ°å€ä¸­ï¼Œå› ä¸ºåœ¨ 64 ä½ç¯å¢ƒä¸‹æŒ‡é’ˆå˜é‡çš„å¤§å°è¾¾åˆ°äº† 8 ä½è¶³ä»¥å®¹çº³ä¸€äº›é•¿åº¦è¾ƒå°çš„å†…å®¹ã€‚äºæ˜¯ä½¿ç”¨äº†æ ‡ç­¾æŒ‡é’ˆè¿™ç§æ–¹å¼æ¥ä¼˜åŒ–æ•°æ®çš„å­˜å‚¨æ–¹å¼ã€‚ä»å¼•ç”¨è®¡æ•°å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªé‡Šæ”¾ä¸æ‰çš„å•ä¾‹å¸¸é‡å¯¹è±¡ã€‚åœ¨è¿è¡Œæ—¶æ ¹æ®å®é™…æƒ…å†µåˆ›å»ºã€‚ Blockå¯¹è±¡æ¨¡å‹å·§å“¥çš„åšå®¢12345678struct Block_layout &#123;void *isa;int flags;int reserved;void (*invoke)(void *, ...);struct Block_descriptor *descriptor;/* Imported variables. */&#125;; 123456struct Block_descriptor &#123;unsigned long int reserved;unsigned long int size;void (*copy)(void *dst, void *src);void (*dispose)(void *);&#125;; ä¸€ä¸ª block å®ä¾‹å®é™…ä¸Šç”± 6 éƒ¨åˆ†æ„æˆï¼š isa æŒ‡é’ˆï¼Œæ‰€æœ‰å¯¹è±¡éƒ½æœ‰è¯¥æŒ‡é’ˆï¼Œç”¨äºå®ç°å¯¹è±¡ç›¸å…³çš„åŠŸèƒ½ã€‚ flagsï¼Œç”¨äºæŒ‰ bit ä½è¡¨ç¤ºä¸€äº› block çš„é™„åŠ ä¿¡æ¯ï¼Œæœ¬æ–‡åé¢ä»‹ç» block copy çš„å®ç°ä»£ç å¯ä»¥çœ‹åˆ°å¯¹è¯¥å˜é‡çš„ä½¿ç”¨ã€‚ reservedï¼Œä¿ç•™å˜é‡ã€‚ invokeï¼Œå‡½æ•°æŒ‡é’ˆï¼ŒæŒ‡å‘å…·ä½“çš„ block å®ç°çš„å‡½æ•°è°ƒç”¨åœ°å€ã€‚ descriptorï¼Œ è¡¨ç¤ºè¯¥ block çš„é™„åŠ æè¿°ä¿¡æ¯ï¼Œä¸»è¦æ˜¯ size å¤§å°ï¼Œä»¥åŠ copy å’Œ dispose å‡½æ•°çš„æŒ‡é’ˆã€‚ variablesï¼Œcapture è¿‡æ¥çš„å˜é‡ï¼Œblock èƒ½å¤Ÿè®¿é—®å®ƒå¤–éƒ¨çš„å±€éƒ¨å˜é‡ï¼Œå°±æ˜¯å› ä¸ºå°†è¿™äº›å˜é‡ï¼ˆæˆ–å˜é‡çš„åœ°å€ï¼‰å¤åˆ¶åˆ°äº†ç»“æ„ä½“ä¸­ã€‚","categories":[{"name":"è¯»ä¹¦","slug":"è¯»ä¹¦","permalink":"https://bigporo.github.io/categories/è¯»ä¹¦/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/tags/iOS/"},{"name":"è¯»ä¹¦","slug":"è¯»ä¹¦","permalink":"https://bigporo.github.io/tags/è¯»ä¹¦/"}]},{"title":"iOSå„ç§è®¾å¤‡ä¿¡æ¯è·å–æ€»ç»“","slug":"iOSå„ç§è®¾å¤‡ä¿¡æ¯è·å–æ€»ç»“","date":"2019-04-23T09:17:43.000Z","updated":"2019-04-24T08:57:59.043Z","comments":true,"path":"2019/04/23/iOSå„ç§è®¾å¤‡ä¿¡æ¯è·å–æ€»ç»“/","link":"","permalink":"https://bigporo.github.io/2019/04/23/iOSå„ç§è®¾å¤‡ä¿¡æ¯è·å–æ€»ç»“/","excerpt":"ä¸ºäº†ç»Ÿè®¡ç”¨æˆ·ä¿¡æ¯ã€ä¸‹å‘å¹¿å‘Šï¼ŒæœåŠ¡å™¨ç«¯å¾€å¾€éœ€è¦æ‰‹æœºç”¨æˆ·è®¾å¤‡åŠappçš„å„ç§ä¿¡æ¯ï¼Œä¸‹é¢è®²è¿°ä¸€ä¸‹å„ç§ä¿¡æ¯çš„è·å–æ–¹å¼ï¼š","text":"ä¸ºäº†ç»Ÿè®¡ç”¨æˆ·ä¿¡æ¯ã€ä¸‹å‘å¹¿å‘Šï¼ŒæœåŠ¡å™¨ç«¯å¾€å¾€éœ€è¦æ‰‹æœºç”¨æˆ·è®¾å¤‡åŠappçš„å„ç§ä¿¡æ¯ï¼Œä¸‹é¢è®²è¿°ä¸€ä¸‹å„ç§ä¿¡æ¯çš„è·å–æ–¹å¼ï¼šç›´æ¥ä¸Šä»£ç :1234567891011121314151617181920212223242526272829303132333435363738// è¿™ä¸ªæ–¹æ³•åé¢ä¼šåˆ—å‡ºæ¥NSString *deviceName = [self getDeviceName];NSLog(@&quot;è®¾å¤‡å‹å·--&gt;%@&quot;, deviceName);NSString *iPhoneName = [UIDevice currentDevice].name;NSLog(@&quot;iPhoneåç§°--&gt;%@&quot;, iPhoneName); NSString *appVerion = [[[NSBundle mainBundle] infoDictionary] objectForKey:@&quot;CFBundleShortVersionString&quot;];NSLog(@&quot;appç‰ˆæœ¬å·--&gt;%@&quot;, appVerion);CGFloat batteryLevel = [[UIDevice currentDevice] batteryLevel];NSLog(@&quot;ç”µæ± ç”µé‡--&gt;%f&quot;, batteryLevel);NSString *localizedModel = [UIDevice currentDevice].localizedModel;NSLog(@&quot;localizedModel--&gt;%@&quot;, localizedModel);NSString *systemName = [UIDevice currentDevice].systemName;NSLog(@&quot;å½“å‰ç³»ç»Ÿåç§°--&gt;%@&quot;, systemName);NSString *systemVersion = [UIDevice currentDevice].systemVersion;NSLog(@&quot;å½“å‰ç³»ç»Ÿç‰ˆæœ¬å·--&gt;%@&quot;, systemVersion);struct utsname systemInfo;uname(&amp;systemInfo);NSString *device_model = [NSString stringWithCString:systemInfo.machine encoding:NSUTF8StringEncoding];NSLog(@&quot;device_model--&gt;%@&quot;, device_model);// è¿™ä¸ªæ–¹æ³•åé¢ä¼šå•ç‹¬åˆ—å‡ºNSString *macAddress = [self getMacAddress];NSLog(@&quot;macAddress--&gt;%@&quot;, macAddress);// è¿™ä¸ªæ–¹æ³•åé¢ä¼šå•ç‹¬åˆ—å‡ºNSString *deviceIP = [self getDeviceIPAddresses];NSLog(@&quot;deviceIP--&gt;%@&quot;, deviceIP);// è®¾å¤‡ä¸Šæ¬¡é‡å¯çš„æ—¶é—´NSTimeInterval time = [[NSProcessInfo processInfo] systemUptime];NSDate *lastRestartDate = [[NSDate alloc] initWithTimeIntervalSinceNow:(0 - time)]; å¹¿å‘Šä½æ ‡è¯†ç¬¦åœ¨åŒä¸€ä¸ªè®¾å¤‡ä¸Šçš„æ‰€æœ‰Appéƒ½ä¼šå–åˆ°ç›¸åŒçš„å€¼ï¼Œæ˜¯è‹¹æœä¸“é—¨ç»™å„å¹¿å‘Šæä¾›å•†ç”¨æ¥è¿½è¸ªç”¨æˆ·è€Œè®¾çš„ï¼Œç”¨æˆ·å¯ä»¥åœ¨ è®¾ç½®|éšç§|å¹¿å‘Šè¿½è¸ªé‡Œé‡ç½®æ­¤idçš„å€¼ï¼Œæˆ–é™åˆ¶æ­¤idçš„ä½¿ç”¨ï¼Œæ•…æ­¤idæœ‰å¯èƒ½ä¼šå–ä¸åˆ°å€¼ï¼Œä½†å¥½åœ¨Appleé»˜è®¤æ˜¯å…è®¸è¿½è¸ªçš„ï¼Œè€Œä¸”ä¸€èˆ¬ç”¨æˆ·éƒ½ä¸çŸ¥é“æœ‰è¿™ä¹ˆä¸ªè®¾ç½®ï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šç”¨æ¥ç›‘æµ‹æ¨å¹¿æ•ˆæœï¼Œæ˜¯æˆ³æˆ³æœ‰ä½™äº†ã€‚12NSString *idfa = [[[ASIdentifierManager sharedManager] advertisingIdentifier] UUIDString];NSLog(@&quot;å¹¿å‘Šä½æ ‡è¯†ç¬¦idfa--&gt;%@&quot;, idfa); UUIDæ˜¯Universally Unique Identifierçš„ç¼©å†™ï¼Œä¸­æ–‡æ„æ€æ˜¯é€šç”¨å”¯ä¸€è¯†åˆ«ç ã€‚å®ƒæ˜¯è®©åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œéƒ½èƒ½æœ‰å”¯ä¸€çš„è¾¨è¯†èµ„è®¯ï¼Œè€Œä¸éœ€è¦é€è¿‡ä¸­å¤®æ§åˆ¶ç«¯æ¥åšè¾¨è¯†èµ„è®¯çš„æŒ‡ å®šã€‚è¿™æ ·ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥å»ºç«‹ä¸ä¸å…¶å®ƒäººå†²çªçš„ UUIDã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œå°±ä¸éœ€è€ƒè™‘æ•°æ®åº“å»ºç«‹æ—¶çš„åç§°é‡å¤é—®é¢˜ã€‚è‹¹æœå…¬å¸å»ºè®®ä½¿ç”¨UUIDä¸ºåº”ç”¨ç”Ÿæˆå”¯ä¸€æ ‡è¯†å­—ç¬¦ä¸²ã€‚ 12NSString *uuid = [[[UIDevice currentDevice] identifierForVendor] UUIDString];NSLog(@&quot;å”¯ä¸€è¯†åˆ«ç uuid--&gt;%@&quot;, uuid); è·å–è®¾å¤‡å‹å·123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102// éœ€è¦#import &quot;sys/utsname.h&quot;#warning é¢˜ä¸»å‘•å¿ƒæ²¥è¡€æ€»ç»“ï¼ï¼æœ€å…¨é¢ï¼äº²æµ‹ï¼å…¨ç½‘ç‹¬æ­¤ä¸€ä»½ï¼ï¼struct utsname systemInfo;uname(&amp;systemInfo);NSString *deviceString = [NSString stringWithCString:systemInfo.machine encoding:NSUTF8StringEncoding];if ([deviceString isEqualToString:@&quot;iPhone3,1&quot;]) return @&quot;iPhone 4&quot;;if ([deviceString isEqualToString:@&quot;iPhone3,2&quot;]) return @&quot;iPhone 4&quot;;if ([deviceString isEqualToString:@&quot;iPhone3,3&quot;]) return @&quot;iPhone 4&quot;;if ([deviceString isEqualToString:@&quot;iPhone4,1&quot;]) return @&quot;iPhone 4S&quot;;if ([deviceString isEqualToString:@&quot;iPhone5,1&quot;]) return @&quot;iPhone 5&quot;;if ([deviceString isEqualToString:@&quot;iPhone5,2&quot;]) return @&quot;iPhone 5 (GSM+CDMA)&quot;;if ([deviceString isEqualToString:@&quot;iPhone5,3&quot;]) return @&quot;iPhone 5c (GSM)&quot;;if ([deviceString isEqualToString:@&quot;iPhone5,4&quot;]) return @&quot;iPhone 5c (GSM+CDMA)&quot;;if ([deviceString isEqualToString:@&quot;iPhone6,1&quot;]) return @&quot;iPhone 5s (GSM)&quot;;if ([deviceString isEqualToString:@&quot;iPhone6,2&quot;]) return @&quot;iPhone 5s (GSM+CDMA)&quot;;if ([deviceString isEqualToString:@&quot;iPhone7,1&quot;]) return @&quot;iPhone 6 Plus&quot;;if ([deviceString isEqualToString:@&quot;iPhone7,2&quot;]) return @&quot;iPhone 6&quot;;if ([deviceString isEqualToString:@&quot;iPhone8,1&quot;]) return @&quot;iPhone 6s&quot;;if ([deviceString isEqualToString:@&quot;iPhone8,2&quot;]) return @&quot;iPhone 6s Plus&quot;;if ([deviceString isEqualToString:@&quot;iPhone8,4&quot;]) return @&quot;iPhone SE&quot;;// æ—¥è¡Œä¸¤æ¬¾æ‰‹æœºå‹å·å‡ä¸ºæ—¥æœ¬ç‹¬å ï¼Œå¯èƒ½ä½¿ç”¨ç´¢å°¼FeliCaæ”¯ä»˜æ–¹æ¡ˆè€Œä¸æ˜¯è‹¹æœæ”¯ä»˜if ([deviceString isEqualToString:@&quot;iPhone9,1&quot;]) return @&quot;å›½è¡Œã€æ—¥ç‰ˆã€æ¸¯è¡ŒiPhone 7&quot;;if ([deviceString isEqualToString:@&quot;iPhone9,2&quot;]) return @&quot;æ¸¯è¡Œã€å›½è¡ŒiPhone 7 Plus&quot;;if ([deviceString isEqualToString:@&quot;iPhone9,3&quot;]) return @&quot;ç¾ç‰ˆã€å°ç‰ˆiPhone 7&quot;;if ([deviceString isEqualToString:@&quot;iPhone9,4&quot;]) return @&quot;ç¾ç‰ˆã€å°ç‰ˆiPhone 7 Plus&quot;;if ([deviceString isEqualToString:@&quot;iPhone10,1&quot;]) return @&quot;å›½è¡Œ(A1863)ã€æ—¥è¡Œ(A1906)iPhone 8&quot;;if ([deviceString isEqualToString:@&quot;iPhone10,4&quot;]) return @&quot;ç¾ç‰ˆ(Global/A1905)iPhone 8&quot;;if ([deviceString isEqualToString:@&quot;iPhone10,2&quot;]) return @&quot;å›½è¡Œ(A1864)ã€æ—¥è¡Œ(A1898)iPhone 8 Plus&quot;;if ([deviceString isEqualToString:@&quot;iPhone10,5&quot;]) return @&quot;ç¾ç‰ˆ(Global/A1897)iPhone 8 Plus&quot;;if ([deviceString isEqualToString:@&quot;iPhone10,3&quot;]) return @&quot;å›½è¡Œ(A1865)ã€æ—¥è¡Œ(A1902)iPhone X&quot;;if ([deviceString isEqualToString:@&quot;iPhone10,6&quot;]) return @&quot;ç¾ç‰ˆ(Global/A1901)iPhone X&quot;;if ([deviceString isEqualToString:@&quot;iPhone11,2&quot;]) return @&quot;iPhone XS&quot;;if ([deviceString isEqualToString:@&quot;iPhone11,4&quot;]) return @&quot;iPhone XS Max&quot;;if ([deviceString isEqualToString:@&quot;iPhone11,6&quot;]) return @&quot;iPhone XS Max&quot;;if ([deviceString isEqualToString:@&quot;iPhone11,8&quot;]) return @&quot;iPhone XR&quot;;if ([deviceString isEqualToString:@&quot;iPod1,1&quot;]) return @&quot;iPod Touch 1G&quot;;if ([deviceString isEqualToString:@&quot;iPod2,1&quot;]) return @&quot;iPod Touch 2G&quot;;if ([deviceString isEqualToString:@&quot;iPod3,1&quot;]) return @&quot;iPod Touch 3G&quot;;if ([deviceString isEqualToString:@&quot;iPod4,1&quot;]) return @&quot;iPod Touch 4G&quot;;if ([deviceString isEqualToString:@&quot;iPod5,1&quot;]) return @&quot;iPod Touch (5 Gen)&quot;;if ([deviceString isEqualToString:@&quot;iPad1,1&quot;]) return @&quot;iPad&quot;;if ([deviceString isEqualToString:@&quot;iPad1,2&quot;]) return @&quot;iPad 3G&quot;;if ([deviceString isEqualToString:@&quot;iPad2,1&quot;]) return @&quot;iPad 2 (WiFi)&quot;;if ([deviceString isEqualToString:@&quot;iPad2,2&quot;]) return @&quot;iPad 2&quot;;if ([deviceString isEqualToString:@&quot;iPad2,3&quot;]) return @&quot;iPad 2 (CDMA)&quot;;if ([deviceString isEqualToString:@&quot;iPad2,4&quot;]) return @&quot;iPad 2&quot;;if ([deviceString isEqualToString:@&quot;iPad2,5&quot;]) return @&quot;iPad Mini (WiFi)&quot;;if ([deviceString isEqualToString:@&quot;iPad2,6&quot;]) return @&quot;iPad Mini&quot;;if ([deviceString isEqualToString:@&quot;iPad2,7&quot;]) return @&quot;iPad Mini (GSM+CDMA)&quot;;if ([deviceString isEqualToString:@&quot;iPad3,1&quot;]) return @&quot;iPad 3 (WiFi)&quot;;if ([deviceString isEqualToString:@&quot;iPad3,2&quot;]) return @&quot;iPad 3 (GSM+CDMA)&quot;;if ([deviceString isEqualToString:@&quot;iPad3,3&quot;]) return @&quot;iPad 3&quot;;if ([deviceString isEqualToString:@&quot;iPad3,4&quot;]) return @&quot;iPad 4 (WiFi)&quot;;if ([deviceString isEqualToString:@&quot;iPad3,5&quot;]) return @&quot;iPad 4&quot;;if ([deviceString isEqualToString:@&quot;iPad3,6&quot;]) return @&quot;iPad 4 (GSM+CDMA)&quot;;if ([deviceString isEqualToString:@&quot;iPad4,1&quot;]) return @&quot;iPad Air (WiFi)&quot;;if ([deviceString isEqualToString:@&quot;iPad4,2&quot;]) return @&quot;iPad Air (Cellular)&quot;;if ([deviceString isEqualToString:@&quot;iPad4,4&quot;]) return @&quot;iPad Mini 2 (WiFi)&quot;;if ([deviceString isEqualToString:@&quot;iPad4,5&quot;]) return @&quot;iPad Mini 2 (Cellular)&quot;;if ([deviceString isEqualToString:@&quot;iPad4,6&quot;]) return @&quot;iPad Mini 2&quot;;if ([deviceString isEqualToString:@&quot;iPad4,7&quot;]) return @&quot;iPad Mini 3&quot;;if ([deviceString isEqualToString:@&quot;iPad4,8&quot;]) return @&quot;iPad Mini 3&quot;;if ([deviceString isEqualToString:@&quot;iPad4,9&quot;]) return @&quot;iPad Mini 3&quot;;if ([deviceString isEqualToString:@&quot;iPad5,1&quot;]) return @&quot;iPad Mini 4 (WiFi)&quot;;if ([deviceString isEqualToString:@&quot;iPad5,2&quot;]) return @&quot;iPad Mini 4 (LTE)&quot;;if ([deviceString isEqualToString:@&quot;iPad5,3&quot;]) return @&quot;iPad Air 2&quot;;if ([deviceString isEqualToString:@&quot;iPad5,4&quot;]) return @&quot;iPad Air 2&quot;;if ([deviceString isEqualToString:@&quot;iPad6,3&quot;]) return @&quot;iPad Pro 9.7&quot;;if ([deviceString isEqualToString:@&quot;iPad6,4&quot;]) return @&quot;iPad Pro 9.7&quot;;if ([deviceString isEqualToString:@&quot;iPad6,7&quot;]) return @&quot;iPad Pro 12.9&quot;;if ([deviceString isEqualToString:@&quot;iPad6,8&quot;]) return @&quot;iPad Pro 12.9&quot;;if ([deviceString isEqualToString:@&quot;iPad6,11&quot;]) return @&quot;iPad 5 (WiFi)&quot;;if ([deviceString isEqualToString:@&quot;iPad6,12&quot;]) return @&quot;iPad 5 (Cellular)&quot;;if ([deviceString isEqualToString:@&quot;iPad7,1&quot;]) return @&quot;iPad Pro 12.9 inch 2nd gen (WiFi)&quot;;if ([deviceString isEqualToString:@&quot;iPad7,2&quot;]) return @&quot;iPad Pro 12.9 inch 2nd gen (Cellular)&quot;;if ([deviceString isEqualToString:@&quot;iPad7,3&quot;]) return @&quot;iPad Pro 10.5 inch (WiFi)&quot;;if ([deviceString isEqualToString:@&quot;iPad7,4&quot;]) return @&quot;iPad Pro 10.5 inch (Cellular)&quot;;if ([deviceString isEqualToString:@&quot;iPad7,5&quot;]) return @&quot;iPad 6th generation&quot;;if ([deviceString isEqualToString:@&quot;iPad7,6&quot;]) return @&quot;iPad 6th generation&quot;;if ([deviceString isEqualToString:@&quot;iPad8,1&quot;]) return @&quot;iPad Pro (11-inch)&quot;;if ([deviceString isEqualToString:@&quot;iPad8,2&quot;]) return @&quot;iPad Pro (11-inch)&quot;;if ([deviceString isEqualToString:@&quot;iPad8,3&quot;]) return @&quot;iPad Pro (11-inch)&quot;;if ([deviceString isEqualToString:@&quot;iPad8,4&quot;]) return @&quot;iPad Pro (11-inch)&quot;;if ([deviceString isEqualToString:@&quot;iPad8,5&quot;]) return @&quot;iPad Pro (12.9-inch) (3rd generation)&quot;;if ([deviceString isEqualToString:@&quot;iPad8,6&quot;]) return @&quot;iPad Pro (12.9-inch) (3rd generation)&quot;;if ([deviceString isEqualToString:@&quot;iPad8,7&quot;]) return @&quot;iPad Pro (12.9-inch) (3rd generation)&quot;;if ([deviceString isEqualToString:@&quot;iPad8,8&quot;]) return @&quot;iPad Pro (12.9-inch) (3rd generation)&quot;;if ([deviceString isEqualToString:@&quot;AppleTV2,1&quot;]) return @&quot;Apple TV 2&quot;;if ([deviceString isEqualToString:@&quot;AppleTV3,1&quot;]) return @&quot;Apple TV 3&quot;;if ([deviceString isEqualToString:@&quot;AppleTV3,2&quot;]) return @&quot;Apple TV 3&quot;;if ([deviceString isEqualToString:@&quot;AppleTV5,3&quot;]) return @&quot;Apple TV 4&quot;;if ([deviceString isEqualToString:@&quot;i386&quot;]) return @&quot;Simulator&quot;;if ([deviceString isEqualToString:@&quot;x86_64&quot;]) return @&quot;Simulator&quot;;return deviceString;&#125; è·å– iPhone è®¾å¤‡é¢œè‰²/å¤–å£³é¢œè‰²12345678910111213141516#warning è¯¥æ–¹æ³•æ˜¯ç§æœ‰APIï¼Œä¸Šçº¿ä¼šè¢«æ‹’// ç”±äºæ¯æ¬¾æ‰‹æœºåŒä¸€é¢œè‰²å…·ä½“è‰²å·ä¸ä¸€æ ·ï¼Œå¦‚ iPhone 6å’Œ iPhone SEç²‰è‰²çš„ä¸¤ä¸ªå…·ä½“è‰²å€¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› æ­¤åœ¨è¿™é‡Œåªèƒ½è¿”å›ä¸€ä¸ªè‰²å·UIDevice *device = [UIDevice currentDevice];SEL selector = NSSelectorFromString(@&quot;deviceInfoForKey:&quot;);if (![device respondsToSelector:selector]) &#123;selector = NSSelectorFromString(@&quot;_deviceInfoForKey:&quot;);&#125;if ([device respondsToSelector:selector]) &#123;// æ¶ˆé™¤è­¦å‘Šâ€œperformSelector may cause a leak because its selector is unknownâ€IMP imp = [device methodForSelector:selector];NSString * (*func)(id, SEL, NSString *) = (void *)imp;NSString *deviceColor = func(device, selector, @&quot;DeviceColor&quot;);NSString *deviceEnclosureColor = func(device, selector, @&quot;DeviceEnclosureColor&quot;);NSLog(@&quot;deviceColor --&gt; %@ \\n @&quot;deviceEnclosureColor --&gt; %@ &quot;, deviceColor, deviceEnclosureColor);&#125; mac åœ°å€12345678910111213141516171819202122232425262728293031323334353637383940414243- (NSString *)getMacAddress &#123;int mib[6];size_t len;char *buf;unsigned char *ptr;struct if_msghdr *ifm;struct sockaddr_dl *sdl;mib[0] = CTL_NET;mib[1] = AF_ROUTE;mib[2] = 0;mib[3] = AF_LINK;mib[4] = NET_RT_IFLIST;if ((mib[5] = if_nametoindex(&quot;en0&quot;)) == 0) &#123;printf(&quot;Error: if_nametoindex error/n&quot;);return NULL;&#125;if (sysctl(mib, 6, NULL, &amp;len, NULL, 0) &lt; 0) &#123;printf(&quot;Error: sysctl, take 1/n&quot;);return NULL;&#125;if ((buf = malloc(len)) == NULL) &#123;printf(&quot;Could not allocate memory. error!/n&quot;);return NULL;&#125;if (sysctl(mib, 6, buf, &amp;len, NULL, 0) &lt; 0) &#123;printf(&quot;Error: sysctl, take 2&quot;);return NULL;&#125;ifm = (struct if_msghdr *)buf;sdl = (struct sockaddr_dl *)(ifm + 1);ptr = (unsigned char *)LLADDR(sdl);NSString *outstring = [NSString stringWithFormat:@&quot;%02x%02x%02x%02x%02x%02x&quot;, *ptr, *(ptr+1), *(ptr+2), *(ptr+3), *(ptr+4), *(ptr+5)];free(buf);return [outstring uppercaseString];&#125; IPåœ°å€123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354- (NSString *)getDeviceIPAddresses &#123;int sockfd = socket(AF_INET, SOCK_DGRAM, 0);NSMutableArray *ips = [NSMutableArray array];int BUFFERSIZE = 4096;struct ifconf ifc;char buffer[BUFFERSIZE], *ptr, lastname[IFNAMSIZ], *cptr;struct ifreq *ifr, ifrcopy;ifc.ifc_len = BUFFERSIZE;ifc.ifc_buf = buffer;if (ioctl(sockfd, SIOCGIFCONF, &amp;ifc) &gt;= 0)&#123;for (ptr = buffer; ptr &lt; buffer + ifc.ifc_len; )&#123;ifr = (struct ifreq *)ptr;int len = sizeof(struct sockaddr);if (ifr-&gt;ifr_addr.sa_len &gt; len) &#123;len = ifr-&gt;ifr_addr.sa_len;&#125;ptr += sizeof(ifr-&gt;ifr_name) + len;if (ifr-&gt;ifr_addr.sa_family != AF_INET) continue;if ((cptr = (char *)strchr(ifr-&gt;ifr_name, &apos;:&apos;)) != NULL) *cptr = 0;if (strncmp(lastname, ifr-&gt;ifr_name, IFNAMSIZ) == 0) continue;memcpy(lastname, ifr-&gt;ifr_name, IFNAMSIZ);ifrcopy = *ifr;ioctl(sockfd, SIOCGIFFLAGS, &amp;ifrcopy);if ((ifrcopy.ifr_flags &amp; IFF_UP) == 0) continue;NSString *ip = [NSString stringWithFormat:@&quot;%s&quot;, inet_ntoa(((struct sockaddr_in *)&amp;ifr-&gt;ifr_addr)-&gt;sin_addr)];[ips addObject:ip];&#125;&#125;close(sockfd);NSString *deviceIP = @&quot;&quot;;for (int i=0; i &lt; ips.count; i++) &#123;if (ips.count &gt; 0) &#123;deviceIP = [NSString stringWithFormat:@&quot;%@&quot;,ips.lastObject];&#125;&#125;return deviceIP;&#125; CPU12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061// CPUæ€»æ•°ç›®- (NSUInteger)getCPUCount &#123;return [NSProcessInfo processInfo].activeProcessorCount;&#125;// å·²ä½¿ç”¨çš„CPUæ¯”ä¾‹- (float)getCPUUsage &#123;float cpu = 0;NSArray *cpus = [self getPerCPUUsage];if (cpus.count == 0) return -1;for (NSNumber *n in cpus) &#123;cpu += n.floatValue;&#125;return cpu;&#125;// è·å–æ¯ä¸ªcpuçš„ä½¿ç”¨æ¯”ä¾‹- (NSArray *)getPerCPUUsage &#123;processor_info_array_t _cpuInfo, _prevCPUInfo = nil;mach_msg_type_number_t _numCPUInfo, _numPrevCPUInfo = 0;unsigned _numCPUs;NSLock *_cpuUsageLock;int _mib[2U] = &#123; CTL_HW, HW_NCPU &#125;;size_t _sizeOfNumCPUs = sizeof(_numCPUs);int _status = sysctl(_mib, 2U, &amp;_numCPUs, &amp;_sizeOfNumCPUs, NULL, 0U);if (_status)_numCPUs = 1;_cpuUsageLock = [[NSLock alloc] init];natural_t _numCPUsU = 0U;kern_return_t err = host_processor_info(mach_host_self(), PROCESSOR_CPU_LOAD_INFO, &amp;_numCPUsU, &amp;_cpuInfo, &amp;_numCPUInfo);if (err == KERN_SUCCESS) &#123;[_cpuUsageLock lock];NSMutableArray *cpus = [NSMutableArray new];for (unsigned i = 0U; i &lt; _numCPUs; ++i) &#123;Float32 _inUse, _total;if (_prevCPUInfo) &#123;_inUse = ((_cpuInfo[(CPU_STATE_MAX * i) + CPU_STATE_USER] - _prevCPUInfo[(CPU_STATE_MAX * i) + CPU_STATE_USER])+ (_cpuInfo[(CPU_STATE_MAX * i) + CPU_STATE_SYSTEM] - _prevCPUInfo[(CPU_STATE_MAX * i) + CPU_STATE_SYSTEM])+ (_cpuInfo[(CPU_STATE_MAX * i) + CPU_STATE_NICE] - _prevCPUInfo[(CPU_STATE_MAX * i) + CPU_STATE_NICE]));_total = _inUse + (_cpuInfo[(CPU_STATE_MAX * i) + CPU_STATE_IDLE] - _prevCPUInfo[(CPU_STATE_MAX * i) + CPU_STATE_IDLE]);&#125; else &#123;_inUse = _cpuInfo[(CPU_STATE_MAX * i) + CPU_STATE_USER] + _cpuInfo[(CPU_STATE_MAX * i) + CPU_STATE_SYSTEM] + _cpuInfo[(CPU_STATE_MAX * i) + CPU_STATE_NICE];_total = _inUse + _cpuInfo[(CPU_STATE_MAX * i) + CPU_STATE_IDLE];&#125;[cpus addObject:@(_inUse / _total)];&#125;[_cpuUsageLock unlock];if (_prevCPUInfo) &#123;size_t prevCpuInfoSize = sizeof(integer_t) * _numPrevCPUInfo;vm_deallocate(mach_task_self(), (vm_address_t)_prevCPUInfo, prevCpuInfoSize);&#125;return cpus;&#125; else &#123;return nil;&#125;&#125; Diskç£ç›˜ç©ºé—´123456789101112131415161718192021222324252627// è·å–ç£ç›˜æ€»ç©ºé—´- (int64_t)getTotalDiskSpace &#123;NSError *error = nil;NSDictionary *attrs = [[NSFileManager defaultManager] attributesOfFileSystemForPath:NSHomeDirectory() error:&amp;error];if (error) return -1;int64_t space = [[attrs objectForKey:NSFileSystemSize] longLongValue];if (space &lt; 0) space = -1;return space;&#125;// è·å–æœªä½¿ç”¨çš„ç£ç›˜ç©ºé—´- (int64_t)getFreeDiskSpace &#123;NSError *error = nil;NSDictionary *attrs = [[NSFileManager defaultManager] attributesOfFileSystemForPath:NSHomeDirectory() error:&amp;error];if (error) return -1;int64_t space = [[attrs objectForKey:NSFileSystemFreeSize] longLongValue];if (space &lt; 0) space = -1;return space;&#125;// è·å–å·²ä½¿ç”¨çš„ç£ç›˜ç©ºé—´- (int64_t)getUsedDiskSpace &#123;int64_t totalDisk = [self getTotalDiskSpace];int64_t freeDisk = [self getFreeDiskSpace];if (totalDisk &lt; 0 || freeDisk &lt; 0) return -1;int64_t usedDisk = totalDisk - freeDisk;if (usedDisk &lt; 0) usedDisk = -1;return usedDisk;&#125; Memoryå†…å­˜ç›¸å…³æ•°æ®123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596// ç³»ç»Ÿæ€»å†…å­˜ç©ºé—´- (int64_t)getTotalMemory &#123;int64_t totalMemory = [[NSProcessInfo processInfo] physicalMemory];if (totalMemory &lt; -1) totalMemory = -1;return totalMemory;&#125;// æ´»è·ƒçš„å†…å­˜,æ­£åœ¨ä½¿ç”¨æˆ–è€…å¾ˆçŸ­æ—¶é—´å†…è¢«ä½¿ç”¨è¿‡- (int64_t)getActiveMemory &#123;mach_port_t host_port = mach_host_self();mach_msg_type_number_t host_size = sizeof(vm_statistics_data_t) / sizeof(integer_t);vm_size_t page_size;vm_statistics_data_t vm_stat;kern_return_t kern;kern = host_page_size(host_port, &amp;page_size);if (kern != KERN_SUCCESS) return -1;kern = host_statistics(host_port, HOST_VM_INFO, (host_info_t)&amp;vm_stat, &amp;host_size);if (kern != KERN_SUCCESS) return -1;return vm_stat.active_count * page_size;&#125;// æœ€è¿‘ä½¿ç”¨è¿‡,ä½†æ˜¯ç›®å‰å¤„äºä¸æ´»è·ƒçŠ¶æ€çš„å†…å­˜- (int64_t)getInActiveMemory &#123;mach_port_t host_port = mach_host_self();mach_msg_type_number_t host_size = sizeof(vm_statistics_data_t) / sizeof(integer_t);vm_size_t page_size;vm_statistics_data_t vm_stat;kern_return_t kern;kern = host_page_size(host_port, &amp;page_size);if (kern != KERN_SUCCESS) return -1;kern = host_statistics(host_port, HOST_VM_INFO, (host_info_t)&amp;vm_stat, &amp;host_size);if (kern != KERN_SUCCESS) return -1;return vm_stat.inactive_count * page_size;&#125;// ç©ºé—²çš„å†…å­˜ç©ºé—´- (int64_t)getFreeMemory &#123;mach_port_t host_port = mach_host_self();mach_msg_type_number_t host_size = sizeof(vm_statistics_data_t) / sizeof(integer_t);vm_size_t page_size;vm_statistics_data_t vm_stat;kern_return_t kern;kern = host_page_size(host_port, &amp;page_size);if (kern != KERN_SUCCESS) return -1;kern = host_statistics(host_port, HOST_VM_INFO, (host_info_t)&amp;vm_stat, &amp;host_size);if (kern != KERN_SUCCESS) return -1;return vm_stat.free_count * page_size;&#125;// å·²ä½¿ç”¨çš„å†…å­˜ç©ºé—´- (int64_t)getUsedMemory &#123;mach_port_t host_port = mach_host_self();mach_msg_type_number_t host_size = sizeof(vm_statistics_data_t) / sizeof(integer_t);vm_size_t page_size;vm_statistics_data_t vm_stat;kern_return_t kern;kern = host_page_size(host_port, &amp;page_size);if (kern != KERN_SUCCESS) return -1;kern = host_statistics(host_port, HOST_VM_INFO, (host_info_t)&amp;vm_stat, &amp;host_size);if (kern != KERN_SUCCESS) return -1;return page_size * (vm_stat.active_count + vm_stat.inactive_count + vm_stat.wire_count);&#125;// ç”¨æ¥å­˜æ”¾å†…æ ¸å’Œæ•°æ®ç»“æ„çš„å†…å­˜,frameworkã€ç”¨æˆ·çº§åˆ«çš„åº”ç”¨æ— æ³•åˆ†é…- (int64_t)getWiredMemory &#123;mach_port_t host_port = mach_host_self();mach_msg_type_number_t host_size = sizeof(vm_statistics_data_t) / sizeof(integer_t);vm_size_t page_size;vm_statistics_data_t vm_stat;kern_return_t kern;kern = host_page_size(host_port, &amp;page_size);if (kern != KERN_SUCCESS) return -1;kern = host_statistics(host_port, HOST_VM_INFO, (host_info_t)&amp;vm_stat, &amp;host_size);if (kern != KERN_SUCCESS) return -1;return vm_stat.wire_count * page_size;&#125;// å¯é‡Šæ”¾çš„å†…å­˜ç©ºé—´ï¼šå†…å­˜åƒç´§è‡ªåŠ¨é‡Šæ”¾ï¼Œé’ˆå¯¹å¤§å¯¹è±¡å­˜æ”¾æ‰€éœ€çš„å¤§å—å†…å­˜ç©ºé—´- (int64_t)getPurgableMemory &#123;mach_port_t host_port = mach_host_self();mach_msg_type_number_t host_size = sizeof(vm_statistics_data_t) / sizeof(integer_t);vm_size_t page_size;vm_statistics_data_t vm_stat;kern_return_t kern;kern = host_page_size(host_port, &amp;page_size);if (kern != KERN_SUCCESS) return -1;kern = host_statistics(host_port, HOST_VM_INFO, (host_info_t)&amp;vm_stat, &amp;host_size);if (kern != KERN_SUCCESS) return -1;return vm_stat.purgeable_count * page_size;&#125; ä½œè€…ï¼šsi1enceé“¾æ¥ï¼šhttps://www.jianshu.com/p/b23016bb97afä¾†æºï¼šç®€ä¹¦","categories":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/categories/iOS/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/tags/iOS/"}]},{"title":"RunLoopè¯¦è§£","slug":"RunLoopè¯¦è§£","date":"2019-04-23T09:17:43.000Z","updated":"2019-04-24T08:58:09.617Z","comments":true,"path":"2019/04/23/RunLoopè¯¦è§£/","link":"","permalink":"https://bigporo.github.io/2019/04/23/RunLoopè¯¦è§£/","excerpt":"RunLoop è¯¦è§£RunLoopçš„æ¦‚å¿µä¸€èˆ¬æ¥è®²ï¼Œä¸€ä¸ªçº¿ç¨‹ä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œåœ¨æ‰§è¡Œå®Œä¸€ä¸ªä»»åŠ¡ä¹‹åçº¿ç¨‹å°±é€€å‡ºäº†ã€‚é€šè¿‡RunLoop,æˆ‘ä»¬å¯ä»¥è®©ä¸€ä¸ªçº¿ç¨‹å¯ä»¥éšæ—¶å¤„ç†ä»»åŠ¡è€Œä¸é€€å‡ºã€‚","text":"RunLoop è¯¦è§£RunLoopçš„æ¦‚å¿µä¸€èˆ¬æ¥è®²ï¼Œä¸€ä¸ªçº¿ç¨‹ä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œåœ¨æ‰§è¡Œå®Œä¸€ä¸ªä»»åŠ¡ä¹‹åçº¿ç¨‹å°±é€€å‡ºäº†ã€‚é€šè¿‡RunLoop,æˆ‘ä»¬å¯ä»¥è®©ä¸€ä¸ªçº¿ç¨‹å¯ä»¥éšæ—¶å¤„ç†ä»»åŠ¡è€Œä¸é€€å‡ºã€‚ é€šå¸¸çš„ä»£ç é€»è¾‘æ˜¯è¿™æ ·çš„ï¼š1234567function loop()&#123;do &#123;var message = get_next_message();process_message(message);&#125; while (message != quit);&#125; è¿™ç§æ¨¡å‹é€šå¸¸è¢«ç§°ä½œ Event Loopã€‚ Event Loop åœ¨å¾ˆå¤šç³»ç»Ÿå’Œæ¡†æ¶é‡Œéƒ½æœ‰å®ç°ï¼Œæ¯”å¦‚ Node.js çš„äº‹ä»¶å¤„ç†ï¼Œæ¯”å¦‚ Windows ç¨‹åºçš„æ¶ˆæ¯å¾ªç¯ï¼Œå†æ¯”å¦‚ OSX/iOS é‡Œçš„ RunLoopã€‚å®ç°è¿™ç§æ¨¡å‹çš„å…³é”®ç‚¹åœ¨äºï¼šå¦‚ä½•ç®¡ç†äº‹ä»¶/æ¶ˆæ¯ï¼Œå¦‚ä½•è®©çº¿ç¨‹åœ¨æ²¡æœ‰å¤„ç†æ¶ˆæ¯æ—¶ä¼‘çœ ä»¥é¿å…èµ„æºå ç”¨ã€åœ¨æœ‰æ¶ˆæ¯åˆ°æ¥æ—¶ç«‹åˆ»è¢«å”¤é†’ã€‚ æ‰€ä»¥ï¼ŒRunLoop å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ç®¡ç†äº†å…¶éœ€è¦å¤„ç†çš„äº‹ä»¶å’Œæ¶ˆæ¯ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªå…¥å£å‡½æ•°æ¥æ‰§è¡Œä¸Šé¢ Event Loop çš„é€»è¾‘ã€‚çº¿ç¨‹æ‰§è¡Œäº†è¿™ä¸ªå‡½æ•°åï¼Œå°±ä¼šä¸€ç›´å¤„äºè¿™ä¸ªå‡½æ•°å†…éƒ¨ â€œæ¥å—æ¶ˆæ¯-&gt;ç­‰å¾…-&gt;å¤„ç†â€ çš„å¾ªç¯ä¸­ï¼Œç›´åˆ°è¿™ä¸ªå¾ªç¯ç»“æŸï¼ˆæ¯”å¦‚ä¼ å…¥ quit çš„æ¶ˆæ¯ï¼‰ï¼Œå‡½æ•°è¿”å›ã€‚ OSX/iOS ç³»ç»Ÿä¸­ï¼Œæä¾›äº†ä¸¤ä¸ªè¿™æ ·çš„å¯¹è±¡ï¼šNSRunLoop å’Œ CFRunLoopRefã€‚CFRunLoopRef æ˜¯åœ¨ CoreFoundation æ¡†æ¶å†…çš„ï¼Œå®ƒæä¾›äº†çº¯ C å‡½æ•°çš„ APIï¼Œæ‰€æœ‰è¿™äº› API éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚NSRunLoop æ˜¯åŸºäº CFRunLoopRef çš„å°è£…ï¼Œæä¾›äº†é¢å‘å¯¹è±¡çš„ APIï¼Œä½†æ˜¯è¿™äº› API ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ RunLoopä¸çº¿ç¨‹ä¹‹é—´çš„å…³ç³»CFRunLoop æ˜¯åŸºäº pthread æ¥ç®¡ç†çš„ã€‚ çº¿ç¨‹å’Œ RunLoop ä¹‹é—´æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œå…¶å…³ç³»æ˜¯ä¿å­˜åœ¨ä¸€ä¸ªå…¨å±€çš„ Dictionary é‡Œã€‚RunLoopæ˜¯å¯ä»¥åµŒå¥—çš„ã€‚çº¿ç¨‹åˆšåˆ›å»ºæ—¶å¹¶æ²¡æœ‰ RunLoopï¼Œå¦‚æœä½ ä¸ä¸»åŠ¨è·å–ï¼Œé‚£å®ƒä¸€ç›´éƒ½ä¸ä¼šæœ‰ã€‚RunLoop çš„åˆ›å»ºæ˜¯å‘ç”Ÿåœ¨ç¬¬ä¸€æ¬¡è·å–æ—¶ï¼ŒRunLoop çš„é”€æ¯æ˜¯å‘ç”Ÿåœ¨çº¿ç¨‹ç»“æŸæ—¶ã€‚ä½ åªèƒ½åœ¨ä¸€ä¸ªçº¿ç¨‹çš„å†…éƒ¨è·å–å…¶ RunLoopï¼ˆä¸»çº¿ç¨‹é™¤å¤–ï¼‰ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738/// å…¨å±€çš„Dictionaryï¼Œkey æ˜¯ pthread_tï¼Œ value æ˜¯ CFRunLoopRefstatic CFMutableDictionaryRef loopsDic;/// è®¿é—® loopsDic æ—¶çš„é”static CFSpinLock_t loopsLock;/// è·å–ä¸€ä¸ª pthread å¯¹åº”çš„ RunLoopã€‚CFRunLoopRef _CFRunLoopGet(pthread_t thread) &#123;OSSpinLockLock(&amp;loopsLock);if (!loopsDic) &#123;// ç¬¬ä¸€æ¬¡è¿›å…¥æ—¶ï¼Œåˆå§‹åŒ–å…¨å±€Dicï¼Œå¹¶å…ˆä¸ºä¸»çº¿ç¨‹åˆ›å»ºä¸€ä¸ª RunLoopã€‚loopsDic = CFDictionaryCreateMutable();CFRunLoopRef mainLoop = _CFRunLoopCreate();CFDictionarySetValue(loopsDic, pthread_main_thread_np(), mainLoop);&#125;/// ç›´æ¥ä» Dictionary é‡Œè·å–ã€‚CFRunLoopRef loop = CFDictionaryGetValue(loopsDic, thread));if (!loop) &#123;/// å–ä¸åˆ°æ—¶ï¼Œåˆ›å»ºä¸€ä¸ªloop = _CFRunLoopCreate();CFDictionarySetValue(loopsDic, thread, loop);/// æ³¨å†Œä¸€ä¸ªå›è°ƒï¼Œå½“çº¿ç¨‹é”€æ¯æ—¶ï¼Œé¡ºä¾¿ä¹Ÿé”€æ¯å…¶å¯¹åº”çš„ RunLoopã€‚_CFSetTSD(..., thread, loop, __CFFinalizeRunLoop);&#125;OSSpinLockUnLock(&amp;loopsLock);return loop;&#125;CFRunLoopRef CFRunLoopGetMain() &#123;return _CFRunLoopGet(pthread_main_thread_np());&#125;CFRunLoopRef CFRunLoopGetCurrent() &#123;return _CFRunLoopGet(pthread_self());&#125; RunLoopæä¾›çš„æ¥å£1#include &lt;CoreFoundation/CFRunLoop.h&gt; åœ¨ CoreFoundation é‡Œé¢å…³äº RunLoop æœ‰5ä¸ªç±»: CFRunLoopRef CFRunLoopModeRef CFRunLoopSourceRef CFRunLoopTimerRef CFRunLoopObserverRef å…¶ä¸­ CFRunLoopModeRef ç±»å¹¶æ²¡æœ‰å¯¹å¤–æš´éœ²ï¼Œåªæ˜¯é€šè¿‡ CFRunLoopRef çš„æ¥å£è¿›è¡Œäº†å°è£…ã€‚ ä»–ä»¬çš„å…³ç³»å¦‚ä¸‹: ä¸€ä¸ª RunLoop åŒ…å«è‹¥å¹²ä¸ª Modeï¼Œæ¯ä¸ª Mode åˆåŒ…å«è‹¥å¹²ä¸ª Source/Timer/Observerã€‚æ¯æ¬¡è°ƒç”¨ RunLoop çš„ä¸»å‡½æ•°æ—¶ï¼Œåªèƒ½æŒ‡å®šå…¶ä¸­ä¸€ä¸ª Modeï¼Œè¿™ä¸ªModeè¢«ç§°ä½œ CurrentModeã€‚å¦‚æœéœ€è¦åˆ‡æ¢ Modeï¼Œåªèƒ½é€€å‡º Loopï¼Œå†é‡æ–°æŒ‡å®šä¸€ä¸ª Mode è¿›å…¥ã€‚è¿™æ ·åšä¸»è¦æ˜¯ä¸ºäº†åˆ†éš”å¼€ä¸åŒç»„çš„ Source/Timer/Observerï¼Œè®©å…¶äº’ä¸å½±å“ã€‚ CFRunLoopSourceRefæ˜¯äº‹ä»¶äº§ç”Ÿçš„åœ°æ–¹ã€‚Sourceæœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼šSource0 å’Œ Source1ã€‚ Source0 åªåŒ…å«äº†ä¸€ä¸ªå›è°ƒï¼ˆå‡½æ•°æŒ‡é’ˆï¼‰ï¼Œå®ƒå¹¶ä¸èƒ½ä¸»åŠ¨è§¦å‘äº‹ä»¶ã€‚ä½¿ç”¨æ—¶ï¼Œä½ éœ€è¦å…ˆè°ƒç”¨ CFRunLoopSourceSignal(source)ï¼Œå°†è¿™ä¸ª Source æ ‡è®°ä¸ºå¾…å¤„ç†ï¼Œç„¶åæ‰‹åŠ¨è°ƒç”¨ CFRunLoopWakeUp(runloop) æ¥å”¤é†’ RunLoopï¼Œè®©å…¶å¤„ç†è¿™ä¸ªäº‹ä»¶ã€‚ å¤„ç†APPå†…éƒ¨äº‹ä»¶ã€APPè‡ªå·±è´Ÿè´£ç®¡ç†(è§¦å‘)ï¼Œå¦‚UIEventç­‰ Source1 åŒ…å«äº†ä¸€ä¸ª mach_port å’Œä¸€ä¸ªå›è°ƒï¼ˆå‡½æ•°æŒ‡é’ˆï¼‰ï¼Œè¢«ç”¨äºé€šè¿‡å†…æ ¸å’Œå…¶ä»–çº¿ç¨‹ç›¸äº’å‘é€æ¶ˆæ¯ã€‚è¿™ç§ Source èƒ½ä¸»åŠ¨å”¤é†’ RunLoop çš„çº¿ç¨‹ï¼Œå…¶åŸç†åœ¨ä¸‹é¢ä¼šè®²åˆ°ã€‚ ç”±RunLoopå’Œå†…æ ¸ç®¡ç†ï¼ŒMach Port é©±åŠ¨ï¼Œå¦‚CFMachPort,CFMessagePort CFRunLoopTimerRef æ˜¯åŸºäºæ—¶é—´çš„è§¦å‘å™¨ï¼Œå®ƒå’Œ NSTimer æ˜¯toll-free bridged çš„ï¼Œå¯ä»¥æ··ç”¨ã€‚å…¶åŒ…å«ä¸€ä¸ªæ—¶é—´é•¿åº¦å’Œä¸€ä¸ªå›è°ƒï¼ˆå‡½æ•°æŒ‡é’ˆï¼‰ã€‚å½“å…¶åŠ å…¥åˆ° RunLoop æ—¶ï¼ŒRunLoopä¼šæ³¨å†Œå¯¹åº”çš„æ—¶é—´ç‚¹ï¼Œå½“æ—¶é—´ç‚¹åˆ°æ—¶ï¼ŒRunLoopä¼šè¢«å”¤é†’ä»¥æ‰§è¡Œé‚£ä¸ªå›è°ƒã€‚ CFRunLoopObserverRef æ˜¯è§‚å¯Ÿè€…ï¼Œæ¯ä¸ª Observer éƒ½åŒ…å«äº†ä¸€ä¸ªå›è°ƒï¼ˆå‡½æ•°æŒ‡é’ˆï¼‰ï¼Œå½“ RunLoop çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè§‚å¯Ÿè€…å°±èƒ½é€šè¿‡å›è°ƒæ¥å—åˆ°è¿™ä¸ªå˜åŒ–ã€‚å¯ä»¥è§‚æµ‹çš„æ—¶é—´ç‚¹æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š12345678typedef CF_OPTIONS(CFOptionFlags, CFRunLoopActivity) &#123;kCFRunLoopEntry = (1UL &lt;&lt; 0), // å³å°†è¿›å…¥LoopkCFRunLoopBeforeTimers = (1UL &lt;&lt; 1), // å³å°†å¤„ç† TimerkCFRunLoopBeforeSources = (1UL &lt;&lt; 2), // å³å°†å¤„ç† SourcekCFRunLoopBeforeWaiting = (1UL &lt;&lt; 5), // å³å°†è¿›å…¥ä¼‘çœ kCFRunLoopAfterWaiting = (1UL &lt;&lt; 6), // åˆšä»ä¼‘çœ ä¸­å”¤é†’kCFRunLoopExit = (1UL &lt;&lt; 7), // å³å°†é€€å‡ºLoop&#125;; ä¸Šé¢çš„ Source/Timer/Observer è¢«ç»Ÿç§°ä¸ºmode itemï¼Œä¸€ä¸ª item å¯ä»¥è¢«åŒæ—¶åŠ å…¥å¤šä¸ª modeã€‚ä½†ä¸€ä¸ª item è¢«é‡å¤åŠ å…¥åŒä¸€ä¸ª mode æ—¶æ˜¯ä¸ä¼šæœ‰æ•ˆæœçš„ã€‚å¦‚æœä¸€ä¸ª mode ä¸­ä¸€ä¸ª item éƒ½æ²¡æœ‰ï¼Œåˆ™ RunLoop ä¼šç›´æ¥é€€å‡ºï¼Œä¸è¿›å…¥å¾ªç¯ã€‚ RunLoopçš„ModeCFRunLoopMode å’Œ CFRunLoop çš„ç»“æ„å¤§è‡´å¦‚ä¸‹ï¼š 12345678910111213141516struct __CFRunLoopMode &#123;CFStringRef _name; // Mode Name, ä¾‹å¦‚ @&quot;kCFRunLoopDefaultMode&quot;CFMutableSetRef _sources0; // SetCFMutableSetRef _sources1; // SetCFMutableArrayRef _observers; // ArrayCFMutableArrayRef _timers; // Array...&#125;;struct __CFRunLoop &#123;CFMutableSetRef _commonModes; // SetCFMutableSetRef _commonModeItems; // Set&lt;Source/Observer/Timer&gt;CFRunLoopModeRef _currentMode; // Current Runloop ModeCFMutableSetRef _modes; // Set...&#125;; è¿™é‡Œæœ‰ä¸ªæ¦‚å¿µå« â€œCommonModesâ€ï¼šä¸€ä¸ª Mode å¯ä»¥å°†è‡ªå·±æ ‡è®°ä¸ºâ€Commonâ€å±æ€§ï¼ˆé€šè¿‡å°†å…¶ ModeName æ·»åŠ åˆ° RunLoop çš„ â€œcommonModesâ€ ä¸­ï¼‰ã€‚æ¯å½“ RunLoop çš„å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒRunLoop éƒ½ä¼šè‡ªåŠ¨å°† _commonModeItems é‡Œçš„ Source/Observer/Timer åŒæ­¥åˆ°å…·æœ‰ â€œCommonâ€ æ ‡è®°çš„æ‰€æœ‰Modeé‡Œã€‚ åº”ç”¨åœºæ™¯ä¸¾ä¾‹ï¼šä¸»çº¿ç¨‹çš„ RunLoop é‡Œæœ‰ä¸¤ä¸ªé¢„ç½®çš„ Modeï¼škCFRunLoopDefaultMode å’Œ UITrackingRunLoopModeã€‚è¿™ä¸¤ä¸ª Mode éƒ½å·²ç»è¢«æ ‡è®°ä¸ºâ€œCommonâ€å±æ€§ã€‚DefaultMode æ˜¯ App å¹³æ—¶æ‰€å¤„çš„çŠ¶æ€ï¼ŒTrackingRunLoopMode æ˜¯è¿½è¸ª ScrollView æ»‘åŠ¨æ—¶çš„çŠ¶æ€ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ª Timer å¹¶åŠ åˆ° DefaultMode æ—¶ï¼ŒTimer ä¼šå¾—åˆ°é‡å¤å›è°ƒï¼Œä½†æ­¤æ—¶æ»‘åŠ¨ä¸€ä¸ªTableViewæ—¶ï¼ŒRunLoop ä¼šå°† mode åˆ‡æ¢ä¸º TrackingRunLoopModeï¼Œè¿™æ—¶ Timer å°±ä¸ä¼šè¢«å›è°ƒï¼Œå¹¶ä¸”ä¹Ÿä¸ä¼šå½±å“åˆ°æ»‘åŠ¨æ“ä½œã€‚ æœ‰æ—¶ä½ éœ€è¦ä¸€ä¸ª Timerï¼Œåœ¨ä¸¤ä¸ª Mode ä¸­éƒ½èƒ½å¾—åˆ°å›è°ƒï¼Œä¸€ç§åŠæ³•å°±æ˜¯å°†è¿™ä¸ª Timer åˆ†åˆ«åŠ å…¥è¿™ä¸¤ä¸ª Modeã€‚è¿˜æœ‰ä¸€ç§æ–¹å¼ï¼Œå°±æ˜¯å°† Timer åŠ å…¥åˆ°é¡¶å±‚çš„ RunLoop çš„ â€œcommonModeItemsâ€ ä¸­ã€‚â€commonModeItemsâ€ è¢« RunLoopè‡ªåŠ¨æ›´æ–°åˆ°æ‰€æœ‰å…·æœ‰â€Commonâ€å±æ€§çš„ Mode é‡Œå»ã€‚ CFRunLoopå¯¹å¤–æš´éœ²çš„ç®¡ç† Mode æ¥å£åªæœ‰ä¸‹é¢2ä¸ª: 12CFRunLoopAddCommonMode(CFRunLoopRef runloop, CFStringRef modeName);CFRunLoopRunInMode(CFStringRef modeName, ...); Mode æš´éœ²çš„ç®¡ç† mode item çš„æ¥å£æœ‰ä¸‹é¢å‡ ä¸ªï¼š123456CFRunLoopAddSource(CFRunLoopRef rl, CFRunLoopSourceRef source, CFStringRef modeName);CFRunLoopAddObserver(CFRunLoopRef rl, CFRunLoopObserverRef observer, CFStringRef modeName);CFRunLoopAddTimer(CFRunLoopRef rl, CFRunLoopTimerRef timer, CFStringRef mode);CFRunLoopRemoveSource(CFRunLoopRef rl, CFRunLoopSourceRef source, CFStringRef modeName);CFRunLoopRemoveObserver(CFRunLoopRef rl, CFRunLoopObserverRef observer, CFStringRef modeName);CFRunLoopRemoveTimer(CFRunLoopRef rl, CFRunLoopTimerRef timer, CFStringRef mode); ä½ åªèƒ½é€šè¿‡ mode name æ¥æ“ä½œå†…éƒ¨çš„ modeï¼Œå½“ä½ ä¼ å…¥ä¸€ä¸ªæ–°çš„ mode name ä½† RunLoop å†…éƒ¨æ²¡æœ‰å¯¹åº” mode æ—¶ï¼ŒRunLoopä¼šè‡ªåŠ¨å¸®ä½ åˆ›å»ºå¯¹åº”çš„ CFRunLoopModeRefã€‚å¯¹äºä¸€ä¸ª RunLoop æ¥è¯´ï¼Œå…¶å†…éƒ¨çš„ mode åªèƒ½å¢åŠ ä¸èƒ½åˆ é™¤ã€‚ è‹¹æœå…¬å¼€æä¾›çš„ Mode æœ‰ä¸¤ä¸ªï¼škCFRunLoopDefaultMode (NSDefaultRunLoopMode) å’Œ UITrackingRunLoopModeï¼Œä½ å¯ä»¥ç”¨è¿™ä¸¤ä¸ª Mode Name æ¥æ“ä½œå…¶å¯¹åº”çš„ Modeã€‚è¿˜æœ‰ä¸€ä¸ªç§æœ‰çš„Modeæ˜¯UIInitializationRunLoopMode, åœ¨åˆšå¯åŠ¨ App æ—¶ç¬¬è¿›å…¥çš„ç¬¬ä¸€ä¸ª Modeï¼Œå¯åŠ¨å®Œæˆåå°±ä¸å†ä½¿ç”¨ã€‚ åŒæ—¶è‹¹æœè¿˜æä¾›äº†ä¸€ä¸ªæ“ä½œ Common æ ‡è®°çš„å­—ç¬¦ä¸²ï¼škCFRunLoopCommonModes (NSRunLoopCommonModes)ï¼Œä½ å¯ä»¥ç”¨è¿™ä¸ªå­—ç¬¦ä¸²æ¥æ“ä½œ Common Itemsï¼Œæˆ–æ ‡è®°ä¸€ä¸ª Mode ä¸º â€œCommonâ€ã€‚ä½¿ç”¨æ—¶æ³¨æ„åŒºåˆ†è¿™ä¸ªå­—ç¬¦ä¸²å’Œå…¶ä»– mode nameã€‚ RunLoopå†…éƒ¨é€»è¾‘RunLoop å†…éƒ¨çš„é€»è¾‘å¤§è‡´å¦‚ä¸‹: å…¶å†…éƒ¨ä»£ç æ•´ç†å¦‚ä¸‹:123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110/// ç”¨DefaultModeå¯åŠ¨void CFRunLoopRun(void) &#123;CFRunLoopRunSpecific(CFRunLoopGetCurrent(), kCFRunLoopDefaultMode, 1.0e10, false);&#125;/// ç”¨æŒ‡å®šçš„Modeå¯åŠ¨ï¼Œå…è®¸è®¾ç½®RunLoopè¶…æ—¶æ—¶é—´int CFRunLoopRunInMode(CFStringRef modeName, CFTimeInterval seconds, Boolean stopAfterHandle) &#123;return CFRunLoopRunSpecific(CFRunLoopGetCurrent(), modeName, seconds, returnAfterSourceHandled);&#125;/// RunLoopçš„å®ç°int CFRunLoopRunSpecific(runloop, modeName, seconds, stopAfterHandle) &#123;/// é¦–å…ˆæ ¹æ®modeNameæ‰¾åˆ°å¯¹åº”modeCFRunLoopModeRef currentMode = __CFRunLoopFindMode(runloop, modeName, false);/// å¦‚æœmodeé‡Œæ²¡æœ‰source/timer/observer, ç›´æ¥è¿”å›ã€‚if (__CFRunLoopModeIsEmpty(currentMode)) return;/// 1. é€šçŸ¥ Observers: RunLoop å³å°†è¿›å…¥ loopã€‚__CFRunLoopDoObservers(runloop, currentMode, kCFRunLoopEntry);/// å†…éƒ¨å‡½æ•°ï¼Œè¿›å…¥loop__CFRunLoopRun(runloop, currentMode, seconds, returnAfterSourceHandled) &#123;Boolean sourceHandledThisLoop = NO;int retVal = 0;do &#123;/// 2. é€šçŸ¥ Observers: RunLoop å³å°†è§¦å‘ Timer å›è°ƒã€‚__CFRunLoopDoObservers(runloop, currentMode, kCFRunLoopBeforeTimers);/// 3. é€šçŸ¥ Observers: RunLoop å³å°†è§¦å‘ Source0 (éport) å›è°ƒã€‚__CFRunLoopDoObservers(runloop, currentMode, kCFRunLoopBeforeSources);/// æ‰§è¡Œè¢«åŠ å…¥çš„block__CFRunLoopDoBlocks(runloop, currentMode);/// 4. RunLoop è§¦å‘ Source0 (éport) å›è°ƒã€‚sourceHandledThisLoop = __CFRunLoopDoSources0(runloop, currentMode, stopAfterHandle);/// æ‰§è¡Œè¢«åŠ å…¥çš„block__CFRunLoopDoBlocks(runloop, currentMode);/// 5. å¦‚æœæœ‰ Source1 (åŸºäºport) å¤„äº ready çŠ¶æ€ï¼Œç›´æ¥å¤„ç†è¿™ä¸ª Source1 ç„¶åè·³è½¬å»å¤„ç†æ¶ˆæ¯ã€‚if (__Source0DidDispatchPortLastTime) &#123;Boolean hasMsg = __CFRunLoopServiceMachPort(dispatchPort, &amp;msg)if (hasMsg) goto handle_msg;&#125;/// é€šçŸ¥ Observers: RunLoop çš„çº¿ç¨‹å³å°†è¿›å…¥ä¼‘çœ (sleep)ã€‚if (!sourceHandledThisLoop) &#123;__CFRunLoopDoObservers(runloop, currentMode, kCFRunLoopBeforeWaiting);&#125;/// 7. è°ƒç”¨ mach_msg ç­‰å¾…æ¥å— mach_port çš„æ¶ˆæ¯ã€‚çº¿ç¨‹å°†è¿›å…¥ä¼‘çœ , ç›´åˆ°è¢«ä¸‹é¢æŸä¸€ä¸ªäº‹ä»¶å”¤é†’ã€‚/// â€¢ ä¸€ä¸ªåŸºäº port çš„Source çš„äº‹ä»¶ã€‚/// â€¢ ä¸€ä¸ª Timer åˆ°æ—¶é—´äº†/// â€¢ RunLoop è‡ªèº«çš„è¶…æ—¶æ—¶é—´åˆ°äº†/// â€¢ è¢«å…¶ä»–ä»€ä¹ˆè°ƒç”¨è€…æ‰‹åŠ¨å”¤é†’__CFRunLoopServiceMachPort(waitSet, &amp;msg, sizeof(msg_buffer), &amp;livePort) &#123;mach_msg(msg, MACH_RCV_MSG, port); // thread wait for receive msg&#125;/// 8. é€šçŸ¥ Observers: RunLoop çš„çº¿ç¨‹åˆšåˆšè¢«å”¤é†’äº†ã€‚__CFRunLoopDoObservers(runloop, currentMode, kCFRunLoopAfterWaiting);/// æ”¶åˆ°æ¶ˆæ¯ï¼Œå¤„ç†æ¶ˆæ¯ã€‚handle_msg:/// 9.1 å¦‚æœä¸€ä¸ª Timer åˆ°æ—¶é—´äº†ï¼Œè§¦å‘è¿™ä¸ªTimerçš„å›è°ƒã€‚if (msg_is_timer) &#123;__CFRunLoopDoTimers(runloop, currentMode, mach_absolute_time())&#125; /// 9.2 å¦‚æœæœ‰dispatchåˆ°main_queueçš„blockï¼Œæ‰§è¡Œblockã€‚else if (msg_is_dispatch) &#123;__CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE__(msg);&#125; /// 9.3 å¦‚æœä¸€ä¸ª Source1 (åŸºäºport) å‘å‡ºäº‹ä»¶äº†ï¼Œå¤„ç†è¿™ä¸ªäº‹ä»¶else &#123;CFRunLoopSourceRef source1 = __CFRunLoopModeFindSourceForMachPort(runloop, currentMode, livePort);sourceHandledThisLoop = __CFRunLoopDoSource1(runloop, currentMode, source1, msg);if (sourceHandledThisLoop) &#123;mach_msg(reply, MACH_SEND_MSG, reply);&#125;&#125;/// æ‰§è¡ŒåŠ å…¥åˆ°Loopçš„block__CFRunLoopDoBlocks(runloop, currentMode);if (sourceHandledThisLoop &amp;&amp; stopAfterHandle) &#123;/// è¿›å…¥loopæ—¶å‚æ•°è¯´å¤„ç†å®Œäº‹ä»¶å°±è¿”å›ã€‚retVal = kCFRunLoopRunHandledSource;&#125; else if (timeout) &#123;/// è¶…å‡ºä¼ å…¥å‚æ•°æ ‡è®°çš„è¶…æ—¶æ—¶é—´äº†retVal = kCFRunLoopRunTimedOut;&#125; else if (__CFRunLoopIsStopped(runloop)) &#123;/// è¢«å¤–éƒ¨è°ƒç”¨è€…å¼ºåˆ¶åœæ­¢äº†retVal = kCFRunLoopRunStopped;&#125; else if (__CFRunLoopModeIsEmpty(runloop, currentMode)) &#123;/// source/timer/observerä¸€ä¸ªéƒ½æ²¡æœ‰äº†retVal = kCFRunLoopRunFinished;&#125;/// å¦‚æœæ²¡è¶…æ—¶ï¼Œmodeé‡Œæ²¡ç©ºï¼Œloopä¹Ÿæ²¡è¢«åœæ­¢ï¼Œé‚£ç»§ç»­loopã€‚&#125; while (retVal == 0);&#125;/// 10. é€šçŸ¥ Observers: RunLoop å³å°†é€€å‡ºã€‚__CFRunLoopDoObservers(rl, currentMode, kCFRunLoopExit);&#125; å¯ä»¥çœ‹åˆ°ï¼Œå®é™…ä¸Š RunLoop å°±æ˜¯è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼Œå…¶å†…éƒ¨æ˜¯ä¸€ä¸ª do-while å¾ªç¯ã€‚å½“ä½ è°ƒç”¨ CFRunLoopRun() æ—¶ï¼Œçº¿ç¨‹å°±ä¼šä¸€ç›´åœç•™åœ¨è¿™ä¸ªå¾ªç¯é‡Œï¼›ç›´åˆ°è¶…æ—¶æˆ–è¢«æ‰‹åŠ¨åœæ­¢ï¼Œè¯¥å‡½æ•°æ‰ä¼šè¿”å›ã€‚ RunLoopåº•å±‚å®ç°RunLoop çš„æ ¸å¿ƒæ˜¯åŸºäº mach port çš„ï¼Œå…¶è¿›å…¥ä¼‘çœ æ—¶è°ƒç”¨çš„å‡½æ•°æ˜¯ mach_msg()ã€‚ ä¸ºäº†å®ç°æ¶ˆæ¯çš„å‘é€å’Œæ¥æ”¶ï¼Œmach_msg() å‡½æ•°å®é™…ä¸Šæ˜¯è°ƒç”¨äº†ä¸€ä¸ª Mach é™·é˜± (trap)ï¼Œå³å‡½æ•°mach_msg_trap()ï¼Œé™·é˜±è¿™ä¸ªæ¦‚å¿µåœ¨ Mach ä¸­ç­‰åŒäºç³»ç»Ÿè°ƒç”¨ã€‚å½“ä½ åœ¨ç”¨æˆ·æ€è°ƒç”¨ mach_msg_trap() æ—¶ä¼šè§¦å‘é™·é˜±æœºåˆ¶ï¼Œåˆ‡æ¢åˆ°å†…æ ¸æ€ï¼›å†…æ ¸æ€ä¸­å†…æ ¸å®ç°çš„ mach_msg() å‡½æ•°ä¼šå®Œæˆå®é™…çš„å·¥ä½œï¼Œå¦‚ä¸‹å›¾ï¼š è‹¹æœç”¨ RunLoop å®ç°çš„åŠŸèƒ½é¦–å…ˆæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹ App å¯åŠ¨å RunLoop çš„çŠ¶æ€ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899CFRunLoop &#123;current mode = kCFRunLoopDefaultModecommon modes = &#123;UITrackingRunLoopModekCFRunLoopDefaultMode&#125;common mode items = &#123;// source0 (manual)CFRunLoopSource &#123;order =-1, &#123;callout = _UIApplicationHandleEventQueue&#125;&#125;CFRunLoopSource &#123;order =-1, &#123;callout = PurpleEventSignalCallback &#125;&#125;CFRunLoopSource &#123;order = 0, &#123;callout = FBSSerialQueueRunLoopSourceHandler&#125;&#125;// source1 (mach port)CFRunLoopSource &#123;order = 0, &#123;port = 17923&#125;&#125;CFRunLoopSource &#123;order = 0, &#123;port = 12039&#125;&#125;CFRunLoopSource &#123;order = 0, &#123;port = 16647&#125;&#125;CFRunLoopSource &#123;order =-1, &#123;callout = PurpleEventCallback&#125;&#125;CFRunLoopSource &#123;order = 0, &#123;port = 2407,callout = _ZL20notify_port_callbackP12__CFMachPortPvlS1_&#125;&#125;CFRunLoopSource &#123;order = 0, &#123;port = 1c03,callout = __IOHIDEventSystemClientAvailabilityCallback&#125;&#125;CFRunLoopSource &#123;order = 0, &#123;port = 1b03,callout = __IOHIDEventSystemClientQueueCallback&#125;&#125;CFRunLoopSource &#123;order = 1, &#123;port = 1903,callout = __IOMIGMachPortPortCallback&#125;&#125;// OvserverCFRunLoopObserver &#123;order = -2147483647, activities = 0x1, // Entrycallout = _wrapRunLoopWithAutoreleasePoolHandler&#125;CFRunLoopObserver &#123;order = 0, activities = 0x20, // BeforeWaitingcallout = _UIGestureRecognizerUpdateObserver&#125;CFRunLoopObserver &#123;order = 1999000, activities = 0xa0, // BeforeWaiting | Exitcallout = _afterCACommitHandler&#125;CFRunLoopObserver &#123;order = 2000000, activities = 0xa0, // BeforeWaiting | Exitcallout = _ZN2CA11Transaction17observer_callbackEP19__CFRunLoopObservermPv&#125;CFRunLoopObserver &#123;order = 2147483647, activities = 0xa0, // BeforeWaiting | Exitcallout = _wrapRunLoopWithAutoreleasePoolHandler&#125;// TimerCFRunLoopTimer &#123;firing = No, interval = 3.1536e+09, tolerance = 0,next fire date = 453098071 (-4421.76019 @ 96223387169499),callout = _ZN2CAL14timer_callbackEP16__CFRunLoopTimerPv (QuartzCore.framework)&#125;&#125;,modes ï¼ &#123;CFRunLoopMode &#123;sources0 = &#123; /* same as &apos;common mode items&apos; */ &#125;,sources1 = &#123; /* same as &apos;common mode items&apos; */ &#125;,observers = &#123; /* same as &apos;common mode items&apos; */ &#125;,timers = &#123; /* same as &apos;common mode items&apos; */ &#125;,&#125;,CFRunLoopMode &#123;sources0 = &#123; /* same as &apos;common mode items&apos; */ &#125;,sources1 = &#123; /* same as &apos;common mode items&apos; */ &#125;,observers = &#123; /* same as &apos;common mode items&apos; */ &#125;,timers = &#123; /* same as &apos;common mode items&apos; */ &#125;,&#125;,CFRunLoopMode &#123;sources0 = &#123;CFRunLoopSource &#123;order = 0, &#123;callout = FBSSerialQueueRunLoopSourceHandler&#125;&#125;&#125;,sources1 = (null),observers = &#123;CFRunLoopObserver &gt;&#123;activities = 0xa0, order = 2000000,callout = _ZN2CA11Transaction17observer_callbackEP19__CFRunLoopObservermPv&#125;)&#125;,timers = (null),&#125;,CFRunLoopMode &#123;sources0 = &#123;CFRunLoopSource &#123;order = -1, &#123;callout = PurpleEventSignalCallback&#125;&#125;&#125;,sources1 = &#123;CFRunLoopSource &#123;order = -1, &#123;callout = PurpleEventCallback&#125;&#125;&#125;,observers = (null),timers = (null),&#125;,CFRunLoopMode &#123;sources0 = (null),sources1 = (null),observers = (null),timers = (null),&#125;&#125;&#125; å¯ä»¥çœ‹åˆ°ï¼Œç³»ç»Ÿé»˜è®¤æ³¨å†Œäº†5ä¸ªMode: kCFRunLoopDefaultMode: Appçš„é»˜è®¤ Modeï¼Œé€šå¸¸ä¸»çº¿ç¨‹æ˜¯åœ¨è¿™ä¸ª Mode ä¸‹è¿è¡Œçš„ã€‚ UITrackingRunLoopMode: ç•Œé¢è·Ÿè¸ª Modeï¼Œç”¨äº ScrollView è¿½è¸ªè§¦æ‘¸æ»‘åŠ¨ï¼Œä¿è¯ç•Œé¢æ»‘åŠ¨æ—¶ä¸å—å…¶ä»– Mode å½±å“ã€‚ UIInitializationRunLoopMode: åœ¨åˆšå¯åŠ¨ App æ—¶ç¬¬è¿›å…¥çš„ç¬¬ä¸€ä¸ª Modeï¼Œå¯åŠ¨å®Œæˆåå°±ä¸å†ä½¿ç”¨ã€‚ GSEventReceiveRunLoopMode: æ¥å—ç³»ç»Ÿäº‹ä»¶çš„å†…éƒ¨ Modeï¼Œé€šå¸¸ç”¨ä¸åˆ°ã€‚ kCFRunLoopCommonModes: è¿™æ˜¯ä¸€ä¸ªå ä½çš„Mode,å¸¦æœ‰Commonæ ‡è®°çš„å­—ç¬¦ä¸²ï¼Œæ²¡æœ‰å®é™…ä½œç”¨ã€‚ AutoreleasePoolAppå¯åŠ¨åï¼Œè‹¹æœåœ¨ä¸»çº¿ç¨‹ RunLoop é‡Œæ³¨å†Œäº†ä¸¤ä¸ª Observerï¼Œå…¶å›è°ƒéƒ½æ˜¯ _wrapRunLoopWithAutoreleasePoolHandler()ã€‚ ç¬¬ä¸€ä¸ª Observer ç›‘è§†çš„äº‹ä»¶æ˜¯ Entry(å³å°†è¿›å…¥Loop)ï¼Œå…¶å›è°ƒå†…ä¼šè°ƒç”¨ _objc_autoreleasePoolPush() åˆ›å»ºè‡ªåŠ¨é‡Šæ”¾æ± ã€‚å…¶ order æ˜¯-2147483647ï¼Œä¼˜å…ˆçº§æœ€é«˜ï¼Œä¿è¯åˆ›å»ºé‡Šæ”¾æ± å‘ç”Ÿåœ¨å…¶ä»–æ‰€æœ‰å›è°ƒä¹‹å‰ã€‚ ç¬¬äºŒä¸ª Observer ç›‘è§†äº†ä¸¤ä¸ªäº‹ä»¶ï¼š BeforeWaiting(å‡†å¤‡è¿›å…¥ä¼‘çœ ) æ—¶è°ƒç”¨_objc_autoreleasePoolPop() å’Œ _objc_autoreleasePoolPush() é‡Šæ”¾æ—§çš„æ± å¹¶åˆ›å»ºæ–°æ± ï¼›Exit(å³å°†é€€å‡ºLoop) æ—¶è°ƒç”¨ _objc_autoreleasePoolPop() æ¥é‡Šæ”¾è‡ªåŠ¨é‡Šæ”¾æ± ã€‚è¿™ä¸ª Observer çš„ order æ˜¯ 2147483647ï¼Œä¼˜å…ˆçº§æœ€ä½ï¼Œä¿è¯å…¶é‡Šæ”¾æ± å­å‘ç”Ÿåœ¨å…¶ä»–æ‰€æœ‰å›è°ƒä¹‹åã€‚ å°ç»“ï¼šAutoreleasePoolæ˜¯åœ¨RunLoopå³å°†å¼€å§‹çš„æ—¶å€™åˆ›å»ºï¼Œæ˜¯åœ¨RunLoopå³å°†ä¼‘çœ æ—¶å€™é‡Šæ”¾ã€‚ åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„ä»£ç ï¼Œé€šå¸¸æ˜¯å†™åœ¨è¯¸å¦‚äº‹ä»¶å›è°ƒã€Timerå›è°ƒå†…çš„ã€‚è¿™äº›å›è°ƒä¼šè¢« RunLoop åˆ›å»ºå¥½çš„ AutoreleasePool ç¯ç»•ç€ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°å†…å­˜æ³„æ¼ï¼Œå¼€å‘è€…ä¹Ÿä¸å¿…æ˜¾ç¤ºåˆ›å»º Pool äº†ã€‚ äº‹ä»¶å“åº”è‹¹æœæ³¨å†Œäº†ä¸€ä¸ª Source1 (åŸºäº mach port çš„) ç”¨æ¥æ¥æ”¶ç³»ç»Ÿäº‹ä»¶ï¼Œå…¶å›è°ƒå‡½æ•°ä¸º __IOHIDEventSystemClientQueueCallback()ã€‚ å½“ä¸€ä¸ªç¡¬ä»¶äº‹ä»¶(è§¦æ‘¸/é”å±/æ‘‡æ™ƒç­‰)å‘ç”Ÿåï¼Œé¦–å…ˆç”± IOKit.framework ç”Ÿæˆä¸€ä¸ª IOHIDEvent äº‹ä»¶å¹¶ç”± SpringBoard æ¥æ”¶ã€‚è¿™ä¸ªè¿‡ç¨‹çš„è¯¦ç»†æƒ…å†µå¯ä»¥å‚è€ƒè¿™é‡Œã€‚SpringBoard åªæ¥æ”¶æŒ‰é”®(é”å±/é™éŸ³ç­‰)ï¼Œè§¦æ‘¸ï¼ŒåŠ é€Ÿï¼Œæ¥è¿‘ä¼ æ„Ÿå™¨ç­‰å‡ ç§ Eventï¼Œéšåç”¨ mach port è½¬å‘ç»™éœ€è¦çš„Appè¿›ç¨‹ã€‚éšåè‹¹æœæ³¨å†Œçš„é‚£ä¸ª Source1 å°±ä¼šè§¦å‘å›è°ƒï¼Œå¹¶è°ƒç”¨ _UIApplicationHandleEventQueue() è¿›è¡Œåº”ç”¨å†…éƒ¨çš„åˆ†å‘ã€‚ _UIApplicationHandleEventQueue() ä¼šæŠŠ IOHIDEvent å¤„ç†å¹¶åŒ…è£…æˆ UIEvent è¿›è¡Œå¤„ç†æˆ–åˆ†å‘ï¼Œå…¶ä¸­åŒ…æ‹¬è¯†åˆ« UIGesture/å¤„ç†å±å¹•æ—‹è½¬/å‘é€ç»™ UIWindow ç­‰ã€‚é€šå¸¸äº‹ä»¶æ¯”å¦‚ UIButton ç‚¹å‡»ã€touchesBegin/Move/End/Cancel äº‹ä»¶éƒ½æ˜¯åœ¨è¿™ä¸ªå›è°ƒä¸­å®Œæˆçš„ã€‚ æ‰‹åŠ¿è¯†åˆ«å½“ä¸Šé¢çš„ _UIApplicationHandleEventQueue() è¯†åˆ«äº†ä¸€ä¸ªæ‰‹åŠ¿æ—¶ï¼Œå…¶é¦–å…ˆä¼šè°ƒç”¨ Cancel å°†å½“å‰çš„ touchesBegin/Move/End ç³»åˆ—å›è°ƒæ‰“æ–­ã€‚éšåç³»ç»Ÿå°†å¯¹åº”çš„ UIGestureRecognizer æ ‡è®°ä¸ºå¾…å¤„ç†ã€‚ è‹¹æœæ³¨å†Œäº†ä¸€ä¸ª Observer ç›‘æµ‹ BeforeWaiting (Loopå³å°†è¿›å…¥ä¼‘çœ ) äº‹ä»¶ï¼Œè¿™ä¸ªObserverçš„å›è°ƒå‡½æ•°æ˜¯ _UIGestureRecognizerUpdateObserver()ï¼Œå…¶å†…éƒ¨ä¼šè·å–æ‰€æœ‰åˆšè¢«æ ‡è®°ä¸ºå¾…å¤„ç†çš„ GestureRecognizerï¼Œå¹¶æ‰§è¡ŒGestureRecognizerçš„å›è°ƒã€‚ å½“æœ‰ UIGestureRecognizer çš„å˜åŒ–(åˆ›å»º/é”€æ¯/çŠ¶æ€æ”¹å˜)æ—¶ï¼Œè¿™ä¸ªå›è°ƒéƒ½ä¼šè¿›è¡Œç›¸åº”å¤„ç†ã€‚ ç•Œé¢æ›´æ–°å½“åœ¨æ“ä½œ UI æ—¶ï¼Œæ¯”å¦‚æ”¹å˜äº† Frameã€æ›´æ–°äº† UIView/CALayer çš„å±‚æ¬¡æ—¶ï¼Œæˆ–è€…æ‰‹åŠ¨è°ƒç”¨äº† UIView/CALayer çš„ setNeedsLayout/setNeedsDisplayæ–¹æ³•åï¼Œè¿™ä¸ª UIView/CALayer å°±è¢«æ ‡è®°ä¸ºå¾…å¤„ç†ï¼Œå¹¶è¢«æäº¤åˆ°ä¸€ä¸ªå…¨å±€çš„å®¹å™¨å»ã€‚ è‹¹æœæ³¨å†Œäº†ä¸€ä¸ª Observer ç›‘å¬ BeforeWaiting(å³å°†è¿›å…¥ä¼‘çœ ) å’Œ Exit (å³å°†é€€å‡ºLoop) äº‹ä»¶ï¼Œå›è°ƒå»æ‰§è¡Œä¸€ä¸ªå¾ˆé•¿çš„å‡½æ•°ï¼š_ZN2CA11Transaction17observer_callbackEP19__CFRunLoopObservermPv()ã€‚è¿™ä¸ªå‡½æ•°é‡Œä¼šéå†æ‰€æœ‰å¾…å¤„ç†çš„ UIView/CAlayer ä»¥æ‰§è¡Œå®é™…çš„ç»˜åˆ¶å’Œè°ƒæ•´ï¼Œå¹¶æ›´æ–° UI ç•Œé¢ã€‚ PerformSelecterå½“è°ƒç”¨ NSObject çš„ performSelecter:afterDelay: åï¼Œå®é™…ä¸Šå…¶å†…éƒ¨ä¼šåˆ›å»ºä¸€ä¸ª Timer å¹¶æ·»åŠ åˆ°å½“å‰çº¿ç¨‹çš„ RunLoop ä¸­ã€‚æ‰€ä»¥å¦‚æœå½“å‰çº¿ç¨‹æ²¡æœ‰ RunLoopï¼Œåˆ™è¿™ä¸ªæ–¹æ³•ä¼šå¤±æ•ˆã€‚ å½“è°ƒç”¨ performSelector:onThread: æ—¶ï¼Œå®é™…ä¸Šå…¶ä¼šåˆ›å»ºä¸€ä¸ª Timer åŠ åˆ°å¯¹åº”çš„çº¿ç¨‹å»ï¼ŒåŒæ ·çš„ï¼Œå¦‚æœå¯¹åº”çº¿ç¨‹æ²¡æœ‰ RunLoop è¯¥æ–¹æ³•ä¹Ÿä¼šå¤±æ•ˆã€‚ å…³äºGCDå®é™…ä¸Š RunLoop åº•å±‚ä¹Ÿä¼šç”¨åˆ° GCD çš„ä¸œè¥¿ï¼Œæ¯”å¦‚ RunLoop æ˜¯ç”¨ dispatch_source_t å®ç°çš„ Timerï¼ˆè¯„è®ºä¸­æœ‰äººæé†’ï¼ŒNSTimer æ˜¯ç”¨äº† XNU å†…æ ¸çš„ mk_timerï¼Œæˆ‘ä¹Ÿä»”ç»†è°ƒè¯•äº†ä¸€ä¸‹ï¼Œå‘ç° NSTimer ç¡®å®æ˜¯ç”± mk_timer é©±åŠ¨ï¼Œè€Œé GCD é©±åŠ¨çš„ï¼‰ã€‚ä½†åŒæ—¶ GCD æä¾›çš„æŸäº›æ¥å£ä¹Ÿç”¨åˆ°äº† RunLoopï¼Œ ä¾‹å¦‚ dispatch_async()ã€‚ å½“è°ƒç”¨ dispatch_async(dispatch_get_main_queue(), block) æ—¶ï¼ŒlibDispatch ä¼šå‘ä¸»çº¿ç¨‹çš„ RunLoop å‘é€æ¶ˆæ¯ï¼ŒRunLoopä¼šè¢«å”¤é†’ï¼Œå¹¶ä»æ¶ˆæ¯ä¸­å–å¾—è¿™ä¸ª blockï¼Œå¹¶åœ¨å›è°ƒ CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE() é‡Œæ‰§è¡Œè¿™ä¸ª blockã€‚ä½†è¿™ä¸ªé€»è¾‘ä»…é™äº dispatch åˆ°ä¸»çº¿ç¨‹ï¼Œdispatch åˆ°å…¶ä»–çº¿ç¨‹ä»ç„¶æ˜¯ç”± libDispatch å¤„ç†çš„ã€‚ å®šæ—¶å™¨NSTimer å…¶å®å°±æ˜¯ CFRunLoopTimerRefï¼Œä»–ä»¬ä¹‹é—´æ˜¯ toll-free bridged çš„ã€‚ä¸€ä¸ª NSTimer æ³¨å†Œåˆ° RunLoop åï¼ŒRunLoop ä¼šä¸ºå…¶é‡å¤çš„æ—¶é—´ç‚¹æ³¨å†Œå¥½äº‹ä»¶ã€‚ä¾‹å¦‚ 10:00, 10:10, 10:20 è¿™å‡ ä¸ªæ—¶é—´ç‚¹ã€‚RunLoopä¸ºäº†èŠ‚çœèµ„æºï¼Œå¹¶ä¸ä¼šåœ¨éå¸¸å‡†ç¡®çš„æ—¶é—´ç‚¹å›è°ƒè¿™ä¸ªTimerã€‚Timer æœ‰ä¸ªå±æ€§å«åš Tolerance (å®½å®¹åº¦)ï¼Œæ ‡ç¤ºäº†å½“æ—¶é—´ç‚¹åˆ°åï¼Œå®¹è®¸æœ‰å¤šå°‘æœ€å¤§è¯¯å·®ã€‚ å¦‚æœæŸä¸ªæ—¶é—´ç‚¹è¢«é”™è¿‡äº†ï¼Œä¾‹å¦‚æ‰§è¡Œäº†ä¸€ä¸ªå¾ˆé•¿çš„ä»»åŠ¡ï¼Œåˆ™é‚£ä¸ªæ—¶é—´ç‚¹çš„å›è°ƒä¹Ÿä¼šè·³è¿‡å»ï¼Œä¸ä¼šå»¶åæ‰§è¡Œã€‚å°±æ¯”å¦‚ç­‰å…¬äº¤ï¼Œå¦‚æœ 10:10 æ—¶æˆ‘å¿™ç€ç©æ‰‹æœºé”™è¿‡äº†é‚£ä¸ªç‚¹çš„å…¬äº¤ï¼Œé‚£æˆ‘åªèƒ½ç­‰ 10:20 è¿™ä¸€è¶Ÿäº†ã€‚ CADisplayLink æ˜¯ä¸€ä¸ªå’Œå±å¹•åˆ·æ–°ç‡ä¸€è‡´çš„å®šæ—¶å™¨ï¼ˆä½†å®é™…å®ç°åŸç†æ›´å¤æ‚ï¼Œå’Œ NSTimer å¹¶ä¸ä¸€æ ·ï¼Œå…¶å†…éƒ¨å®é™…æ˜¯æ“ä½œäº†ä¸€ä¸ª Sourceï¼‰ã€‚å¦‚æœåœ¨ä¸¤æ¬¡å±å¹•åˆ·æ–°ä¹‹é—´æ‰§è¡Œäº†ä¸€ä¸ªé•¿ä»»åŠ¡ï¼Œé‚£å…¶ä¸­å°±ä¼šæœ‰ä¸€å¸§è¢«è·³è¿‡å»ï¼ˆå’Œ NSTimer ç›¸ä¼¼ï¼‰ï¼Œé€ æˆç•Œé¢å¡é¡¿çš„æ„Ÿè§‰ã€‚åœ¨å¿«é€Ÿæ»‘åŠ¨TableViewæ—¶ï¼Œå³ä½¿ä¸€å¸§çš„å¡é¡¿ä¹Ÿä¼šè®©ç”¨æˆ·æœ‰æ‰€å¯Ÿè§‰ã€‚Facebook å¼€æºçš„ AsyncDisplayLink å°±æ˜¯ä¸ºäº†è§£å†³ç•Œé¢å¡é¡¿çš„é—®é¢˜ï¼Œå…¶å†…éƒ¨ä¹Ÿç”¨åˆ°äº† RunLoopï¼Œ å…³äºç½‘ç»œè¯·æ±‚iOS ä¸­ï¼Œå…³äºç½‘ç»œè¯·æ±‚çš„æ¥å£è‡ªä¸‹è‡³ä¸Šæœ‰å¦‚ä¸‹å‡ å±‚: 1234CFSocketCFNetwork -&gt;ASIHttpRequestNSURLConnection -&gt;AFNetworkingNSURLSession -&gt;AFNetworking2, Alamofire CFSocket æ˜¯æœ€åº•å±‚çš„æ¥å£ï¼Œåªè´Ÿè´£ socket é€šä¿¡ã€‚ CFNetwork æ˜¯åŸºäº CFSocket ç­‰æ¥å£çš„ä¸Šå±‚å°è£…ï¼ŒASIHttpRequest å·¥ä½œäºè¿™ä¸€å±‚ã€‚ NSURLConnection æ˜¯åŸºäº CFNetwork çš„æ›´é«˜å±‚çš„å°è£…ï¼Œæä¾›é¢å‘å¯¹è±¡çš„æ¥å£ï¼ŒAFNetworking å·¥ä½œäºè¿™ä¸€å±‚ã€‚ NSURLSession æ˜¯ iOS7 ä¸­æ–°å¢çš„æ¥å£ï¼Œè¡¨é¢ä¸Šæ˜¯å’Œ NSURLConnection å¹¶åˆ—çš„ï¼Œä½†åº•å±‚ä»ç„¶ç”¨åˆ°äº† NSURLConnection çš„éƒ¨åˆ†åŠŸèƒ½ (æ¯”å¦‚ com.apple.NSURLConnectionLoader çº¿ç¨‹)ï¼ŒAFNetworking2 å’Œ Alamofire å·¥ä½œäºè¿™ä¸€å±‚ã€‚ ä¸‹é¢ä¸»è¦ä»‹ç»ä¸‹ NSURLConnection çš„å·¥ä½œè¿‡ç¨‹ã€‚ é€šå¸¸ä½¿ç”¨ NSURLConnection æ—¶ï¼Œä½ ä¼šä¼ å…¥ä¸€ä¸ª Delegateï¼Œå½“è°ƒç”¨äº† [connection start] åï¼Œè¿™ä¸ª Delegate å°±ä¼šä¸åœæ”¶åˆ°äº‹ä»¶å›è°ƒã€‚å®é™…ä¸Šï¼Œstart è¿™ä¸ªå‡½æ•°çš„å†…éƒ¨ä¼šä¼šè·å– CurrentRunLoopï¼Œç„¶ååœ¨å…¶ä¸­çš„ DefaultMode æ·»åŠ äº†4ä¸ª Source0 (å³éœ€è¦æ‰‹åŠ¨è§¦å‘çš„Source)ã€‚CFMultiplexerSource æ˜¯è´Ÿè´£å„ç§ Delegate å›è°ƒçš„ï¼ŒCFHTTPCookieStorage æ˜¯å¤„ç†å„ç§ Cookie çš„ã€‚ å½“å¼€å§‹ç½‘ç»œä¼ è¾“æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° NSURLConnection åˆ›å»ºäº†ä¸¤ä¸ªæ–°çº¿ç¨‹ï¼šcom.apple.NSURLConnectionLoader å’Œ com.apple.CFSocket.privateã€‚å…¶ä¸­ CFSocket çº¿ç¨‹æ˜¯å¤„ç†åº•å±‚ socket è¿æ¥çš„ã€‚NSURLConnectionLoader è¿™ä¸ªçº¿ç¨‹å†…éƒ¨ä¼šä½¿ç”¨ RunLoop æ¥æ¥æ”¶åº•å±‚ socket çš„äº‹ä»¶ï¼Œå¹¶é€šè¿‡ä¹‹å‰æ·»åŠ çš„ Source0 é€šçŸ¥åˆ°ä¸Šå±‚çš„ Delegateã€‚ NSURLConnectionLoader ä¸­çš„ RunLoop é€šè¿‡ä¸€äº›åŸºäº mach port çš„ Source æ¥æ”¶æ¥è‡ªåº•å±‚ CFSocket çš„é€šçŸ¥ã€‚å½“æ”¶åˆ°é€šçŸ¥åï¼Œå…¶ä¼šåœ¨åˆé€‚çš„æ—¶æœºå‘ CFMultiplexerSource ç­‰ Source0 å‘é€é€šçŸ¥ï¼ŒåŒæ—¶å”¤é†’ Delegate çº¿ç¨‹çš„ RunLoop æ¥è®©å…¶å¤„ç†è¿™äº›é€šçŸ¥ã€‚CFMultiplexerSource ä¼šåœ¨ Delegate çº¿ç¨‹çš„ RunLoop å¯¹ Delegate æ‰§è¡Œå®é™…çš„å›è°ƒã€‚ RunLoop çš„å®é™…åº”ç”¨ä¸¾ä¾‹AFNetworkingAFURLConnectionOperation è¿™ä¸ªç±»æ˜¯åŸºäº NSURLConnection æ„å»ºçš„ï¼Œå…¶å¸Œæœ›èƒ½åœ¨åå°çº¿ç¨‹æ¥æ”¶ Delegate å›è°ƒã€‚ä¸ºæ­¤ AFNetworking å•ç‹¬åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ï¼Œå¹¶åœ¨è¿™ä¸ªçº¿ç¨‹ä¸­å¯åŠ¨äº†ä¸€ä¸ª RunLoopï¼š 123456789101112131415161718+ (void)networkRequestThreadEntryPoint:(id)__unused object &#123;@autoreleasepool &#123;[[NSThread currentThread] setName:@&quot;AFNetworking&quot;];NSRunLoop *runLoop = [NSRunLoop currentRunLoop];[runLoop addPort:[NSMachPort port] forMode:NSDefaultRunLoopMode];[runLoop run];&#125;&#125;+ (NSThread *)networkRequestThread &#123;static NSThread *_networkRequestThread = nil;static dispatch_once_t oncePredicate;dispatch_once(&amp;oncePredicate, ^&#123;_networkRequestThread = [[NSThread alloc] initWithTarget:self selector:@selector(networkRequestThreadEntryPoint:) object:nil];[_networkRequestThread start];&#125;);return _networkRequestThread;&#125; RunLoop å¯åŠ¨å‰å†…éƒ¨å¿…é¡»è¦æœ‰è‡³å°‘ä¸€ä¸ª Timer/Observer/Sourceï¼Œæ‰€ä»¥ AFNetworking åœ¨ [runLoop run] ä¹‹å‰å…ˆåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ NSMachPort æ·»åŠ è¿›å»äº†ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œè°ƒç”¨è€…éœ€è¦æŒæœ‰è¿™ä¸ª NSMachPort (mach_port) å¹¶åœ¨å¤–éƒ¨çº¿ç¨‹é€šè¿‡è¿™ä¸ª port å‘é€æ¶ˆæ¯åˆ° loop å†…ï¼›ä½†æ­¤å¤„æ·»åŠ  port åªæ˜¯ä¸ºäº†è®© RunLoop ä¸è‡³äºé€€å‡ºï¼Œå¹¶æ²¡æœ‰ç”¨äºå®é™…çš„å‘é€æ¶ˆæ¯ã€‚ 12345678910- (void)start &#123;[self.lock lock];if ([self isCancelled]) &#123;[self performSelector:@selector(cancelConnection) onThread:[[self class] networkRequestThread] withObject:nil waitUntilDone:NO modes:[self.runLoopModes allObjects]];&#125; else if ([self isReady]) &#123;self.state = AFOperationExecutingState;[self performSelector:@selector(operationDidStart) onThread:[[self class] networkRequestThread] withObject:nil waitUntilDone:NO modes:[self.runLoopModes allObjects]];&#125;[self.lock unlock];&#125; å½“éœ€è¦è¿™ä¸ªåå°çº¿ç¨‹æ‰§è¡Œä»»åŠ¡æ—¶ï¼ŒAFNetworking é€šè¿‡è°ƒç”¨ [NSObject performSelector:onThread:..] å°†è¿™ä¸ªä»»åŠ¡æ‰”åˆ°äº†åå°çº¿ç¨‹çš„ RunLoop ä¸­ã€‚ AsyncDisplayKitAsyncDisplayKitæ˜¯ Facebook æ¨å‡ºçš„ç”¨äºä¿æŒç•Œé¢æµç•…æ€§çš„æ¡†æ¶ï¼Œå…¶åŸç†å¤§è‡´å¦‚ä¸‹ï¼š UI çº¿ç¨‹ä¸­ä¸€æ—¦å‡ºç°ç¹é‡çš„ä»»åŠ¡å°±ä¼šå¯¼è‡´ç•Œé¢å¡é¡¿ï¼Œè¿™ç±»ä»»åŠ¡é€šå¸¸åˆ†ä¸º3ç±»ï¼šæ’ç‰ˆï¼Œç»˜åˆ¶ï¼ŒUIå¯¹è±¡æ“ä½œã€‚ æ’ç‰ˆé€šå¸¸åŒ…æ‹¬è®¡ç®—è§†å›¾å¤§å°ã€è®¡ç®—æ–‡æœ¬é«˜åº¦ã€é‡æ–°è®¡ç®—å­å¼å›¾çš„æ’ç‰ˆç­‰æ“ä½œã€‚ç»˜åˆ¶ä¸€èˆ¬æœ‰æ–‡æœ¬ç»˜åˆ¶ (ä¾‹å¦‚ CoreText)ã€å›¾ç‰‡ç»˜åˆ¶ (ä¾‹å¦‚é¢„å…ˆè§£å‹)ã€å…ƒç´ ç»˜åˆ¶ (Quartz)ç­‰æ“ä½œã€‚UIå¯¹è±¡æ“ä½œé€šå¸¸åŒ…æ‹¬ UIView/CALayer ç­‰ UI å¯¹è±¡çš„åˆ›å»ºã€è®¾ç½®å±æ€§å’Œé”€æ¯ã€‚ å…¶ä¸­å‰ä¸¤ç±»æ“ä½œå¯ä»¥é€šè¿‡å„ç§æ–¹æ³•æ‰”åˆ°åå°çº¿ç¨‹æ‰§è¡Œï¼Œè€Œæœ€åä¸€ç±»æ“ä½œåªèƒ½åœ¨ä¸»çº¿ç¨‹å®Œæˆï¼Œå¹¶ä¸”æœ‰æ—¶åé¢çš„æ“ä½œéœ€è¦ä¾èµ–å‰é¢æ“ä½œçš„ç»“æœ ï¼ˆä¾‹å¦‚TextViewåˆ›å»ºæ—¶å¯èƒ½éœ€è¦æå‰è®¡ç®—å‡ºæ–‡æœ¬çš„å¤§å°ï¼‰ã€‚ASDK æ‰€åšçš„ï¼Œå°±æ˜¯å°½é‡å°†èƒ½æ”¾å…¥åå°çš„ä»»åŠ¡æ”¾å…¥åå°ï¼Œä¸èƒ½çš„åˆ™å°½é‡æ¨è¿Ÿ (ä¾‹å¦‚è§†å›¾çš„åˆ›å»ºã€å±æ€§çš„è°ƒæ•´)ã€‚ ä¸ºæ­¤ï¼ŒASDK åˆ›å»ºäº†ä¸€ä¸ªåä¸º ASDisplayNode çš„å¯¹è±¡ï¼Œå¹¶åœ¨å†…éƒ¨å°è£…äº† UIView/CALayerï¼Œå®ƒå…·æœ‰å’Œ UIView/CALayer ç›¸ä¼¼çš„å±æ€§ï¼Œä¾‹å¦‚ frameã€backgroundColorç­‰ã€‚æ‰€æœ‰è¿™äº›å±æ€§éƒ½å¯ä»¥åœ¨åå°çº¿ç¨‹æ›´æ”¹ï¼Œå¼€å‘è€…å¯ä»¥åªé€šè¿‡ Node æ¥æ“ä½œå…¶å†…éƒ¨çš„ UIView/CALayerï¼Œè¿™æ ·å°±å¯ä»¥å°†æ’ç‰ˆå’Œç»˜åˆ¶æ”¾å…¥äº†åå°çº¿ç¨‹ã€‚ä½†æ˜¯æ— è®ºæ€ä¹ˆæ“ä½œï¼Œè¿™äº›å±æ€§æ€»éœ€è¦åœ¨æŸä¸ªæ—¶åˆ»åŒæ­¥åˆ°ä¸»çº¿ç¨‹çš„ UIView/CALayer å»ã€‚ ASDK ä»¿ç…§ QuartzCore/UIKit æ¡†æ¶çš„æ¨¡å¼ï¼Œå®ç°äº†ä¸€å¥—ç±»ä¼¼çš„ç•Œé¢æ›´æ–°çš„æœºåˆ¶ï¼šå³åœ¨ä¸»çº¿ç¨‹çš„ RunLoop ä¸­æ·»åŠ ä¸€ä¸ª Observerï¼Œç›‘å¬äº† kCFRunLoopBeforeWaiting å’Œ kCFRunLoopExit äº‹ä»¶ï¼Œåœ¨æ”¶åˆ°å›è°ƒæ—¶ï¼Œéå†æ‰€æœ‰ä¹‹å‰æ”¾å…¥é˜Ÿåˆ—çš„å¾…å¤„ç†çš„ä»»åŠ¡ï¼Œç„¶åä¸€ä¸€æ‰§è¡Œã€‚ TableViewä¸­å®ç°å¹³æ»‘æ»šåŠ¨å»¶è¿ŸåŠ è½½å›¾ç‰‡åˆ©ç”¨CFRunLoopModeçš„ç‰¹æ€§ï¼Œå¯ä»¥å°†å›¾ç‰‡çš„åŠ è½½æ”¾åˆ°NSDefaultRunLoopModeçš„modeé‡Œï¼Œè¿™æ ·åœ¨æ»šåŠ¨UITrackingRunLoopModeè¿™ä¸ªmodeæ—¶ä¸ä¼šè¢«åŠ è½½è€Œå½±å“åˆ°ã€‚ 12345UIImage *downloadedImage = ...;[self.avatarImageView performSelector:@selector(setImage:)withObject:downloadedImageafterDelay:0inModes:@[NSDefaultRunLoopMode]]; ibiremeï¼šæ·±å…¥ç†è§£RunLoop iOSçº¿ä¸‹åˆ†äº«ã€ŠRunLoopã€‹by å­™æº@sunnyxx","categories":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/categories/iOS/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/tags/iOS/"}]},{"title":"RuntimeåŸç†ç¯‡","slug":"RuntimeåŸç†ç¯‡","date":"2019-04-23T09:17:43.000Z","updated":"2019-04-24T08:58:15.610Z","comments":true,"path":"2019/04/23/RuntimeåŸç†ç¯‡/","link":"","permalink":"https://bigporo.github.io/2019/04/23/RuntimeåŸç†ç¯‡/","excerpt":"Runtimeä»‹ç» Objective-C æ‰©å±•äº† C è¯­è¨€ï¼Œå¹¶åŠ å…¥äº†é¢å‘å¯¹è±¡ç‰¹æ€§å’Œ Smalltalk å¼çš„æ¶ˆæ¯ä¼ é€’æœºåˆ¶ã€‚è€Œè¿™ä¸ªæ‰©å±•çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªç”¨ C å’Œ ç¼–è¯‘è¯­è¨€ å†™çš„ Runtime åº“ã€‚å®ƒæ˜¯ Objective-C é¢å‘å¯¹è±¡å’ŒåŠ¨æ€æœºåˆ¶çš„åŸºçŸ³ã€‚ Objective-C æ˜¯ä¸€ä¸ªåŠ¨æ€è¯­è¨€ï¼Œè¿™æ„å‘³ç€å®ƒä¸ä»…éœ€è¦ä¸€ä¸ªç¼–è¯‘å™¨ï¼Œä¹Ÿéœ€è¦ä¸€ä¸ªè¿è¡Œæ—¶ç³»ç»Ÿæ¥åŠ¨æ€å¾—åˆ›å»ºç±»å’Œå¯¹è±¡ã€è¿›è¡Œæ¶ˆæ¯ä¼ é€’å’Œè½¬å‘ã€‚ç†è§£ Objective-C çš„ Runtime æœºåˆ¶å¯ä»¥å¸®æˆ‘ä»¬æ›´å¥½çš„äº†è§£è¿™ä¸ªè¯­è¨€ï¼Œé€‚å½“çš„æ—¶å€™è¿˜èƒ½å¯¹è¯­è¨€è¿›è¡Œæ‰©å±•ï¼Œä»ç³»ç»Ÿå±‚é¢è§£å†³é¡¹ç›®ä¸­çš„ä¸€äº›è®¾è®¡æˆ–æŠ€æœ¯é—®é¢˜ã€‚äº†è§£ Runtime ï¼Œè¦å…ˆäº†è§£å®ƒçš„æ ¸å¿ƒ - æ¶ˆæ¯ä¼ é€’ ï¼ˆMessagingï¼‰","text":"Runtimeä»‹ç» Objective-C æ‰©å±•äº† C è¯­è¨€ï¼Œå¹¶åŠ å…¥äº†é¢å‘å¯¹è±¡ç‰¹æ€§å’Œ Smalltalk å¼çš„æ¶ˆæ¯ä¼ é€’æœºåˆ¶ã€‚è€Œè¿™ä¸ªæ‰©å±•çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªç”¨ C å’Œ ç¼–è¯‘è¯­è¨€ å†™çš„ Runtime åº“ã€‚å®ƒæ˜¯ Objective-C é¢å‘å¯¹è±¡å’ŒåŠ¨æ€æœºåˆ¶çš„åŸºçŸ³ã€‚ Objective-C æ˜¯ä¸€ä¸ªåŠ¨æ€è¯­è¨€ï¼Œè¿™æ„å‘³ç€å®ƒä¸ä»…éœ€è¦ä¸€ä¸ªç¼–è¯‘å™¨ï¼Œä¹Ÿéœ€è¦ä¸€ä¸ªè¿è¡Œæ—¶ç³»ç»Ÿæ¥åŠ¨æ€å¾—åˆ›å»ºç±»å’Œå¯¹è±¡ã€è¿›è¡Œæ¶ˆæ¯ä¼ é€’å’Œè½¬å‘ã€‚ç†è§£ Objective-C çš„ Runtime æœºåˆ¶å¯ä»¥å¸®æˆ‘ä»¬æ›´å¥½çš„äº†è§£è¿™ä¸ªè¯­è¨€ï¼Œé€‚å½“çš„æ—¶å€™è¿˜èƒ½å¯¹è¯­è¨€è¿›è¡Œæ‰©å±•ï¼Œä»ç³»ç»Ÿå±‚é¢è§£å†³é¡¹ç›®ä¸­çš„ä¸€äº›è®¾è®¡æˆ–æŠ€æœ¯é—®é¢˜ã€‚äº†è§£ Runtime ï¼Œè¦å…ˆäº†è§£å®ƒçš„æ ¸å¿ƒ - æ¶ˆæ¯ä¼ é€’ ï¼ˆMessagingï¼‰ Runtimeå…¶å®æœ‰ä¸¤ä¸ªç‰ˆæœ¬: â€œmodernâ€ å’Œ â€œlegacyâ€ã€‚æˆ‘ä»¬ç°åœ¨ç”¨çš„ Objective-C 2.0 é‡‡ç”¨çš„æ˜¯ç°è¡Œ (Modern) ç‰ˆçš„ Runtime ç³»ç»Ÿï¼Œåªèƒ½è¿è¡Œåœ¨ iOS å’Œ macOS 10.5 ä¹‹åçš„ 64 ä½ç¨‹åºä¸­ã€‚è€Œ macOS è¾ƒè€çš„32ä½ç¨‹åºä»é‡‡ç”¨ Objective-C 1 ä¸­çš„ï¼ˆæ—©æœŸï¼‰Legacy ç‰ˆæœ¬çš„ Runtime ç³»ç»Ÿã€‚è¿™ä¸¤ä¸ªç‰ˆæœ¬æœ€å¤§çš„åŒºåˆ«åœ¨äºå½“ä½ æ›´æ”¹ä¸€ä¸ªç±»çš„å®ä¾‹å˜é‡çš„å¸ƒå±€æ—¶ï¼Œåœ¨æ—©æœŸç‰ˆæœ¬ä¸­ä½ éœ€è¦é‡æ–°ç¼–è¯‘å®ƒçš„å­ç±»ï¼Œè€Œç°è¡Œç‰ˆå°±ä¸éœ€è¦ã€‚ Runtime åŸºæœ¬æ˜¯ç”¨ C å’Œæ±‡ç¼–å†™çš„ï¼Œå¯è§è‹¹æœä¸ºäº†åŠ¨æ€ç³»ç»Ÿçš„é«˜æ•ˆè€Œä½œå‡ºçš„åŠªåŠ›ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œä¸‹åˆ°è‹¹æœç»´æŠ¤çš„å¼€æºä»£ç ã€‚è‹¹æœå’ŒGNUå„è‡ªç»´æŠ¤ä¸€ä¸ªå¼€æºçš„ runtime ç‰ˆæœ¬ï¼Œè¿™ä¸¤ä¸ªç‰ˆæœ¬ä¹‹é—´éƒ½åœ¨åŠªåŠ›çš„ä¿æŒä¸€è‡´ã€‚å¹³æ—¶çš„ä¸šåŠ¡ä¸­ä¸»è¦æ˜¯ä½¿ç”¨å®˜æ–¹Apiï¼Œè§£å†³æˆ‘ä»¬æ¡†æ¶æ€§çš„éœ€æ±‚ã€‚é«˜çº§ç¼–ç¨‹è¯­è¨€æƒ³è¦æˆä¸ºå¯æ‰§è¡Œæ–‡ä»¶éœ€è¦å…ˆç¼–è¯‘ä¸ºæ±‡ç¼–è¯­è¨€å†æ±‡ç¼–ä¸ºæœºå™¨è¯­è¨€ï¼Œæœºå™¨è¯­è¨€ä¹Ÿæ˜¯è®¡ç®—æœºèƒ½å¤Ÿè¯†åˆ«çš„å”¯ä¸€è¯­è¨€ï¼Œä½†æ˜¯OCå¹¶ä¸èƒ½ç›´æ¥ç¼–è¯‘ä¸ºæ±‡ç¼–è¯­è¨€ï¼Œè€Œæ˜¯è¦å…ˆè½¬å†™ä¸ºçº¯Cè¯­è¨€å†è¿›è¡Œç¼–è¯‘å’Œæ±‡ç¼–çš„æ“ä½œï¼Œä»OCåˆ°Cè¯­è¨€çš„è¿‡æ¸¡å°±æ˜¯ç”±runtimeæ¥å®ç°çš„ã€‚ç„¶è€Œæˆ‘ä»¬ä½¿ç”¨OCè¿›è¡Œé¢å‘å¯¹è±¡å¼€å‘ï¼Œè€ŒCè¯­è¨€æ›´å¤šçš„æ˜¯é¢å‘è¿‡ç¨‹å¼€å‘ï¼Œè¿™å°±éœ€è¦å°†é¢å‘å¯¹è±¡çš„ç±»è½¬å˜ä¸ºé¢å‘è¿‡ç¨‹çš„ç»“æ„ä½“ã€‚ Runtimeæ¶ˆæ¯ä¼ é€’ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•åƒè¿™æ ·[obj foo]ï¼Œç¼–è¯‘å™¨è½¬æˆæ¶ˆæ¯å‘é€objc_msgSend(obj, foo)ï¼ŒRuntimeæ—¶æ‰§è¡Œçš„æµç¨‹æ˜¯è¿™æ ·çš„ï¼š é¦–å…ˆï¼Œé€šè¿‡objçš„isaæŒ‡é’ˆæ‰¾åˆ°å®ƒçš„ class ; åœ¨ class çš„ method list æ‰¾ foo ; å¦‚æœ class ä¸­æ²¡åˆ° fooï¼Œç»§ç»­å¾€å®ƒçš„ superclass ä¸­æ‰¾ ; ä¸€æ—¦æ‰¾åˆ° foo è¿™ä¸ªå‡½æ•°ï¼Œå°±å»æ‰§è¡Œå®ƒçš„å®ç°IMP ã€‚ ä½†è¿™ç§å®ç°æœ‰ä¸ªé—®é¢˜ï¼Œæ•ˆç‡ä½ã€‚ä½†ä¸€ä¸ªclass å¾€å¾€åªæœ‰ 20% çš„å‡½æ•°ä¼šè¢«ç»å¸¸è°ƒç”¨ï¼Œå¯èƒ½å æ€»è°ƒç”¨æ¬¡æ•°çš„ 80% ã€‚æ¯ä¸ªæ¶ˆæ¯éƒ½éœ€è¦éå†ä¸€æ¬¡objc_method_list å¹¶ä¸åˆç†ã€‚å¦‚æœæŠŠç»å¸¸è¢«è°ƒç”¨çš„å‡½æ•°ç¼“å­˜ä¸‹æ¥ï¼Œé‚£å¯ä»¥å¤§å¤§æé«˜å‡½æ•°æŸ¥è¯¢çš„æ•ˆç‡ã€‚è¿™ä¹Ÿå°±æ˜¯objc_class ä¸­å¦ä¸€ä¸ªé‡è¦æˆå‘˜objc_cache åšçš„äº‹æƒ… - å†æ‰¾åˆ°foo ä¹‹åï¼ŒæŠŠfoo çš„method_name ä½œä¸ºkey ï¼Œmethod_impä½œä¸ºvalue ç»™å­˜èµ·æ¥ã€‚å½“å†æ¬¡æ”¶åˆ°foo æ¶ˆæ¯çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥åœ¨cache é‡Œæ‰¾åˆ°ï¼Œé¿å…å»éå†objc_method_listã€‚ä»å‰é¢çš„æºä»£ç å¯ä»¥çœ‹åˆ°objc_cacheæ˜¯å­˜åœ¨objc_class ç»“æ„ä½“ä¸­çš„ã€‚objec_msgSendçš„æ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼š 1OBJC_EXPORT id objc_msgSend(id self, SEL op, ...) é‚£æ¶ˆæ¯ä¼ é€’æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿæˆ‘ä»¬çœ‹çœ‹å¯¹è±¡(object)ï¼Œç±»(class)ï¼Œæ–¹æ³•(method)è¿™å‡ ä¸ªçš„ç»“æ„ä½“ï¼š 1234567891011121314151617181920212223242526272829303132333435//å¯¹è±¡struct objc_object &#123;Class isa OBJC_ISA_AVAILABILITY;&#125;;//ç±»struct objc_class &#123;Class isa OBJC_ISA_AVAILABILITY;#if !__OBJC2__Class super_class OBJC2_UNAVAILABLE;const char *name OBJC2_UNAVAILABLE;long version OBJC2_UNAVAILABLE;long info OBJC2_UNAVAILABLE;long instance_size OBJC2_UNAVAILABLE;struct objc_ivar_list *ivars OBJC2_UNAVAILABLE;struct objc_method_list **methodLists OBJC2_UNAVAILABLE;struct objc_cache *cache OBJC2_UNAVAILABLE;struct objc_protocol_list *protocols OBJC2_UNAVAILABLE;#endif&#125; OBJC2_UNAVAILABLE;//æ–¹æ³•åˆ—è¡¨struct objc_method_list &#123;struct objc_method_list *obsolete OBJC2_UNAVAILABLE;int method_count OBJC2_UNAVAILABLE;#ifdef __LP64__int space OBJC2_UNAVAILABLE;#endif/* variable length structure */struct objc_method method_list[1] OBJC2_UNAVAILABLE;&#125; OBJC2_UNAVAILABLE;//æ–¹æ³•struct objc_method &#123;SEL method_name OBJC2_UNAVAILABLE;char *method_types OBJC2_UNAVAILABLE;IMP method_imp OBJC2_UNAVAILABLE;&#125; ç³»ç»Ÿé¦–å…ˆæ‰¾åˆ°æ¶ˆæ¯çš„æ¥æ”¶å¯¹è±¡ï¼Œç„¶åé€šè¿‡å¯¹è±¡çš„isaæ‰¾åˆ°å®ƒçš„ç±»ã€‚ åœ¨å®ƒçš„ç±»ä¸­æŸ¥æ‰¾method_listï¼Œæ˜¯å¦æœ‰selectoræ–¹æ³•ã€‚ æ²¡æœ‰åˆ™æŸ¥æ‰¾çˆ¶ç±»çš„method_listã€‚ æ‰¾åˆ°å¯¹åº”çš„methodï¼Œæ‰§è¡Œå®ƒçš„IMPã€‚ è½¬å‘IMPçš„returnå€¼ã€‚ æ¶ˆæ¯ä¼ é€’ç”¨åˆ°çš„ä¸€äº›æ¦‚å¿µç±»å¯¹è±¡(objc_class)Objective-Cç±»æ˜¯ç”±Classç±»å‹æ¥è¡¨ç¤ºçš„ï¼Œå®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªæŒ‡å‘objc_classç»“æ„ä½“çš„æŒ‡é’ˆã€‚ç±»å¯¹è±¡(Class)æ˜¯ç”±ç¨‹åºå‘˜å®šä¹‰å¹¶åœ¨è¿è¡Œæ—¶ç”±ç¼–è¯‘å™¨åˆ›å»ºçš„ï¼Œå®ƒæ²¡æœ‰è‡ªå·±çš„å®ä¾‹å˜é‡ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ç±»çš„æˆå‘˜å˜é‡å’Œå®ä¾‹æ–¹æ³•åˆ—è¡¨æ˜¯å±äºå®ä¾‹å¯¹è±¡çš„ï¼Œä½†å…¶å­˜å‚¨äºç±»å¯¹è±¡å½“ä¸­çš„ã€‚ 1typedef struct objc_class *Class; æŸ¥çœ‹objc/runtime.hä¸­objc_classç»“æ„ä½“çš„å®šä¹‰å¦‚ä¸‹ï¼š 12345678910111213141516struct objc_class &#123;Class _Nonnull isa OBJC_ISA_AVAILABILITY;#if !__OBJC2__Class _Nullable super_class OBJC2_UNAVAILABLE;const char * _Nonnull name OBJC2_UNAVAILABLE;long version OBJC2_UNAVAILABLE;long info OBJC2_UNAVAILABLE;long instance_size OBJC2_UNAVAILABLE;struct objc_ivar_list * _Nullable ivars OBJC2_UNAVAILABLE;struct objc_method_list * _Nullable * _Nullable methodLists OBJC2_UNAVAILABLE;struct objc_cache * _Nonnull cache OBJC2_UNAVAILABLE;struct objc_protocol_list * _Nullable protocols OBJC2_UNAVAILABLE;#endif&#125; OBJC2_UNAVAILABLE; struct objc_classç»“æ„ä½“å®šä¹‰äº†å¾ˆå¤šå˜é‡ï¼Œé€šè¿‡å‘½åä¸éš¾å‘ç°ï¼Œç»“æ„ä½“é‡Œä¿å­˜äº†æŒ‡å‘çˆ¶ç±»çš„æŒ‡é’ˆã€ç±»çš„åå­—ã€ç‰ˆæœ¬ã€å®ä¾‹å¤§å°ã€å®ä¾‹å˜é‡åˆ—è¡¨ã€æ–¹æ³•åˆ—è¡¨ã€ç¼“å­˜ã€éµå®ˆçš„åè®®åˆ—è¡¨ç­‰ï¼Œä¸€ä¸ªç±»åŒ…å«çš„ä¿¡æ¯ä¹Ÿä¸å°±æ­£æ˜¯è¿™äº›å—ï¼Ÿæ²¡é”™ï¼Œç±»å¯¹è±¡å°±æ˜¯ä¸€ä¸ªç»“æ„ä½“struct objc_classï¼Œè¿™ä¸ªç»“æ„ä½“å­˜æ”¾çš„æ•°æ®ç§°ä¸ºå…ƒæ•°æ®(metadata)ï¼Œè¯¥ç»“æ„ä½“çš„ç¬¬ä¸€ä¸ªæˆå‘˜å˜é‡ä¹Ÿæ˜¯isaæŒ‡é’ˆï¼Œè¿™å°±è¯´æ˜äº†Classæœ¬èº«å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤æˆ‘ä»¬ç§°ä¹‹ä¸ºç±»å¯¹è±¡ï¼Œç±»å¯¹è±¡åœ¨ç¼–è¯‘æœŸäº§ç”Ÿç”¨äºåˆ›å»ºå®ä¾‹å¯¹è±¡ï¼Œæ˜¯å•ä¾‹ã€‚ å‚æ•°è§£æ isaæŒ‡é’ˆæ˜¯å’ŒClassåŒç±»å‹çš„objc_classç»“æ„æŒ‡é’ˆï¼Œç±»å¯¹è±¡çš„æŒ‡é’ˆæŒ‡å‘å…¶æ‰€å±çš„ç±»ï¼Œå³å…ƒç±»ã€‚å…ƒç±»ä¸­å­˜å‚¨ç€ç±»å¯¹è±¡çš„ç±»æ–¹æ³•ï¼Œå½“è®¿é—®æŸä¸ªç±»çš„ç±»æ–¹æ³•æ—¶ä¼šé€šè¿‡è¯¥isaæŒ‡é’ˆä»å…ƒç±»ä¸­å¯»æ‰¾æ–¹æ³•å¯¹åº”çš„å‡½æ•°æŒ‡é’ˆã€‚ super_classæŒ‡é’ˆæŒ‡å‘è¯¥ç±»æ‰€ç»§æ‰¿çš„çˆ¶ç±»å¯¹è±¡ï¼Œå¦‚æœè¯¥ç±»å·²ç»æ˜¯æœ€é¡¶å±‚çš„æ ¹ç±»(å¦‚NSObjectæˆ–NSProxy), åˆ™ super_classä¸ºNULLã€‚ cacheï¼šç”¨äºç¼“å­˜æœ€è¿‘ä½¿ç”¨çš„æ–¹æ³•ã€‚ä¸€ä¸ªæ¥æ”¶è€…å¯¹è±¡æ¥æ”¶åˆ°ä¸€ä¸ªæ¶ˆæ¯æ—¶ï¼Œå®ƒä¼šæ ¹æ®isaæŒ‡é’ˆå»æŸ¥æ‰¾èƒ½å¤Ÿå“åº”è¿™ä¸ªæ¶ˆæ¯çš„å¯¹è±¡ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œè¿™ä¸ªå¯¹è±¡åªæœ‰ä¸€éƒ¨åˆ†æ–¹æ³•æ˜¯å¸¸ç”¨çš„ï¼Œå¾ˆå¤šæ–¹æ³•å…¶å®å¾ˆå°‘ç”¨æˆ–è€…æ ¹æœ¬ç”¨ä¸ä¸Šã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæ¯æ¬¡æ¶ˆæ¯æ¥æ—¶ï¼Œæˆ‘ä»¬éƒ½æ˜¯methodListsä¸­éå†ä¸€éï¼Œæ€§èƒ½åŠ¿å¿…å¾ˆå·®ã€‚è¿™æ—¶ï¼Œcacheå°±æ´¾ä¸Šç”¨åœºäº†ã€‚åœ¨æˆ‘ä»¬æ¯æ¬¡è°ƒç”¨è¿‡ä¸€ä¸ªæ–¹æ³•åï¼Œè¿™ä¸ªæ–¹æ³•å°±ä¼šè¢«ç¼“å­˜åˆ°cacheåˆ—è¡¨ä¸­ï¼Œä¸‹æ¬¡è°ƒç”¨çš„æ—¶å€™runtimeå°±ä¼šä¼˜å…ˆå»cacheä¸­æŸ¥æ‰¾ï¼Œå¦‚æœcacheæ²¡æœ‰ï¼Œæ‰å»methodListsä¸­æŸ¥æ‰¾æ–¹æ³•ã€‚è¿™æ ·ï¼Œå¯¹äºé‚£äº›ç»å¸¸ç”¨åˆ°çš„æ–¹æ³•çš„è°ƒç”¨ï¼Œä½†æé«˜äº†è°ƒç”¨çš„æ•ˆç‡ã€‚ versionï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªå­—æ®µæ¥æä¾›ç±»çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚è¿™å¯¹äºå¯¹è±¡çš„åºåˆ—åŒ–éå¸¸æœ‰ç”¨ï¼Œå®ƒå¯æ˜¯è®©æˆ‘ä»¬è¯†åˆ«å‡ºä¸åŒç±»å®šä¹‰ç‰ˆæœ¬ä¸­å®ä¾‹å˜é‡å¸ƒå±€çš„æ”¹å˜ã€‚ protocolsï¼šå½“ç„¶å¯ä»¥çœ‹å‡ºè¿™ä¸€ä¸ªobjc_protocol_listçš„æŒ‡é’ˆã€‚å…³äºobjc_protocol_listçš„ç»“æ„ä½“æ„æˆåé¢ä¼šè®²ã€‚ è·å–ç±»å 1const char * class_getName ( Class cls ); åŠ¨æ€åˆ›å»ºç±» 12345678// åˆ›å»ºä¸€ä¸ªæ–°ç±»å’Œå…ƒç±»Class objc_allocateClassPair ( Class superclass, const char *name, size_t extraBytes ); //å¦‚æœåˆ›å»ºçš„æ˜¯root classï¼Œåˆ™superclassä¸ºNilã€‚extraBytesé€šå¸¸ä¸º0// é”€æ¯ä¸€ä¸ªç±»åŠå…¶ç›¸å…³è”çš„ç±»void objc_disposeClassPair ( Class cls ); //åœ¨è¿è¡Œä¸­è¿˜å­˜åœ¨æˆ–å­˜åœ¨å­ç±»å®ä¾‹ï¼Œå°±ä¸èƒ½å¤Ÿè°ƒç”¨è¿™ä¸ªã€‚// åœ¨åº”ç”¨ä¸­æ³¨å†Œç”±objc_allocateClassPairåˆ›å»ºçš„ç±»void objc_registerClassPair ( Class cls ); //åˆ›å»ºäº†æ–°ç±»åï¼Œç„¶åä½¿ç”¨class_addMethodï¼Œclass_addIvarå‡½æ•°ä¸ºæ–°ç±»æ·»åŠ æ–¹æ³•ï¼Œå®ä¾‹å˜é‡å’Œå±æ€§åå†è°ƒç”¨è¿™ä¸ªæ¥æ³¨å†Œç±»ï¼Œå†ä¹‹åå°±èƒ½å¤Ÿç”¨äº†ã€‚ å®ä¾‹(objc_object)å®ä¾‹å¯¹è±¡æ˜¯æˆ‘ä»¬å¯¹ç±»å¯¹è±¡allocæˆ–è€…newæ“ä½œæ—¶æ‰€åˆ›å»ºçš„ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¼šæ‹·è´å®ä¾‹æ‰€å±çš„ç±»çš„æˆå‘˜å˜é‡ï¼Œä½†å¹¶ä¸æ‹·è´ç±»å®šä¹‰çš„æ–¹æ³•ã€‚è°ƒç”¨å®ä¾‹æ–¹æ³•æ—¶ï¼Œç³»ç»Ÿä¼šæ ¹æ®å®ä¾‹çš„isaæŒ‡é’ˆå»ç±»çš„æ–¹æ³•åˆ—è¡¨åŠçˆ¶ç±»çš„æ–¹æ³•åˆ—è¡¨ä¸­å¯»æ‰¾ä¸æ¶ˆæ¯å¯¹åº”çš„selectoræŒ‡å‘çš„æ–¹æ³•ã€‚1234567/// Represents an instance of a class.struct objc_object &#123;Class isa OBJC_ISA_AVAILABILITY;&#125;;/// A pointer to an instance of a class.typedef struct objc_object *id; å¦å¤–æˆ‘ä»¬å¸¸è§çš„idç±»å‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªobjc_objectç»“æ„ç±»å‹çš„æŒ‡é’ˆã€‚è¯¥ç±»å‹çš„å¯¹è±¡å¯ä»¥è½¬æ¢ä¸ºä»»ä½•ä¸€ç§å¯¹è±¡ï¼Œç±»ä¼¼äºCè¯­è¨€ä¸­void *æŒ‡é’ˆç±»å‹çš„ä½œç”¨ã€‚å…¶å®šä¹‰å¦‚ä¸‹æ‰€ç¤º: 123/// A pointer to an instance of a class.typedef struct objc_object *id;#endif å¯¹å¯¹è±¡çš„ç±»æ“ä½œ 123456// è¿”å›ç»™å®šå¯¹è±¡çš„ç±»åconst char * object_getClassName ( id obj );// è¿”å›å¯¹è±¡çš„ç±»Class object_getClass ( id obj );// è®¾ç½®å¯¹è±¡çš„ç±»Class object_setClass ( id obj, Class cls ); è·å–å¯¹è±¡çš„ç±»å®šä¹‰ 12345678910111213// è·å–å·²æ³¨å†Œçš„ç±»å®šä¹‰çš„åˆ—è¡¨int objc_getClassList ( Class *buffer, int bufferCount );// åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘æ‰€æœ‰å·²æ³¨å†Œç±»çš„æŒ‡é’ˆåˆ—è¡¨Class * objc_copyClassList ( unsigned int *outCount );// è¿”å›æŒ‡å®šç±»çš„ç±»å®šä¹‰Class objc_lookUpClass ( const char *name );Class objc_getClass ( const char *name );Class objc_getRequiredClass ( const char *name );// è¿”å›æŒ‡å®šç±»çš„å…ƒç±»Class objc_getMetaClass ( const char *name ); åŠ¨æ€åˆ›å»ºå¯¹è±¡ 12345678// åˆ›å»ºç±»å®ä¾‹id class_createInstance ( Class cls, size_t extraBytes ); //ä¼šåœ¨heapé‡Œç»™ç±»åˆ†é…å†…å­˜ã€‚è¿™ä¸ªæ–¹æ³•å’Œ+allocæ–¹æ³•ç±»ä¼¼ã€‚// åœ¨æŒ‡å®šä½ç½®åˆ›å»ºç±»å®ä¾‹id objc_constructInstance ( Class cls, void *bytes ); // é”€æ¯ç±»å®ä¾‹void * objc_destructInstance ( id obj ); //ä¸ä¼šé‡Šæ”¾ç§»é™¤ä»»ä½•ç›¸å…³å¼•ç”¨ å…ƒç±»(Meta Class)ç±»å¯¹è±¡ä¸­çš„å…ƒæ•°æ®å­˜å‚¨çš„éƒ½æ˜¯å¦‚ä½•åˆ›å»ºä¸€ä¸ªå®ä¾‹çš„ç›¸å…³ä¿¡æ¯ï¼Œé‚£ä¹ˆç±»å¯¹è±¡å’Œç±»æ–¹æ³•åº”è¯¥ä»å“ªé‡Œåˆ›å»ºå‘¢ï¼Ÿå°±æ˜¯ä»isaæŒ‡é’ˆæŒ‡å‘çš„ç»“æ„ä½“åˆ›å»ºï¼Œç±»å¯¹è±¡çš„isaæŒ‡é’ˆæŒ‡å‘çš„æˆ‘ä»¬ç§°ä¹‹ä¸ºå…ƒç±»(metaclass)ï¼Œå…ƒç±»ä¸­ä¿å­˜äº†åˆ›å»ºç±»å¯¹è±¡ä»¥åŠç±»æ–¹æ³•æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå› æ­¤æ•´ä¸ªç»“æ„åº”è¯¥å¦‚ä¸‹å›¾æ‰€ç¤º: é€šè¿‡ä¸Šå›¾æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ•´ä¸ªä½“ç³»æ„æˆäº†ä¸€ä¸ªè‡ªé—­ç¯ï¼Œstruct objc_objectç»“æ„ä½“å®ä¾‹å®ƒçš„isaæŒ‡é’ˆæŒ‡å‘ç±»å¯¹è±¡ï¼Œç±»å¯¹è±¡çš„isaæŒ‡é’ˆæŒ‡å‘äº†å…ƒç±»ï¼Œsuper_classæŒ‡é’ˆæŒ‡å‘äº†çˆ¶ç±»çš„ç±»å¯¹è±¡ï¼Œè€Œå…ƒç±»çš„super_classæŒ‡é’ˆæŒ‡å‘äº†çˆ¶ç±»çš„å…ƒç±»ï¼Œé‚£å…ƒç±»çš„isaæŒ‡é’ˆåˆæŒ‡å‘äº†è‡ªå·±ã€‚å…ƒç±»(Meta Class)æ˜¯ä¸€ä¸ªç±»å¯¹è±¡çš„ç±»ã€‚ æ“ä½œå‡½æ•° 1234567// è·å–ç±»çš„çˆ¶ç±»Class class_getSuperclass ( Class cls );// åˆ¤æ–­ç»™å®šçš„Classæ˜¯å¦æ˜¯ä¸€ä¸ªmeta classBOOL class_isMetaClass ( Class cls );// è·å–å®ä¾‹å¤§å°size_t class_getInstanceSize ( Class cls ); å±æ€§(property)åœ¨Objective-Cä¸­ï¼Œå±æ€§(property)å’Œæˆå‘˜å˜é‡æ˜¯ä¸åŒçš„ã€‚é‚£ä¹ˆï¼Œå±æ€§çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿå®ƒå’Œæˆå‘˜å˜é‡ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿç®€å•æ¥è¯´å±æ€§æ˜¯æ·»åŠ äº†å­˜å–æ–¹æ³•çš„æˆå‘˜å˜é‡ï¼Œä¹Ÿå°±æ˜¯:1@property = ivar + getter + setter; å› æ­¤ï¼Œæˆ‘ä»¬æ¯å®šä¹‰ä¸€ä¸ª@propertyéƒ½ä¼šæ·»åŠ å¯¹åº”çš„ivar, getterå’Œsetteråˆ°ç±»ç»“æ„ä½“objc_classä¸­ã€‚å…·ä½“æ¥è¯´ï¼Œç³»ç»Ÿä¼šåœ¨objc_ivar_listä¸­æ·»åŠ ä¸€ä¸ªæˆå‘˜å˜é‡çš„æè¿°ï¼Œç„¶ååœ¨methodListsä¸­åˆ†åˆ«æ·»åŠ setterå’Œgetteræ–¹æ³•çš„æè¿°ã€‚ä¸‹é¢çš„objc_property_tæ˜¯å£°æ˜çš„å±æ€§çš„ç±»å‹ï¼Œæ˜¯ä¸€ä¸ªæŒ‡å‘objc_propertyç»“æ„ä½“çš„æŒ‡é’ˆã€‚ ç”¨æ³•ä¸¾ä¾‹ 123456789101112131415//éå†è·å–æ‰€æœ‰å±æ€§Property- (void) getAllProperty &#123;unsigned int propertyCount = 0;objc_property_t *propertyList = class_copyPropertyList([Person class], &amp;propertyCount);for (unsigned int i = 0; i &lt; propertyCount; i++ ) &#123;objc_property_t *thisProperty = propertyList[i];const char* propertyName = property_getName(*thisProperty);NSLog(@&quot;Personæ‹¥æœ‰çš„å±æ€§ä¸º: &apos;%s&apos;&quot;, propertyName);&#125;/** objc_property_t:/// An opaque type that represents an Objective-C declared property.typedef struct objc_property *objc_property_t;&#125; å¦å¤–ï¼Œå…³äºå±æ€§æœ‰ä¸€ä¸ªobjc_property_attribute_tç»“æ„ä½“åˆ—è¡¨ï¼Œobjc_property_attribute_tç»“æ„ä½“åŒ…å«nameå’Œvalueï¼Œå®šä¹‰å¦‚ä¸‹:1234typedef struct &#123;const char * _Nonnull name; /**&lt; The name of the attribute */const char * _Nonnull value; /**&lt; The value of the attribute (usually empty) */&#125; objc_property_attribute_t; å¸¸ç”¨çš„å±æ€§å¦‚ä¸‹ï¼š å±æ€§ç±»å‹ nameå€¼ï¼šT valueï¼šå˜åŒ– ç¼–ç ç±»å‹ nameå€¼ï¼šC(copy) &amp;(strong) W(weak)ç©º(assign) ç­‰ valueï¼šæ—  é/åŸå­æ€§ nameå€¼ï¼šç©º(atomic) N(Nonatomic) valueï¼šæ—  å˜é‡åç§° nameå€¼ï¼šV valueï¼šå˜åŒ–1234567891011@interface person : NSObjec&#123; NSString *_name; &#125; int main()&#123; objc_property_attribute_t nonatomic = &#123;&quot;N&quot;, &quot;&quot;&#125;; objc_property_attribute_t strong = &#123;&quot;&amp;&quot;, &quot;&quot;&#125;; objc_property_attribute_t type = &#123;&quot;T&quot;, &quot;@\\&quot;NSString\\&quot;&quot;&#125;; objc_property_attribute_t ivar = &#123;&quot;V&quot;, &quot;_name&quot;&#125;; objc_property_attribute_t attributes[] = &#123;nonatomic, strong, type, ivar&#125;; BOOL result = class_addProperty([person class], &quot;name&quot;, attributes, 4); &#125; æ“ä½œå‡½æ•° 12345678// è·å–å±æ€§åconst char * property_getName ( objc_property_t property );// è·å–å±æ€§ç‰¹æ€§æè¿°å­—ç¬¦ä¸²const char * property_getAttributes ( objc_property_t property );// è·å–å±æ€§ä¸­æŒ‡å®šçš„ç‰¹æ€§char * property_copyAttributeValue ( objc_property_t property, const char *attributeName );// è·å–å±æ€§çš„ç‰¹æ€§åˆ—è¡¨objc_property_attribute_t * property_copyAttributeList ( objc_property_t property, unsigned int *outCount ); æˆå‘˜å˜é‡(objc_ivar)Ivar: å®ä¾‹å˜é‡ç±»å‹ï¼Œæ˜¯ä¸€ä¸ªæŒ‡å‘objc_ivarç»“æ„ä½“çš„æŒ‡é’ˆ 12/// An opaque type that represents an instance variable.typedef struct objc_ivar *Ivar; objc_ivarç»“æ„ä½“çš„ç»„æˆå¦‚ä¸‹ï¼š 12345678- struct objc_ivar &#123;char * _Nullable ivar_name OBJC2_UNAVAILABLE;char * _Nullable ivar_type OBJC2_UNAVAILABLE;int ivar_offset OBJC2_UNAVAILABLE;#ifdef __LP64__int space OBJC2_UNAVAILABLE;#endif&#125; è¿™é‡Œæˆ‘ä»¬æ³¨æ„ç¬¬ä¸‰ä¸ªæˆå‘˜ ivar_offsetã€‚å®ƒè¡¨ç¤ºåŸºåœ°å€åç§»å­—èŠ‚ã€‚ æ“ä½œå‡½æ•° 12345678910111213141516171819//æˆå‘˜å˜é‡æ“ä½œå‡½æ•°// ä¿®æ”¹ç±»å®ä¾‹çš„å®ä¾‹å˜é‡çš„å€¼Ivar object_setInstanceVariable ( id obj, const char *name, void *value );// è·å–å¯¹è±¡å®ä¾‹å˜é‡çš„å€¼Ivar object_getInstanceVariable ( id obj, const char *name, void **outValue );// è¿”å›æŒ‡å‘ç»™å®šå¯¹è±¡åˆ†é…çš„ä»»ä½•é¢å¤–å­—èŠ‚çš„æŒ‡é’ˆvoid * object_getIndexedIvars ( id obj );// è¿”å›å¯¹è±¡ä¸­å®ä¾‹å˜é‡çš„å€¼id object_getIvar ( id obj, Ivar ivar );// è®¾ç½®å¯¹è±¡ä¸­å®ä¾‹å˜é‡çš„å€¼void object_setIvar ( id obj, Ivar ivar, id value );// è·å–ç±»æˆå‘˜å˜é‡çš„ä¿¡æ¯Ivar class_getClassVariable ( Class cls, const char *name );// æ·»åŠ æˆå‘˜å˜é‡BOOL class_addIvar ( Class cls, const char *name, size_t size, uint8_t alignment, const char *types ); //è¿™ä¸ªåªèƒ½å¤Ÿå‘åœ¨runtimeæ—¶åˆ›å»ºçš„ç±»æ·»åŠ æˆå‘˜å˜é‡// è·å–æ•´ä¸ªæˆå‘˜å˜é‡åˆ—è¡¨Ivar * class_copyIvarList ( Class cls, unsigned int *outCount ); //å¿…é¡»ä½¿ç”¨free()æ¥é‡Šæ”¾è¿™ä¸ªæ•°ç»„. æˆå‘˜å˜é‡åˆ—è¡¨(objc_ivar_list)åœ¨objc_classä¸­ï¼Œæ‰€æœ‰çš„æˆå‘˜å˜é‡ã€å±æ€§çš„ä¿¡æ¯æ˜¯æ”¾åœ¨é“¾è¡¨ivarsä¸­çš„ã€‚ivarsæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ æ˜¯æŒ‡å‘Ivar(å˜é‡ä¿¡æ¯)çš„æŒ‡é’ˆã€‚ 12345678struct objc_ivar_list &#123;int ivar_count OBJC2_UNAVAILABLE;#ifdef __LP64__int space OBJC2_UNAVAILABLE;#endif/* variable length structure */struct objc_ivar ivar_list[1] OBJC2_UNAVAILABLE;&#125; ä¾‹å­ï¼Œè·å–æ‰€æœ‰æˆå‘˜å˜é‡ 123456789101112//éå†è·å–Personç±»æ‰€æœ‰çš„æˆå‘˜å˜é‡IvarList- (void) getAllIvarList &#123;unsigned int methodCount = 0;Ivar * ivars = class_copyIvarList([Person class], &amp;methodCount);for (unsigned int i = 0; i &lt; methodCount; i ++) &#123;Ivar ivar = ivars[i];const char * name = ivar_getName(ivar);const char * type = ivar_getTypeEncoding(ivar);NSLog(@&quot;Personæ‹¥æœ‰çš„æˆå‘˜å˜é‡çš„ç±»å‹ä¸º%sï¼Œåå­—ä¸º %s &quot;,type, name);&#125;free(ivars);&#125; Method(objc_method)objc_method å­˜å‚¨äº†æ–¹æ³•åï¼Œæ–¹æ³•ç±»å‹å’Œæ–¹æ³•å®ç°ï¼š 1234567891011runtime.h/// An opaque type that represents a method in a class definition.ä»£è¡¨ç±»å®šä¹‰ä¸­ä¸€ä¸ªæ–¹æ³•çš„ä¸é€æ˜ç±»å‹typedef struct objc_method *Method;struct objc_method &#123;SEL method_name;OBJC2_UNAVAILABLE;char *method_types; OBJC2_UNAVAILABLE;IMP method_imp; OBJC2_UNAVAILABLE;&#125; Methodå’Œæˆ‘ä»¬å¹³æ—¶ç†è§£çš„å‡½æ•°æ˜¯ä¸€è‡´çš„ï¼Œå°±æ˜¯è¡¨ç¤ºèƒ½å¤Ÿç‹¬ç«‹å®Œæˆä¸€ä¸ªåŠŸèƒ½çš„ä¸€æ®µä»£ç ï¼Œæ¯”å¦‚ï¼š 1234- (void)logName&#123;NSLog(@&quot;name&quot;);&#125; æˆ‘ä»¬æ¥çœ‹ä¸‹objc_methodè¿™ä¸ªç»“æ„ä½“çš„å†…å®¹ï¼š SEL method_name æ–¹æ³•å char *method_types æ–¹æ³•ç±»å‹ï¼Œå­˜å‚¨æ–¹æ³•çš„å‚æ•°ç±»å‹å’Œè¿”å›å€¼ç±»å‹ IMP method_imp æŒ‡å‘äº†æ–¹æ³•çš„å®ç°ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ ç®€è¨€ä¹‹ï¼ŒMethod = SEL + IMP + method_typesï¼Œç›¸å½“äºåœ¨SELå’ŒIMPä¹‹é—´å»ºç«‹äº†ä¸€ä¸ªæ˜ å°„ã€‚ åœ¨è¿™ä¸ªç»“æ„ä½“ä¸­ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†SELå’ŒIMPï¼Œè¯´æ˜SELå’ŒIMPå…¶å®éƒ½æ˜¯Methodçš„å±æ€§ã€‚ æ“ä½œå‡½æ•° 1234567891011121314151617181920212223242526// è°ƒç”¨æŒ‡å®šæ–¹æ³•çš„å®ç°ï¼Œè¿”å›çš„æ˜¯æ–¹æ³•å®ç°æ—¶çš„è¿”å›ï¼Œå‚æ•°receiverä¸èƒ½ä¸ºç©ºï¼Œè¿™ä¸ªæ¯”method_getImplementationå’Œmethod_getNameå¿«id method_invoke ( id receiver, Method m, ... );// è°ƒç”¨è¿”å›ä¸€ä¸ªæ•°æ®ç»“æ„çš„æ–¹æ³•çš„å®ç°void method_invoke_stret ( id receiver, Method m, ... );// è·å–æ–¹æ³•åï¼Œå¸Œæœ›è·å¾—æ–¹æ³•æ˜çš„Cå­—ç¬¦ä¸²ï¼Œä½¿ç”¨sel_getName(method_getName(method))SEL method_getName ( Method m );// è¿”å›æ–¹æ³•çš„å®ç°IMP method_getImplementation ( Method m );// è·å–æè¿°æ–¹æ³•å‚æ•°å’Œè¿”å›å€¼ç±»å‹çš„å­—ç¬¦ä¸²const char * method_getTypeEncoding ( Method m );// è·å–æ–¹æ³•çš„è¿”å›å€¼ç±»å‹çš„å­—ç¬¦ä¸²char * method_copyReturnType ( Method m );// è·å–æ–¹æ³•çš„æŒ‡å®šä½ç½®å‚æ•°çš„ç±»å‹å­—ç¬¦ä¸²char * method_copyArgumentType ( Method m, unsigned int index );// é€šè¿‡å¼•ç”¨è¿”å›æ–¹æ³•çš„è¿”å›å€¼ç±»å‹å­—ç¬¦ä¸²void method_getReturnType ( Method m, char *dst, size_t dst_len );// è¿”å›æ–¹æ³•çš„å‚æ•°çš„ä¸ªæ•°unsigned int method_getNumberOfArguments ( Method m );// é€šè¿‡å¼•ç”¨è¿”å›æ–¹æ³•æŒ‡å®šä½ç½®å‚æ•°çš„ç±»å‹å­—ç¬¦ä¸²void method_getArgumentType ( Method m, unsigned int index, char *dst, size_t dst_len );// è¿”å›æŒ‡å®šæ–¹æ³•çš„æ–¹æ³•æè¿°ç»“æ„ä½“struct objc_method_description * method_getDescription ( Method m );// è®¾ç½®æ–¹æ³•çš„å®ç°IMP method_setImplementation ( Method m, IMP imp );// äº¤æ¢ä¸¤ä¸ªæ–¹æ³•çš„å®ç°void method_exchangeImplementations ( Method m1, Method m2 ); æ–¹æ³•åˆ—è¡¨(objc_method_list)æ–¹æ³•è°ƒç”¨æ˜¯é€šè¿‡æŸ¥è¯¢å¯¹è±¡çš„isaæŒ‡é’ˆæ‰€æŒ‡å‘å½’å±ç±»ä¸­çš„methodListsæ¥å®Œæˆã€‚ 12345678910struct objc_method_list &#123;struct objc_method_list * _Nullable obsolete OBJC2_UNAVAILABLE;int method_count OBJC2_UNAVAILABLE;#ifdef __LP64__int space OBJC2_UNAVAILABLE;#endif/* variable length structure */struct objc_method method_list[1] OBJC2_UNAVAILABLE;&#125; æ“ä½œå‡½æ•° 123456789101112131415161718192021// æ·»åŠ æ–¹æ³•BOOL class_addMethod ( Class cls, SEL name, IMP imp, const char *types ); //å’Œæˆå‘˜å˜é‡ä¸åŒçš„æ˜¯å¯ä»¥ä¸ºç±»åŠ¨æ€æ·»åŠ æ–¹æ³•ã€‚å¦‚æœæœ‰åŒåä¼šè¿”å›NOï¼Œä¿®æ”¹çš„è¯éœ€è¦ä½¿ç”¨method_setImplementation// è·å–å®ä¾‹æ–¹æ³•Method class_getInstanceMethod ( Class cls, SEL name );// è·å–ç±»æ–¹æ³•Method class_getClassMethod ( Class cls, SEL name );// è·å–æ‰€æœ‰æ–¹æ³•çš„æ•°ç»„Method * class_copyMethodList ( Class cls, unsigned int *outCount );// æ›¿ä»£æ–¹æ³•çš„å®ç°IMP class_replaceMethod ( Class cls, SEL name, IMP imp, const char *types );// è¿”å›æ–¹æ³•çš„å…·ä½“å®ç°IMP class_getMethodImplementation ( Class cls, SEL name );IMP class_getMethodImplementation_stret ( Class cls, SEL name );// ç±»å®ä¾‹æ˜¯å¦å“åº”æŒ‡å®šçš„selectorBOOL class_respondsToSelector ( Class cls, SEL sel ); SEL(objc_selector)123Objc.h/// An opaque type that represents a method selector.ä»£è¡¨ä¸€ä¸ªæ–¹æ³•çš„ä¸é€æ˜ç±»å‹typedef struct objc_selector *SEL; objc_msgSendå‡½æ•°ç¬¬äºŒä¸ªå‚æ•°ç±»å‹ä¸ºSELï¼Œå®ƒæ˜¯selectoråœ¨Objective-Cä¸­çš„è¡¨ç¤ºç±»å‹ï¼ˆSwiftä¸­æ˜¯Selectorç±»ï¼‰ã€‚selectoræ˜¯æ–¹æ³•é€‰æ‹©å™¨ï¼Œå¯ä»¥ç†è§£ä¸ºåŒºåˆ†æ–¹æ³•çš„ IDï¼Œè€Œè¿™ä¸ª ID çš„æ•°æ®ç»“æ„æ˜¯SEL:1@property SEL selector; å¯ä»¥çœ‹åˆ°selectoræ˜¯SELçš„ä¸€ä¸ªå®ä¾‹ã€‚ 1A method selector is a C string that has been registered (or â€œmappedâ€œ) with the Objective-C runtime. Selectors generated by the compiler are automatically mapped by the runtime when the class is loaded. å…¶å®selectorå°±æ˜¯ä¸ªæ˜ å°„åˆ°æ–¹æ³•çš„Cå­—ç¬¦ä¸²ï¼Œä½ å¯ä»¥ç”¨ Objective-C ç¼–è¯‘å™¨å‘½ä»¤@selector()æˆ–è€… Runtime ç³»ç»Ÿçš„sel_registerNameå‡½æ•°æ¥è·å¾—ä¸€ä¸ª SEL ç±»å‹çš„æ–¹æ³•é€‰æ‹©å™¨ã€‚ selectoræ—¢ç„¶æ˜¯ä¸€ä¸ªstringï¼Œæˆ‘è§‰å¾—åº”è¯¥æ˜¯ç±»ä¼¼className+methodçš„ç»„åˆï¼Œå‘½åè§„åˆ™æœ‰ä¸¤æ¡ï¼š åŒä¸€ä¸ªç±»ï¼Œselectorä¸èƒ½é‡å¤ ä¸åŒçš„ç±»ï¼Œselectorå¯ä»¥é‡å¤ è¿™ä¹Ÿå¸¦æ¥äº†ä¸€ä¸ªå¼Šç«¯ï¼Œæˆ‘ä»¬åœ¨å†™Cä»£ç çš„æ—¶å€™ï¼Œç»å¸¸ä¼šç”¨åˆ°å‡½æ•°é‡è½½ï¼Œå°±æ˜¯å‡½æ•°åç›¸åŒï¼Œå‚æ•°ä¸åŒï¼Œä½†æ˜¯è¿™åœ¨Objective-Cä¸­æ˜¯è¡Œä¸é€šçš„ï¼Œå› ä¸ºselectoråªè®°äº†methodçš„nameï¼Œæ²¡æœ‰å‚æ•°ï¼Œæ‰€ä»¥æ²¡æ³•åŒºåˆ†ä¸åŒçš„methodã€‚ æ“ä½œå‡½æ•° 12345678// è¿”å›ç»™å®šé€‰æ‹©å™¨æŒ‡å®šçš„æ–¹æ³•çš„åç§°const char * sel_getName ( SEL sel );// åœ¨Objective-C Runtimeç³»ç»Ÿä¸­æ³¨å†Œä¸€ä¸ªæ–¹æ³•ï¼Œå°†æ–¹æ³•åæ˜ å°„åˆ°ä¸€ä¸ªé€‰æ‹©å™¨ï¼Œå¹¶è¿”å›è¿™ä¸ªé€‰æ‹©å™¨SEL sel_registerName ( const char *str );// åœ¨Objective-C Runtimeç³»ç»Ÿä¸­æ³¨å†Œä¸€ä¸ªæ–¹æ³•SEL sel_getUid ( const char *str );// æ¯”è¾ƒä¸¤ä¸ªé€‰æ‹©å™¨BOOL sel_isEqual ( SEL lhs, SEL rhs ); IMP123/// A pointer to the function of a method implementation. æŒ‡å‘ä¸€ä¸ªæ–¹æ³•å®ç°çš„æŒ‡é’ˆtypedef id (*IMP)(id, SEL, ...); #endif å°±æ˜¯æŒ‡å‘æœ€ç»ˆå®ç°ç¨‹åºçš„å†…å­˜åœ°å€çš„æŒ‡é’ˆã€‚ åœ¨iOSçš„Runtimeä¸­ï¼ŒMethodé€šè¿‡selectorå’ŒIMPä¸¤ä¸ªå±æ€§ï¼Œå®ç°äº†å¿«é€ŸæŸ¥è¯¢æ–¹æ³•åŠå®ç°ï¼Œç›¸å¯¹æé«˜äº†æ€§èƒ½ï¼Œåˆä¿æŒäº†çµæ´»æ€§ã€‚ ç±»ç¼“å­˜(objc_cache)å½“Objective-Cè¿è¡Œæ—¶é€šè¿‡è·Ÿè¸ªå®ƒçš„isaæŒ‡é’ˆæ£€æŸ¥å¯¹è±¡æ—¶ï¼Œå®ƒå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå®ç°è®¸å¤šæ–¹æ³•çš„å¯¹è±¡ã€‚ç„¶è€Œï¼Œä½ å¯èƒ½åªè°ƒç”¨å®ƒä»¬çš„ä¸€å°éƒ¨åˆ†ï¼Œå¹¶ä¸”æ¯æ¬¡æŸ¥æ‰¾æ—¶ï¼Œæœç´¢æ‰€æœ‰é€‰æ‹©å™¨çš„ç±»åˆ†æ´¾è¡¨æ²¡æœ‰æ„ä¹‰ã€‚æ‰€ä»¥ç±»å®ç°ä¸€ä¸ªç¼“å­˜ï¼Œæ¯å½“ä½ æœç´¢ä¸€ä¸ªç±»åˆ†æ´¾è¡¨ï¼Œå¹¶æ‰¾åˆ°ç›¸åº”çš„é€‰æ‹©å™¨ï¼Œå®ƒæŠŠå®ƒæ”¾å…¥å®ƒçš„ç¼“å­˜ã€‚æ‰€ä»¥å½“objc_msgSendæŸ¥æ‰¾ä¸€ä¸ªç±»çš„é€‰æ‹©å™¨ï¼Œå®ƒé¦–å…ˆæœç´¢ç±»ç¼“å­˜ã€‚è¿™æ˜¯åŸºäºè¿™æ ·çš„ç†è®ºï¼šå¦‚æœä½ åœ¨ç±»ä¸Šè°ƒç”¨ä¸€ä¸ªæ¶ˆæ¯ï¼Œä½ å¯èƒ½ä»¥åå†æ¬¡è°ƒç”¨è¯¥æ¶ˆæ¯ã€‚ ä¸ºäº†åŠ é€Ÿæ¶ˆæ¯åˆ†å‘ï¼Œ ç³»ç»Ÿä¼šå¯¹æ–¹æ³•å’Œå¯¹åº”çš„åœ°å€è¿›è¡Œç¼“å­˜ï¼Œå°±æ”¾åœ¨ä¸Šè¿°çš„objc_cacheï¼Œæ‰€ä»¥åœ¨å®é™…è¿è¡Œä¸­ï¼Œå¤§éƒ¨åˆ†å¸¸ç”¨çš„æ–¹æ³•éƒ½æ˜¯ä¼šè¢«ç¼“å­˜èµ·æ¥çš„ï¼ŒRuntimeç³»ç»Ÿå®é™…ä¸Šéå¸¸å¿«ï¼Œæ¥è¿‘ç›´æ¥æ‰§è¡Œå†…å­˜åœ°å€çš„ç¨‹åºé€Ÿåº¦ã€‚ Category(objc_category)Categoryæ˜¯è¡¨ç¤ºä¸€ä¸ªæŒ‡å‘åˆ†ç±»çš„ç»“æ„ä½“çš„æŒ‡é’ˆï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š 12345678struct category_t &#123; const char *name; classref_t cls; struct method_list_t *instanceMethods; struct method_list_t *classMethods;struct protocol_list_t *protocols;struct property_list_t *instanceProperties;&#125;; nameï¼šæ˜¯æŒ‡ class_name è€Œä¸æ˜¯ category_nameã€‚ clsï¼šè¦æ‰©å±•çš„ç±»å¯¹è±¡ï¼Œç¼–è¯‘æœŸé—´æ˜¯ä¸ä¼šå®šä¹‰çš„ï¼Œè€Œæ˜¯åœ¨Runtimeé˜¶æ®µé€šè¿‡nameå¯¹ åº”åˆ°å¯¹åº”çš„ç±»å¯¹è±¡ã€‚ instanceMethodsï¼šcategoryä¸­æ‰€æœ‰ç»™ç±»æ·»åŠ çš„å®ä¾‹æ–¹æ³•çš„åˆ—è¡¨ã€‚ classMethodsï¼šcategoryä¸­æ‰€æœ‰æ·»åŠ çš„ç±»æ–¹æ³•çš„åˆ—è¡¨ã€‚ protocolsï¼šcategoryå®ç°çš„æ‰€æœ‰åè®®çš„åˆ—è¡¨ã€‚ instancePropertiesï¼šè¡¨ç¤ºCategoryé‡Œæ‰€æœ‰çš„propertiesï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡objc_setAssociatedObjectå’Œobjc_getAssociatedObjectå¢åŠ å®ä¾‹å˜é‡çš„åŸå› ï¼Œä¸è¿‡è¿™ä¸ªå’Œä¸€èˆ¬çš„å®ä¾‹å˜é‡æ˜¯ä¸ä¸€æ ·çš„ã€‚ ä»ä¸Šé¢çš„category_tçš„ç»“æ„ä½“ä¸­å¯ä»¥çœ‹å‡ºï¼Œåˆ†ç±»ä¸­å¯ä»¥æ·»åŠ å®ä¾‹æ–¹æ³•ï¼Œç±»æ–¹æ³•ï¼Œç”šè‡³å¯ä»¥å®ç°åè®®ï¼Œæ·»åŠ å±æ€§ï¼Œä¸å¯ä»¥æ·»åŠ æˆå‘˜å˜é‡ã€‚ Runtimeæ¶ˆæ¯è½¬å‘å‰æ–‡ä»‹ç»äº†è¿›è¡Œä¸€æ¬¡å‘é€æ¶ˆæ¯ä¼šåœ¨ç›¸å…³çš„ç±»å¯¹è±¡ä¸­æœç´¢æ–¹æ³•åˆ—è¡¨ï¼Œå¦‚æœæ‰¾ä¸åˆ°åˆ™ä¼šæ²¿ç€ç»§æ‰¿æ ‘å‘ä¸Šä¸€ç›´æœç´¢çŸ¥é“ç»§æ‰¿æ ‘æ ¹éƒ¨ï¼ˆé€šå¸¸ä¸ºNSObjectï¼‰ï¼Œå¦‚æœè¿˜æ˜¯æ‰¾ä¸åˆ°å¹¶ä¸”æ¶ˆæ¯è½¬å‘éƒ½å¤±è´¥äº†å°±å›æ‰§è¡ŒdoesNotRecognizeSelector:æ–¹æ³•æŠ¥unrecognized selectoré”™ã€‚é‚£ä¹ˆæ¶ˆæ¯è½¬å‘åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ¥ä¸‹æ¥å°†ä¼šé€ä¸€ä»‹ç»æœ€åçš„ä¸‰æ¬¡æœºä¼šã€‚ åŠ¨æ€æ–¹æ³•è§£æ å¤‡ç”¨æ¥æ”¶è€… å®Œæ•´æ¶ˆæ¯è½¬å‘ åŠ¨æ€æ–¹æ³•è§£æé¦–å…ˆï¼ŒObjective-Cè¿è¡Œæ—¶ä¼šè°ƒç”¨ +resolveInstanceMethod:æˆ–è€… +resolveClassMethod:ï¼Œè®©ä½ æœ‰æœºä¼šæä¾›ä¸€ä¸ªå‡½æ•°å®ç°ã€‚å¦‚æœä½ æ·»åŠ äº†å‡½æ•°å¹¶è¿”å›YESï¼Œ é‚£è¿è¡Œæ—¶ç³»ç»Ÿå°±ä¼šé‡æ–°å¯åŠ¨ä¸€æ¬¡æ¶ˆæ¯å‘é€çš„è¿‡ç¨‹ã€‚ å®ç°ä¸€ä¸ªåŠ¨æ€æ–¹æ³•è§£æçš„ä¾‹å­å¦‚ä¸‹ï¼š 123456789101112131415161718- (void)viewDidLoad &#123;[super viewDidLoad];// Do any additional setup after loading the view, typically from a nib.//æ‰§è¡Œfooå‡½æ•°[self performSelector:@selector(foo:)];&#125;+ (BOOL)resolveInstanceMethod:(SEL)sel &#123;if (sel == @selector(foo:)) &#123;//å¦‚æœæ˜¯æ‰§è¡Œfooå‡½æ•°ï¼Œå°±åŠ¨æ€è§£æï¼ŒæŒ‡å®šæ–°çš„IMPclass_addMethod([self class], sel, (IMP)fooMethod, &quot;v@:&quot;);return YES;&#125;return [super resolveInstanceMethod:sel];&#125;void fooMethod(id obj, SEL _cmd) &#123;NSLog(@&quot;Doing foo&quot;);//æ–°çš„fooå‡½æ•°&#125; æ‰“å°ç»“æœï¼š2018-04-01 12:23:35.952670+0800 ocram[87546:23235469] Doing foo å¯ä»¥çœ‹åˆ°è™½ç„¶æ²¡æœ‰å®ç°foo:è¿™ä¸ªå‡½æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬é€šè¿‡class_addMethodåŠ¨æ€æ·»åŠ fooMethodå‡½æ•°ï¼Œå¹¶æ‰§è¡ŒfooMethodè¿™ä¸ªå‡½æ•°çš„IMPã€‚ä»æ‰“å°ç»“æœçœ‹ï¼ŒæˆåŠŸå®ç°äº†ã€‚å¦‚æœresolveæ–¹æ³•è¿”å› NO ï¼Œè¿è¡Œæ—¶å°±ä¼šç§»åˆ°ä¸‹ä¸€æ­¥ï¼šforwardingTargetForSelectorã€‚ å¤‡ç”¨æ¥æ”¶è€…å¦‚æœç›®æ ‡å¯¹è±¡å®ç°äº†-forwardingTargetForSelector:ï¼ŒRuntime è¿™æ—¶å°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œç»™ä½ æŠŠè¿™ä¸ªæ¶ˆæ¯è½¬å‘ç»™å…¶ä»–å¯¹è±¡çš„æœºä¼šã€‚ å®ç°ä¸€ä¸ªå¤‡ç”¨æ¥æ”¶è€…çš„ä¾‹å­å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041#import &quot;ViewController.h&quot;#import &quot;objc/runtime.h&quot;@interface Person: NSObject@end@implementation Person- (void)foo &#123;NSLog(@&quot;Doing foo&quot;);//Personçš„fooå‡½æ•°&#125;@end@interface ViewController ()@end@implementation ViewController- (void)viewDidLoad &#123;[super viewDidLoad];// Do any additional setup after loading the view, typically from a nib.//æ‰§è¡Œfooå‡½æ•°[self performSelector:@selector(foo)];&#125;+ (BOOL)resolveInstanceMethod:(SEL)sel &#123;return YES;//è¿”å›YESï¼Œè¿›å…¥ä¸‹ä¸€æ­¥è½¬å‘&#125;- (id)forwardingTargetForSelector:(SEL)aSelector &#123;if (aSelector == @selector(foo)) &#123;return [Person new];//è¿”å›Personå¯¹è±¡ï¼Œè®©Personå¯¹è±¡æ¥æ”¶è¿™ä¸ªæ¶ˆæ¯&#125;return [super forwardingTargetForSelector:aSelector];&#125;@end æ‰“å°ç»“æœï¼š2018-04-01 12:45:04.757929+0800 ocram[88023:23260346] Doing foo å¯ä»¥çœ‹åˆ°æˆ‘ä»¬é€šè¿‡forwardingTargetForSelectoræŠŠå½“å‰ViewControllerçš„æ–¹æ³•è½¬å‘ç»™äº†Personå»æ‰§è¡Œäº†ã€‚æ‰“å°ç»“æœä¹Ÿè¯æ˜æˆ‘ä»¬æˆåŠŸå®ç°äº†è½¬å‘ã€‚ å®Œæ•´æ¶ˆæ¯è½¬å‘å¦‚æœåœ¨ä¸Šä¸€æ­¥è¿˜ä¸èƒ½å¤„ç†æœªçŸ¥æ¶ˆæ¯ï¼Œåˆ™å”¯ä¸€èƒ½åšçš„å°±æ˜¯å¯ç”¨å®Œæ•´çš„æ¶ˆæ¯è½¬å‘æœºåˆ¶äº†ã€‚é¦–å…ˆå®ƒä¼šå‘é€-methodSignatureForSelector:æ¶ˆæ¯è·å¾—å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ç±»å‹ã€‚å¦‚æœ-methodSignatureForSelector:è¿”å›nil ï¼ŒRuntimeåˆ™ä¼šå‘å‡º -doesNotRecognizeSelector: æ¶ˆæ¯ï¼Œç¨‹åºè¿™æ—¶ä¹Ÿå°±æŒ‚æ‰äº†ã€‚å¦‚æœè¿”å›äº†ä¸€ä¸ªå‡½æ•°ç­¾åï¼ŒRuntimeå°±ä¼šåˆ›å»ºä¸€ä¸ªNSInvocation å¯¹è±¡å¹¶å‘é€ -forwardInvocation:æ¶ˆæ¯ç»™ç›®æ ‡å¯¹è±¡ã€‚ å®ç°ä¸€ä¸ªå®Œæ•´è½¬å‘çš„ä¾‹å­å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758#import &quot;ViewController.h&quot;#import &quot;objc/runtime.h&quot;@interface Person: NSObject@end@implementation Person- (void)foo &#123;NSLog(@&quot;Doing foo&quot;);//Personçš„fooå‡½æ•°&#125;@end@interface ViewController ()@end@implementation ViewController- (void)viewDidLoad &#123;[super viewDidLoad];// Do any additional setup after loading the view, typically from a nib.//æ‰§è¡Œfooå‡½æ•°[self performSelector:@selector(foo)];&#125;+ (BOOL)resolveInstanceMethod:(SEL)sel &#123;return YES;//è¿”å›YESï¼Œè¿›å…¥ä¸‹ä¸€æ­¥è½¬å‘&#125;- (id)forwardingTargetForSelector:(SEL)aSelector &#123;return nil;//è¿”å›nilï¼Œè¿›å…¥ä¸‹ä¸€æ­¥è½¬å‘&#125;- (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector &#123;if ([NSStringFromSelector(aSelector) isEqualToString:@&quot;foo&quot;]) &#123;return [NSMethodSignature signatureWithObjCTypes:&quot;v@:&quot;];//ç­¾åï¼Œè¿›å…¥forwardInvocation&#125;return [super methodSignatureForSelector:aSelector];&#125;- (void)forwardInvocation:(NSInvocation *)anInvocation &#123;SEL sel = anInvocation.selector;Person *p = [Person new];if([p respondsToSelector:sel]) &#123;[anInvocation invokeWithTarget:p];&#125;else &#123;[self doesNotRecognizeSelector:sel];&#125;&#125;@end æ‰“å°ç»“æœï¼š2018-04-01 13:00:45.423385+0800 ocram[88353:23279961] Doing foo ä»æ‰“å°ç»“æœæ¥çœ‹ï¼Œæˆ‘ä»¬å®ç°äº†å®Œæ•´çš„è½¬å‘ã€‚é€šè¿‡ç­¾åï¼ŒRuntimeç”Ÿæˆäº†ä¸€ä¸ªå¯¹è±¡anInvocationï¼Œå‘é€ç»™äº†forwardInvocationï¼Œæˆ‘ä»¬åœ¨forwardInvocationæ–¹æ³•é‡Œé¢è®©Personå¯¹è±¡å»æ‰§è¡Œäº†fooå‡½æ•°ã€‚","categories":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/categories/iOS/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/tags/iOS/"}]},{"title":"ã€ŠEffective Objective-C 2.0ã€‹è¯»ä¹¦æ€»ç»“","slug":"ã€ŠEffective Objective-C 2.0ã€‹è¯»ä¹¦æ€»ç»“","date":"2019-04-23T09:17:43.000Z","updated":"2019-04-24T09:12:31.717Z","comments":true,"path":"2019/04/23/ã€ŠEffective Objective-C 2.0ã€‹è¯»ä¹¦æ€»ç»“/","link":"","permalink":"https://bigporo.github.io/2019/04/23/ã€ŠEffective Objective-C 2.0ã€‹è¯»ä¹¦æ€»ç»“/","excerpt":"Objective-Cäº†è§£ Objective-C è¯­è¨€çš„èµ·æºObjective-C è¯­è¨€ä½¿ç”¨â€æ¶ˆæ¯ç»“æ„â€è€Œéâ€å‡½æ•°è°ƒç”¨â€.Objective-C è¯­è¨€ç”± SmallTalkæ¼”åŒ–è€Œæ¥,åè€…æ˜¯æ¶ˆæ¯ç±»å‹è¯­è¨€çš„é¼»ç¥–.ç¼–è¯‘å™¨ç”šè‡³ä¸å…³å¿ƒæ¥æ”¶æ¶ˆæ¯å¯¹è±¡çš„ä½•ç§ç±»å‹.æ¥æ”¶æ¶ˆæ¯çš„å¯¹è±¡é—®é¢˜ä¹Ÿè¦åœ¨è¿è¡Œæ—¶å¤„ç†,å…¶è¿‡ç¨‹å«åšâ€åŠ¨æ€ç»‘å®šâ€. Objective-Cä¸º C è¯­è¨€æ·»åŠ äº†é¢å‘å¯¹è±¡ç‰¹æ€§,æ˜¯å…¶è¶…ç±». Objective-C ä½¿ç”¨åŠ¨æ€ç»‘å®šçš„æ¶ˆæ¯ç»“æ„,ä¹Ÿå°±æ˜¯è¯´,åœ¨è¿è¡Œæ—¶æ‰ä¼šæ£€æŸ¥å¯¹è±¡ç±»å‹.æ¥æ”¶ä¸€æ¡æ¶ˆæ¯å,ç©¶ç«Ÿåº”æ‰§è¡Œä½•ç§ä»£ç ,æœ‰è¿è¡ŒæœŸç¯å¢ƒè€Œéç¼–è¯‘å™¨å†³å®š.ç†è§£ C è¯­è¨€çš„æ ¸å¿ƒæœ‰åŠ©äºå†™å¥½ Objective-C ç¨‹åº.å°¤å…¶æ˜¯æŒæ¡å†…å­˜æ¨¡å‹ä¸æŒ‡é’ˆ.","text":"Objective-Cäº†è§£ Objective-C è¯­è¨€çš„èµ·æºObjective-C è¯­è¨€ä½¿ç”¨â€æ¶ˆæ¯ç»“æ„â€è€Œéâ€å‡½æ•°è°ƒç”¨â€.Objective-C è¯­è¨€ç”± SmallTalkæ¼”åŒ–è€Œæ¥,åè€…æ˜¯æ¶ˆæ¯ç±»å‹è¯­è¨€çš„é¼»ç¥–.ç¼–è¯‘å™¨ç”šè‡³ä¸å…³å¿ƒæ¥æ”¶æ¶ˆæ¯å¯¹è±¡çš„ä½•ç§ç±»å‹.æ¥æ”¶æ¶ˆæ¯çš„å¯¹è±¡é—®é¢˜ä¹Ÿè¦åœ¨è¿è¡Œæ—¶å¤„ç†,å…¶è¿‡ç¨‹å«åšâ€åŠ¨æ€ç»‘å®šâ€. Objective-Cä¸º C è¯­è¨€æ·»åŠ äº†é¢å‘å¯¹è±¡ç‰¹æ€§,æ˜¯å…¶è¶…ç±». Objective-C ä½¿ç”¨åŠ¨æ€ç»‘å®šçš„æ¶ˆæ¯ç»“æ„,ä¹Ÿå°±æ˜¯è¯´,åœ¨è¿è¡Œæ—¶æ‰ä¼šæ£€æŸ¥å¯¹è±¡ç±»å‹.æ¥æ”¶ä¸€æ¡æ¶ˆæ¯å,ç©¶ç«Ÿåº”æ‰§è¡Œä½•ç§ä»£ç ,æœ‰è¿è¡ŒæœŸç¯å¢ƒè€Œéç¼–è¯‘å™¨å†³å®š.ç†è§£ C è¯­è¨€çš„æ ¸å¿ƒæœ‰åŠ©äºå†™å¥½ Objective-C ç¨‹åº.å°¤å…¶æ˜¯æŒæ¡å†…å­˜æ¨¡å‹ä¸æŒ‡é’ˆ. åœ¨ç±»çš„å¤´æ–‡ä»¶ä¸­å°½é‡å°‘å¼•ç”¨å…¶ä»–å¤´æ–‡ä»¶Objective-C è¯­è¨€ç¼–å†™ç±»çš„æ ‡å‡†è¡Œä¸º:ä»¥ç±»ååšæ–‡ä»¶å,åˆ†åˆ«é—¯å°†ä¸¤ä¸ªæ–‡ä»¶,æœ‰æ–‡ä»¶åç¼€ç”¨. h,å®ç°æ–‡ä»¶åç¼€ç”¨. m. åœ¨å¼€å‘ä¸­æœ‰æ—¶å€™æˆ‘ä»¬ä¼šåœ¨. h æ–‡ä»¶ä¸­å¼•å…¥å¾ˆå¤šç”¨ä¸åˆ°çš„å†…å®¹,è¿™å½“ç„¶ä¼šå¢åŠ ç¼–è¯‘æ—¶é—´.é™¤éæœ‰å¿…è¦,å¦åˆ™ä¸è¦å¼•å…¥å¤´æ–‡ä»¶,ä¸€èˆ¬æ¥è¯´,æŸä¸ªç±»çš„å¤´æ–‡ä»¶ä¸­ä½¿ç”¨å‘å‰å£°æ˜æ¥ä½“ç§¯åˆ«çš„ç±»,å¹¶åœ¨å®ç°æ–‡ä»¶ä¸­å¼•å…¥å“ªäº›ç±»çš„å¤´æ–‡ä»¶,è¿™æ ·åšå¯ä»¥å°½é‡é™ä½ç±»ä¹‹é—´çš„è€¦åˆ.æœ‰æ—¶æ— æ³•ä½¿ç”¨å‘å‰å£°æ˜,æ¯”å¦‚è¦å£°æ˜æŸä¸ªç±»éµå¾ªæ„å‘åè®®,è¿™ç§æƒ…å†µä¸‹,å°½é‡æŠŠ â€œè¯¥ç±»éµå¾ªæŸåè®®â€çš„è¿™æ¡å£°æ˜ç§»è‡³ class=continuation åˆ†ç±»ä¸­,å¦‚æœä¸è¡Œçš„è¯,å°±æŠŠåè®®å•ç‹¬å­˜æ”¾åœ¨ä¸€ä¸ªå¤´æ–‡ä»¶ä¸­,ç„¶åå°†å…¶å¼•å…¥. å¤šç”¨å­—é¢é‡è¯­æ³•,å°‘ç”¨ä¸ä¹‹ç­‰ä»·çš„æ–¹æ³•12NSArray *arr = [NSArray arrayWithObjects:@&quot;num1&quot;,@&quot;num2&quot;,@&quot;num3&quot;, nil];NSArray *arr = @[@&quot;num1&quot;,@&quot;num2&quot;,@&quot;num3â€]; å­—é¢é‡è¯­æ³•åˆ›å»ºå­—ç¬¦ä¸²,æ•°ç»„,æ•°å€¼,å­—å…¸.ä¸åˆ›å»ºæ­¤ç±»å¯¹è±¡çš„å¸¸è§„æ–¹æ³•ç›¸æ¯”,è¿™ä¹ˆåšæ›´åŠ ç®€æ˜æ‰¼è¦ï¼Œå¹¶ä¸”æ›´åŠ å®‰å…¨ã€‚ æ³¨æ„äº‹é¡¹: é™¤äº†å­—ç¬¦ä¸²ä»¥å¤–,æ‰€åˆ›å»ºçš„ç±»å¿…é¡»å±äº Foundation æ¡†æ¶æ‰è¡Œ,å¦‚æœè‡ªå®šä¹‰äº†è¿™äº›ç±»çš„å­ç±»,åˆ™æ— æ³•ç”¨å­—é¢é‡è¯­æ³•åˆ›å»ºå…¶å¯¹è±¡. åˆ›å»ºçš„æ•°ç»„æˆ–å­—å…¸æ—¶,è‹¥å€¼æœ‰ nil, åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸.å› æ­¤,åŠ¡å¿…ç¡®ä¿å€¼ä¸­ä¸å« nilã€‚ å¤šç”¨ç±»å‹å¸¸é‡,å°‘ç”¨# deine é¢„å¤„ç†æŒ‡ä»¤ä¸è¦ç”¨é¢„å¤„ç†æŒ‡ä»¤å®šä¹‰å¸¸é‡,è¿™æ ·å®šä¹‰å‡ºæ¥çš„å¸¸é‡ä¸å«ç±»å‹ä¿¡æ¯,ç¼–è¯‘å™¨åªä¼šåœ¨ç¼–è¯‘å‰æ ¹æ®æ‰§è¡ŒæŸ¥æ‰¾ä¸æ›¿æ¢æ“ä½œ,å³ä½¿æœ‰äººé‡æ–°å®šä¹‰äº†å¸¸é‡å€¼,ç¼–è¯‘å™¨ä¹Ÿä¸ä¼šäº§ç”Ÿäº•é“ä¿¡æ¯,è¿™å°†å¯¼è‡´åº”ç”¨ç¨‹åºå¸¸é‡å€¼ä¸ä¸€è‡´. 1static NSString *const PersonConstant = @&quot;PersonConstantStrâ€ ; ä½†æ˜¯æˆ‘ä¸ªäººè®¤ä¸ºå…¶å®,è¿˜æ˜¯#defineç”¨çš„å¤š, å¼€å‘é¿å…ä¸äº†ä½¿ç”¨ pchæ–‡ä»¶, åŒæ—¶#defineè¿˜å¯ä»¥å®šä¹‰æ–¹æ³•ï¼Œè¿™ä¸ªæ˜¯ç±»å‹å¸¸é‡æ— æ³•åšåˆ°çš„ã€‚ å¦‚æœæœ‰å¼ºè¿«ç—‡çš„åŒå­¦,å®šä¹‰å¸¸é‡å°±æƒ³ä½¿ç”¨ staitc,extren,const è¿™äº›å…³é”®å­—.é‚£æˆ‘å»ºè®®æ–°å»ºä¸€ä¸ªä¸“é—¨å­˜æ”¾è¿™äº›å¸¸é‡çš„ç±»,ç„¶ååœ¨ pch ä¸­å¯¼å…¥è¿™ä¸ªç±». static ä¿®é¥°ç¬¦æ„å‘³ç€è¯¥å˜é‡ä»…åœ¨å®šä¹‰æ­¤å˜é‡çš„å•å…ƒä¸­å¯è§ extern å…¨å±€å˜é‡ ç”¨æšä¸¾è¡¨ç¤ºçŠ¶æ€,é€‰é¡¹,çŠ¶æ€ç åº”è¯¥ç”¨æšä¸¾æ¥è¡¨ç¤ºçŠ¶æ€æœºçš„çŠ¶æ€,ä¼ é€’ç»™æ–¹æ³•çš„é€‰é¡¹ä»¥åŠçŠ¶æ€ç ç­‰å€¼,ç»™è¿™äº›å€¼èµ·ä¸ªæ˜“æ‡‚çš„åå­—ã€‚ å¦‚æœæŠŠä¼ é€’çš„ç»™æŸä¸ªæ–¹æ³•çš„é€‰é¡¹è¡¨ç¤ºä¸ºæšä¸¾ç±»å‹ï¼Œè€Œå¤šä¸ªç±»å‹åˆå¯åŒæ—¶ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±å°†å„é€‰é¡¹å€¼å®šä¹‰ä¸º2çš„å¹‚ï¼Œé€šè¿‡æŒ‰ä½æˆ–æ“ä½œå°†å…¶ç»“åˆèµ·æ¥ã€‚ 123456enum PersonEnum&#123;PersonEnumNum1,PersonEnumNum2,PersonEnumNum3,&#125;;typedef enum PersonEnum PersonState; å¯¹è±¡ã€æ¶ˆæ¯ã€è¿è¡Œæ—¶ç†è§£å±æ€§è¿™ä¸€æ¦‚å¿µå±æ€§æ˜¯ Objective-C çš„ä¸€é¡¹ç‰¹æ€§,ç”¨äºå°å­˜å¯¹è±¡ä¸­çš„æ•°æ®.å±æ€§ç‰¹è´¨:åŸå­æ€§ è¯»å†™æƒé™ å†…å­˜ç®¡ç†è¯­ä¹‰: assign è¿™æ˜¯æ–¹æ³•åªä¼šæ‰§è¡Œé’ˆå¯¹çº¯é‡ç±»å‹(CGFloat,NSInteger)çš„ç®€å•èµ‹å€¼æ“ä½œ strong æ­¤ç‰¹è´¨è¡¨æ˜è¯¥å±æ€§å®šä¹‰ä¸€ç§æ‹¥æœ‰å…³ç³»,ä¸ºè¿™ç§å±æ€§è®¾ç½®æ–°å€¼æ—¶,è¿™åªæ–¹æ³•ä¼šå…ˆä¿å­˜æ–°å€¼,å¹¶é‡Šæ”¾æ—§å€¼ weak æ­¤ç‰¹è´¨è¡¨æ˜å±æ€§å®šä¹‰äº†ä¸€ç§â€éæ‹¥æœ‰å…³ç³»â€,ä¸ºè¿™ç§å±æ€§è®¾ç½®æ–°å€¼æ˜¯,è®¾ç½®æ–¹æ³•æ—¢ä¸ä¿ç•™æ–°å€¼,ä¹Ÿä¸é‡Šæ”¾æ—§å€¼.æ­¤ç‰¹è´¨åŒ assign ç±»ä¼¼,ç„¶è€Œåœ¨å±æ€§æ‰€æŒ‡å¯¹è±¡é­åˆ°æ‘§æ¯æ—¶,å±æ€§å€¼ä¼šæ¸…ç©º unsafe_unretainde æ­¤ç‰¹è´¨ä¸ assign ç›¸åŒ,å®ƒé€‚ç”¨äºå¯¹è±¡ç±»å‹,è¯¥ç‰¹è´¨è¡¨è¾¾ä¸€ç§â€éæ‹¥æœ‰å…³ç³»â€,å½“ç›®æ ‡å¯¹è±¡é­åˆ°æ‘§æ¯æ—¶,å±æ€§ä¸ä¼šè‡ªåŠ¨æ¸…ç©º,å› ä¸ºå®ƒæ˜¯ä¸å®‰å…¨çš„,è¿™ä¸€ç‚¹ä¸ weak çš„åŒºåˆ« copy æ­¤ç‰¹è´¨æ‰€è¡¨è¾¾çš„æ‰€å±å…³ç³»ä¸ strong ç±»ä¼¼,ç„¶è€Œè®¾ç½®æ–¹æ³•å¹¶ä¸ä¿ç•™æ–°å€¼,è€Œæ˜¯å°†å…¶æ‹·è´,å¤šç”¨äº NSString. åœ¨å¯¹è±¡å†…éƒ¨å°½é‡ç›´æ¥è®¿é—®å®ä¾‹å˜é‡ç›´æ¥è®¿é—®å®ä¾‹å˜é‡çš„é€Ÿåº¦æ¯”è¾ƒå¿«,å› ä¸ºä¸ç»è¿‡ Objective-C æ–¹æ³•æ´¾å‘,ç¼–è¯‘å™¨æ‰€ç”Ÿæˆçš„ä»£ç ä¼šç›´æ¥è®¿é—®ä¿å­˜å‚¬ä¸‹å®ä¾‹é‡çš„é‚£å—å†…å­˜ã€‚ç›´æ¥è®¿é—®å®ä¾‹å˜é‡æ—¶,ä¸ä¼šè°ƒç”¨è®¾ç½®æ–¹æ³•,è¿™å°±ç»•è¿‡äº†ç›¸å…³å±æ€§æ‰€å®šä¹‰çš„å†…å­˜ç®¡ç†è¯­ä¹‰ã€‚ è¯»å–å®ä¾‹å˜é‡çš„æ—¶å€™é‡‡ç”¨ç›´æ¥è®¿é—®çš„çš„å½¢å¼ï¼Œè®¾ç½®å®ä¾‹å˜é‡çš„æ—¶å€™é€šè¿‡å±æ€§æ¥åšã€‚ æ³¨æ„ï¼š ç›´æ¥è®¿é—®è®¿é—®å®ä¾‹å˜é‡ï¼Œä¸ä¼šè§¦å‘KVOã€‚ æ‡’åŠ è½½æ—¶ï¼Œå¿…é¡»é€šè¿‡å±æ€§æ¥è¯»å–æ•°æ®ã€‚ ç†è§£â€å¯¹è±¡ç­‰åŒæ€§â€è¿™ä¸€æ¦‚å¿µæ ¹æ®ç­‰åŒæ€§æ¥æ¯”è¾ƒå¯¹è±¡æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½,ä¸è¿‡,æŒ‰ç…§ == æ“ä½œç¬¦æ¯”è¾ƒå‡ºæ¥çš„ç»“æœæœªå¿…æ˜¯æˆ‘ä»¬æƒ³è¦çš„,å› ä¸ºè¯¥æ“ä½œæ¯”è¾ƒçš„äº‹ä¸¤ä¸ªæŒ‡é’ˆæœ¬èº«,è€Œä¸æ˜¯å…¶æ‰€æŒ‡çš„å¯¹è±¡ï¼Œåº”è¯¥ä½¿ç”¨ NSObject åè®®ä¸­çš„å£°æ˜çš„â€isEqualâ€æ–¹æ³•æ¥åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„ç­‰åŒæ€§,ä¸€èˆ¬æ¥è¯´ä¸¤ä¸ªç±»å‹ä¸åŒçš„å¯¹è±¡æ€»æ˜¯ä¸ç›¸ç­‰çš„.ç›´æ¥æ¯”è¾ƒå­—ç¬¦ä¸²çš„æ—¶å€™ isEqual æ¯” isEqualToStringæ…¢,å› ä¸ºå‰è€…è¿˜è¦æ‰§è¡Œé¢å¤–æ­¥éª¤. NSObjecä¸­æœ‰ä¸¤ä¸ªåˆ¤æ–­ç­‰åŒæ€§çš„å…³é”®æ–¹æ³•:12- (BOOL) isEqual:(id)object;- (NSUInteger)hash; ä»¥â€ç±»æ—æ¨¡å¼â€éšè—å®ç°ç»†èŠ‚â€œç±»æ—â€æ˜¯ä¸€ç§å¾ˆæœ‰ç”¨çš„æ¨¡å¼,å¯ä»¥éšè—æŠ½è±¡åŸºç±»èƒŒåå®ç°çš„ç»†èŠ‚. è¿™æ˜¯ä¸€ç§â€å·¥å‚æ¨¡å¼â€.æ¯”å¦‚iOS ç”¨æˆ·ç•Œé¢æ¡†æ¶ UIKit ä¸­å°±æœ‰ä¸€ä¸ªåä¸º UIButton çš„ç±».æƒ³åˆ›å»ºæŒ‰é’®,éœ€è¦è°ƒç”¨ä¸‹é¢è¿™ä¸ªç±»æ–¹æ³•ã€‚1+ (UIButton*)buttonWithType:(UIButtonType)type; åœ¨æ—¢æœ‰ç±»ä¸­ä½¿ç”¨å…³è”å¯¹è±¡å­˜æ”¾è‡ªå®šä¹‰æ•°æ®æœ‰æ—¶éœ€è¦åœ¨å¯¹è±¡ä¸­å­˜æ”¾ç›¸å…³ä¿¡æ¯,è¿™æ˜¯æˆ‘ä»¬é€šå¸¸ä¼šä»å¯¹è±¡æ‰€å±çš„ç±»ä¸­ç»§æ‰¿ä¸€ä¸ªå­ç±»,ç„¶åæ”¹ç”¨è¿™ä¸ªå­ç±»å¯¹è±¡.ç„¶è€Œå¹¶éæ‰€æœ‰æƒ…å†µä¸‹éƒ½è¿™ä¹ˆåš,æœ‰æ—¶å€™ç±»çš„å®ä¾‹å¯èƒ½æ˜¯ç”±æŸç§æœºåˆ¶æ‰€åˆ›å»ºçš„,è€Œå¼€å‘è€…æ— æ³•ä»¤è¿™ç§æœºåˆ¶åˆ›å»ºå‡ºè‡ªå·±æ‰€å†™çš„å®ä¾‹. Objective-C ä¸­æœ‰ä¸€é¡¹å¼ºå¤§çš„ç‰¹æ€§å¯ä»¥è§£å†³é—®é¢˜,è¿™å°±æ˜¯å…³è”å¯¹è±¡ã€‚ 123456//å…³è”å¯¹è±¡void objc_setAssociatedObject(id object, const void *key, id value, objc_AssociationPolicy policy)//è·å–å…³è”çš„å¯¹è±¡id objc_getAssociatedObject(id object, const void *key)//ç§»é™¤å…³è”çš„å¯¹è±¡void objc_removeAssociatedObjects(id object) ç†è§£objc_msgSendçš„ä½œç”¨ç”¨Objetive-Cçš„æœ¯è¯­æ¥è¯´ï¼Œè¿™å«åšâ€œæ¶ˆæ¯ä¼ é€’â€ã€‚è¿™é‡Œè¯´çš„æ˜¯è¿è¡Œæ—¶ã€‚ ç†è§£æ¶ˆæ¯è½¬å‘æœºåˆ¶å½“å¯¹è±¡æ¥æ”¶åˆ°æ— æ³•è§£è¯»çš„æ¶ˆæ¯åï¼Œå°±ä¼šå¯åŠ¨æ¶ˆæ¯è½¬å‘æœºåˆ¶ï¼Œç¨‹åºå‘˜å¯ç»æ­¤è¿‡ç¨‹å‘Šè¯‰å¯¹è±¡åº”è¯¥å›¾å’Œå¤„ç†æœªçŸ¥æ¶ˆæ¯ã€‚è¿™é‡Œè¯´çš„æ˜¯è¿è¡Œæ—¶ã€‚ åŠ¨æ€æ–¹æ³•è§£æ 1234567891011+ (BOOL)resolveClassMethod:(SEL)sel&#123;/**åŠ¨æ€æ¶ˆæ¯è½¬å‘if (sel == @selector(foo:)) &#123;class_addMethod([self class], sel, (IMP)fooMethod, &quot;v@:&quot;);&#125;return [super resolveInstanceMethod:sel];*/return YES; // è¿›å…¥ä¸‹ä¸€æ­¥è½¬å‘&#125; å¤‡ç”¨æ¥æ”¶è€… 123456789101112- (id)forwardingTargetForSelector:(SEL)aSelector&#123;/**å¤‡ç”¨æ¥æ”¶è€…if (aSelector == @selector(foo)) &#123;return [Person new]; // è¿”å›ä¸€ä¸ªPersonå®ä¾‹ä½œä¸ºå¤‡ç”¨æ¥æ”¶è€…&#125;return [super forwardingTargetForSelector:aSelector];*/return nil; // è¿›å…¥ä¸‹ä¸€æ­¥è½¬å‘&#125; å®Œæ•´çš„æ¶ˆæ¯è½¬å‘ 12345678910111213141516171819- (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector&#123;if (aSelector == @selector(foo)) &#123;return [NSMethodSignature signatureWithObjCTypes:&quot;v@:&quot;];//ç­¾åï¼Œè¿›å…¥forwardInvocation&#125;return [super methodSignatureForSelector:aSelector];&#125;- (void)forwardInvocation:(NSInvocation *)anInvocation&#123;SEL sel = anInvocation.selector;Person *person = [Person new];if ([person respondsToSelector:sel]) &#123;[anInvocation invokeWithTarget:person]; // ç›´æ¥è°ƒç”¨ person çš„ foo æ–¹æ³•&#125;else&#123;[self doesNotRecognizeSelector:sel];&#125;&#125; ç”¨æ–¹æ³•è°ƒé…æŠ€æœ¯è°ƒè¯•é»‘ç›’æ–¹æ³•è¿è¡ŒæœŸé—´ï¼Œå¯ä»¥å‘ç±»ä¸­æ–°å¢æˆ–æ›¿æ¢é€‰æ‹©å­æ‰€å¯¹åº”çš„æ–¹æ³•å®ç°ã€‚ä½¿ç”¨å¦ä¸€ä»½å®ç°æ¥æ›¿æ¢åŸæœ‰çš„æ–¹æ³•å®ç°ï¼Œè¿™é“å·¥åºå«åšæ–¹æ³•è°ƒé…ï¼Œå¼€å‘è€…å¸¸ç”¨æ­¤æŠ€æœ¯æƒ³åŸæœ‰å®ç°ä¸­æ·»åŠ æ–°åŠŸèƒ½ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåªæœ‰è°ƒè¯•ç¨‹åºçš„æ—¶å€™æ‰éœ€è¦è¿è¡ŒæœŸä¿®æ”¹æ–¹æ³•å®ç°ï¼Œè¿™ç§åšæ³•ä¸æ˜“æ»¥ç”¨ã€‚è¿™é‡Œè¯´çš„æ˜¯æ–¹æ³•äº¤æ¢ã€‚ ç†è§£ç±»å¯¹è±¡çš„ç”¨æ„æ¯ä¸ªObjective-Cå¯¹è±¡å®ä¾‹éƒ½æ˜¯æŒ‡å‘æŸå—å†…å­˜æ•°æ®çš„æŒ‡é’ˆï¼Œå¦‚æœæŠŠå¯¹è±¡æ‰€éœ€çš„å†…å­˜åˆ†é…åˆ°æ ˆä¸Šç¼–è¯‘å™¨å°±ä¼šæŠ¥é”™. æ¯ä¸ªå¯¹è±¡ç»“æ„ä½“çš„é¦–ä¸ªæˆå‘˜æ˜¯Classç±»çš„å˜é‡ï¼Œè¯¥å˜é‡å®šä¹‰äº†å¯¹è±¡æ‰€å±çš„ç±»ï¼Œé€šå¸¸ç§°ä¸ºisaæŒ‡é’ˆã€‚ 12345678910111213typedef struct objc_class *classstruct objc_class&#123;Class isa;Class super_class;const char* name;long version;long info;long instance_size;struct objc_ivar_list *ivars;struct objc_method_list *ivars;struct objc_cache *cache;struct objc_protocol_list protocols;&#125; æ­¤ç»“æ„ä½“å­˜æ”¾ç±»çš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚ç±»çš„å®ä¾‹å®ç°äº†å‡ ä¸ªæ–¹æ³•ï¼Œå…·å¤‡å¤šå°‘ä¸ªå®ä¾‹å˜é‡ç­‰ä¿¡æ¯ã€‚æ­¤ç»“æ„ä½“çš„é¦–ä¸ªå˜é‡ä¹Ÿæ˜¯isaæŒ‡é’ˆï¼Œè¿™è¯´æ˜Classæœ¬èº«äº¦ä¸ºObjctive-Cå¯¹è±¡ã€‚ç»“æ„ä½“é‡Œè¿˜æœ‰ä¸ªå˜é‡å«åšsuper_class,å®ƒå®šä¹‰æœ¬ç±»çš„è¶…ç±»ï¼Œç±»å¯¹è±¡æ‰€å±çš„ç±»å‹ï¼ˆisaæŒ‡é’ˆæ‰€æŒ‡å‘çš„ç±»å‹ï¼‰æ˜¯å¦å¤–ä¸€ä¸ªç±»ï¼Œå«åšå…ƒç±»ï¼Œç”¨æ¥æ ‡ä¹¦ç±»æœ¬èº«æ‰€å…·å¤‡çš„å…ƒæ•°æ®ã€‚ç±»æ–¹æ³•å°±å®šä¹‰äºæ­¤å¤„ï¼Œå› ä¸ºè¿™äº›æ–¹æ³•å¯ä»¥ç†è§£æˆç±»å¯¹è±¡çš„å®ä¾‹æ–¹æ³•ï¼Œæ¯ä¸ªç±»ä»…æœ‰ä¸€ä¸ªç±»å¯¹è±¡ï¼Œæ¯ä¸ªç±»å¯¹è±¡ä»…æœ‰ä¸€ä¸ªä¸ä¹‹ç›¸å…³çš„å…ƒç±»ã€‚ï¼ˆå…ƒæ•°æ®ï¼Œå°±æ˜¯è¿™ä¸ªç±»çš„æ•°æ®ï¼‰ã€‚ isKindOfClassï¼šèƒ½å¤Ÿåˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºæŸç±»æˆ–å…¶æ´¾ç”Ÿç±»çš„å®ä¾‹ isMemberOfClass: èƒ½å¤Ÿåˆ¤æ–­å‡ºå¯¹è±¡æ˜¯å¦ä¸ºæŸä¸ªç‰¹å®šç±»çš„å®ä¾‹ æ¥å£è®¾è®¡ç”¨å‰ç¼€é¿å…å‘½åç©ºé—´å†²çªObjective-Cæ²¡æœ‰å…¶ä»–è¯­è¨€é‚£ç§å†…ç½®çš„å‘½åç©ºé—´ï¼Œæ‰€ä»¥éœ€è¦é¿å…å‘½åå†²çªï¼Œå¦åˆ™ä¼šç›´æ¥æŠ¥é”™ã€‚ æä¾›å…¨èƒ½åˆå§‹åŒ–æ–¹æ³•å³å¯ä»¥ä¸ºå¯¹è±¡æä¾›å¿…è¦ä¿¡æ¯ä»¥ä¾¿å…¶å®Œæˆèƒ½å®Œæˆå·¥ä½œçš„åˆå§‹åŒ–æ–¹æ³•ã€‚ æ³¨æ„ï¼šå¦‚æœå­ç±»çš„å…¨èƒ½åˆå§‹åŒ–æ–¹æ³•ä¸çˆ¶ç±»çš„ä¸ä¸€è‡´ï¼Œå°±åº”è¯¥è¦†å†™çˆ¶ç±»çš„å…¨èƒ½åˆå§‹åŒ–æ–¹æ³•ã€‚æœ‰æ—¶æˆ‘ä»¬ä¸æƒ³è¦†å†™ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥è¦†å†™çˆ¶ç±»çš„å…¨èƒ½åˆå§‹åŒ–æ–¹æ³•å¹¶åœ¨é‡Œé¢æŠ›å‡ºå¼‚å¸¸ã€‚ å®ç°descriptionæ–¹æ³•è°ƒè¯•ç¨‹åºæ—¶ç»å¸¸éœ€è¦æ‰“å°å¹¶æŸ¥çœ‹å¯¹è±¡ä¿¡æ¯ã€‚description å¾ˆå®ç”¨ã€‚ debugDescription æ–¹æ³•æ˜¯å¼€å‘è€…åœ¨è°ƒè¯•å™¨ä¸­ä»¥å‘½ä»¤æ‰“å°å¯¹è±¡æ—¶å€™æ‰è°ƒç”¨ã€‚12345678910111213141516171819Person.h#import &lt;Foundation/Foundation.h&gt;@interface Person : NSObject@property(nonatomic,assign)int age;@property(nonatomic ,copy)NSString* name;@endPerson.m#import &quot;Person.h&quot;@implementation Person- (NSString *)description&#123;return [NSString stringWithFormat:@&quot;name %@ , age %d&quot;, self.name, self.age];&#125;- (NSString *)debugDescription&#123;return [NSString stringWithFormat:@&quot;name %@ , age %d&quot;, self.name, self.age];&#125;@end å°½é‡ä½¿ç”¨ä¸å¯å˜å¯¹è±¡é€šè¿‡readonlyå°†å±æ€§ä¿®é¥°ä¸ºä¸å¯å˜ï¼Œå¦‚æœæƒ³ä¿®æ”¹å°è£…åœ¨å¯¹è±¡å†…éƒ¨çš„æ•°æ®ï¼Œå¯ä»¥åœ¨å¯¹è±¡çš„å†…éƒ¨å°†readonlyå±æ€§é‡æ–°å£°æ˜ä¸ºreadwriteã€‚ æ³¨æ„:readonlyä¿®é¥°çš„å±æ€§ï¼Œä»ç„¶å¯ä»¥ä½¿ç”¨KVCæ¥ä¿®æ”¹ã€‚ ä½¿ç”¨æ¸…æ™°è€Œåè°ƒçš„å…¨åæ–¹å¼æ²¡å•¥å¥½è¯´çš„ ä¸ºç§æœ‰æ–¹æ³•ååŠ å‰ç¼€ä¸è¦å•ç”¨ä¸€ä¸ªä¸‹åˆ’çº¿ç»™ç§æœ‰æ–¹æ³•åšå‰ç¼€ï¼Œè¿™ä¸ªæ˜¯è‹¹æœçˆ¸çˆ¸ç”¨çš„ã€‚ ç†è§£Objective-Cé”™è¯¯æ¨¡å‹NSErrorçš„ç”¨æ³•æ›´åŠ çµæ´»ï¼Œå› æ­¤ç»ç”±æ­¤å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå¯¼è‡´é”™è¯¯çš„åŸå› æ±‡æŠ¥ç»™è°ƒç”¨è€…ã€‚ NSError domain(é”™è¯¯èŒƒå›´ï¼Œå…¶ç±»å‹ä¸ºå­—ç¬¦ä¸²)é”™è¯¯å‘ç”Ÿçš„èŒƒå›´ï¼Œä¹Ÿå°±æ˜¯äº§ç”Ÿé”™è¯¯çš„æ ¹æºï¼Œé€šå¸¸ç”¨ä¸€ä¸ªç‰¹æœ‰çš„å…¨å±€å˜é‡æ¥å®šä¹‰ï¼Œæ¯”æ–¹è¯´ â€œå¤„ç†URLå­ç³»ç»Ÿâ€ä»URLçš„è§£æè·å–æ•°æ®æ—¶å¦‚æœå‡ºé”™äº†ï¼Œé‚£ä¹ˆå°±ä¼šä½¿ç”¨NSURLErrorDomainæ¥è¡¨ç¤ºé”™è¯¯èŒƒå›´ Error code(é”™è¯¯ç ï¼Œå…¶ç±»å‹ä¸ºæ•´æ•°)ç‹¬æœ‰çš„é”™è¯¯ä»£ç ï¼Œç”¨ä»¥æŒ‡æ˜åœ¨æŸä¸ªèŒƒå›´å†…å…·ä½“å‘ç”Ÿäº†ä½•ç§é”™è¯¯ã€‚æŸä¸ªç‰¹æ€§èŒƒå›´å†…å¯èƒ½ä¼šå‘ç”Ÿä¸€ç³»åˆ—ç›¸å…³é”™è¯¯ï¼Œè¿™äº›é”™è¯¯æƒ…å†µé€šå¸¸é‡‡ç”¨enumæ¥å®šä¹‰ã€‚ä¾‹å¦‚ï¼Œå½“HTTPè¯·æ±‚å‡ºé”™æ—¶ï¼Œå¯èƒ½ä¼šæŠŠHTTPçŠ¶æ€ç è®¾ä¸ºé”™è¯¯ç  User info(ç”¨æˆ·ä¿¡æ¯ï¼Œå…¶ç±»å‹ä¸ºå­—å…¸)æœ‰å…³é”™è¯¯çš„é¢å¤–ä¿¡æ¯ï¼Œå…¶ä¸­æˆ–è®¸åŒ…å«ä¸€æ®µâ€œæœ¬åœ°åŒ–çš„æè¿°â€æˆ–è®¸è¿˜å«æœ‰å¯¼è‡´é”™è¯¯å‘ç”Ÿçš„å¦å¤–ä¸€ä¸ªé”™è¯¯ï¼Œç»ç”±æ­¤ç§ä¿¡æ¯ï¼Œå¯å°†ç›¸å…³é”™è¯¯ä¸²æˆä¸€æ¡â€œé”™è¯¯é“¾â€ 123456789101112@try &#123;NSString *str = @&quot;wotaxiwa&quot;;NSString *strErr = [str substringFromIndex:100];NSLog(@&quot;%@&quot;,str);&#125; @catch (NSException *exception) &#123;NSLog(@&quot;ERROR: %@&quot;,exception);&#125; @finally &#123;NSLog(@&quot;%s&quot;,__func__);&#125;å¦‚æœå‡ºç°exceptionï¼Œå¼‚å¸¸åé¢çš„ä»£ç å°†ä¸ä¼šç»§ç»­æ‰§è¡Œ ç†è§£NSCopyingåè®® copyæ–¹æ³•å®é™…ä¸Šæ˜¯è°ƒç”¨ -(id)copyWithZone:(NSZone*)zone; å®ç°copyæ“ä½œï¼Œ å¦‚æœæƒ³å¯¹è‡ªå·±çš„ç±»æ”¯æŒæ‹·è´å¹¶ä¸”åšé¢å¤–æ“ä½œï¼Œé‚£å°±è¦å®ç°NSCopyingåè®®æ­¤çš„æ–¹æ³•ã€‚ä¸ºä½•å‡ºç°NSZoneå‘¢ï¼Œä»¥å‰å¼€å‘ç¨‹åºæ—¶ï¼Œä¼šæ®æ­¤æŠŠå†…å­˜åˆ†æˆä¸ç”¨çš„åŒºï¼Œè€Œå¯¹è±¡ä¼šåˆ›å»ºåœ¨æŸä¸ªåŒºã€‚ ç°åœ¨ä¸ç”¨äº†ï¼Œæ¯ä¸ªç¨‹åºåªæœ‰ä¸€ä¸ªåŒºï¼šâ€œé»˜è®¤åŒºâ€ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒzoneå‚æ•°ã€‚copyæ–¹æ³•ç”±NSObjectå®ç°ï¼Œè¯¥æ–¹æ³•åªæ˜¯ä»¥é»˜è®¤åŒºä¸ºå‚æ•°è°ƒç”¨ã€‚ mutableCopyæ–¹æ³•å®é™…ä¸Šæ˜¯è°ƒç”¨ -(id)mutableCopyWithZone:(NSZone*)zone; å®ç°mutableCopyæ“ä½œ åè®®ä¸åˆ†ç±»é€šè¿‡å§”æ‰˜ä¸æ•°æ®åè®®è¿›è¡Œå¯¹è±¡é—´é€šä¿¡è¿™ä¸€æ¡è¯´çš„å°±æ˜¯delegate(ä»£ç†è®¾è®¡æ¨¡å¼)ã€‚ä½†æ˜¯å¹¶æ²¡æœ‰è¯´delegateçš„å¾ªç¯å¼•ç”¨çš„é—®é¢˜,åœ¨ä½¿ç”¨ä»£ç†å£°æ˜ä¸€ä¸ª @propertyçš„æ—¶å€™ï¼Œè®°å¾—ç”¨weakã€‚ å°†ç±»çš„å®ç°ä»£ç åˆ†æ•£åˆ°ä¾¿äºç®¡ç†çš„æ•°ä¸ªåˆ†ç±»ä¹‹ä¸­ ä½¿ç”¨åˆ†ç±»æœºåˆ¶æŠŠç±»çš„å®ç°ä»£ç åˆ’åˆ†æˆæ˜“äºç®¡ç†çš„å°å— å°†åº”è¯¥è§†ä¸ºâ€œç§æœ‰â€çš„æ–¹æ³•å½’å…¥åä¸ºPrivateçš„åˆ†ç±»ä¸­ï¼Œä»¥éšè—ç»†èŠ‚ã€‚ å‹¿åœ¨åˆ†ç±»ä¸­å£°æ˜å±æ€§æ­£å¸¸çš„åˆ†ç±»æ˜¯ä¸å¯ä»¥å£°æ˜å±æ€§çš„ï¼Œä½†æ˜¯ä»æŠ€æœ¯ä¸Šè¯´ï¼Œåˆ†ç±»é‡Œå¯ä»¥ç”¨runtimeå£°æ˜å±æ€§ã€‚ 1234567891011#import &lt;objc.runtime.h&gt;static const char *kFriendsPropertyKey = â€œkFriendsPropertyKeyâ€;@implementation EOCPerson(Friendship)-(NSArray*)friends&#123;return objc_getAssociatedObject(self,kFriendsPropertyKey);&#125;-(void)setFriends:(NSArray*)friends&#123;objc_setAssociateObject(self.kFriendsPropertyKey,friends,OBJC_ASSOCIATION_RETAIN_NONATOMIC);&#125;@end è¿™æ ·åšå¯è¡Œï¼Œä½†æ˜¯ä¸å¤ªç†æƒ³ï¼Œè¦æŠŠç›¸ä¼¼çš„ä»£ç å†™å¾ˆå¤šéã€‚è€Œä¸”å®¹æ˜“å‡ºç°Bugï¼Œå¯ä»¥ä½¿ç”¨class-continuationå®ç°åˆ†ç±»æ·»åŠ å±æ€§ã€‚ ä½¿ç”¨class-continuationåˆ†ç±»éšè—å®ç°ç»†èŠ‚class-continuationåˆ†ç±»å’Œæ™®é€šçš„åˆ†ç±»ä¸åŒï¼Œå®ƒå¿…é¡»åœ¨å…¶æ‰€æ¥ç»­çš„é‚£ä¸ªç±»çš„å®ç°æ–‡ä»¶é‡Œã€‚å…¶é‡è¦ä¹‹å¤„åœ¨äºï¼Œè¿™æ˜¯å”¯ä¸€èƒ½å£°æ˜å®ä¾‹å˜é‡çš„åˆ†ç±»ï¼Œè€Œä¸”æ­¤åˆ†ç±»æ²¡æœ‰ç‰¹å®šçš„å®ç°æ–‡ä»¶ï¼Œå…¶ä¸­çš„æ–¹æ³•åº”è¯¥å®šä¹‰åœ¨ç±»çš„ä¸»å®ç°æ–‡ä»¶é‡Œã€‚ä¸å…¶ä»–åˆ†ç±»ä¸åŒï¼Œâ€œclass-continuationåˆ†ç±»â€æ²¡æœ‰åå­—ï¼Œæ¯”å¦‚ï¼Œæœ‰ä¸ªç±»å«åšEOCPersonï¼Œå…¶â€œclass-continuationåˆ†ç±»â€å†™æ³•å¦‚ä¸‹ï¼š 12345678910111213141516171819@interface EOCPerson()@end#import &quot;ViewController.h&quot;@interface ViewController ()@end@implementation ViewController- (void)viewDidLoad &#123;[super viewDidLoad];&#125;- (void)didReceiveMemoryWarning &#123;[super didReceiveMemoryWarning];&#125;@end æ²¡é”™å®ƒå°±æ˜¯ class-continuationåˆ†ç±»ï¼Œåœ¨æ­¤ä»£ç ä¹‹é—´å¯ä»¥æ·»åŠ å±æ€§ï¼Œä¿®æ”¹å±æ€§ã€‚ 12@interface ViewController ()@end ä½¿ç”¨class-continuationåˆ†ç±»çš„å¥½å¤„ å¯ä»¥å‘ç±»ä¸­æ–°å¢å®ä¾‹å˜é‡ã€‚ å¦‚æœç±»ä¸­çš„ä¸»æ¥å£å£°æ˜ä¸ºåªè¯»ï¼Œå¯ä»¥å†ç±»å†…éƒ¨ä¿®æ”¹æ­¤å±æ€§ã€‚ æŠŠç§æœ‰æ–¹æ³•çš„åŸå‹æ–‡ä»¶ç”Ÿå‘½åœ¨â€class-continuationåˆ†ç±»â€é‡Œé¢ã€‚ æƒ³ä½¿ç±»éµå¾ªçš„åè®®ä¸ä¸ºäººçŸ¥ï¼Œå¯ä»¥ç”¨â€œclass-continuationåˆ†ç±»â€ä¸­å£°æ˜ã€‚ é€šè¿‡åè®®æä¾›åŒ¿åå¯¹è±¡å°±è¯´ä¸‹é¢è¿™å¥è¯1@property (nonatomic,weak)id&lt;PersonDelegate&gt; pd; å†…å­˜ç®¡ç†ç†è§£å¼•ç”¨è®¡æ•°ç†è§£å¼•ç”¨è®¡æ•°ï¼Œæ–¹ä¾¿äºäº†è§£iOSçš„å†…å­˜ç®¡ç†ã€‚ä¸è¿‡ç°åœ¨éƒ½æ˜¯ARCçš„æ—¶ä»£äº†ã€‚ å¼•ç”¨è®¡æ•°æœºåˆ¶é€šè¿‡å¯ä»¥é€’å¢é€’å‡çš„è®¡æ•°å™¨æ¥ç®¡ç†å†…å­˜ã€‚å¯¹è±¡åˆ›å»ºå¥½ä¹‹åï¼Œå…¶ä¿ç•™è®¡æ•°è‡³å°‘ä¸º1ã€‚è‹¥ä¿ç•™è®¡æ•°ä¸ºæ­£ï¼Œåˆ™å¯¹è±¡ç»§ç»­å­˜æ´»ã€‚å½“ä¿å­˜è®¡æ•°é™ä¸º0ï¼Œå¯¹è±¡å°±è¢«é”€æ¯äº†ã€‚ åœ¨å¯¹è±¡ç”Ÿå‘½æœŸä¸­ï¼Œå…¶ä½™å¯¹è±¡é€šè¿‡å¼•ç”¨æ¥ä¿ç•™æˆ–é‡Šæ”¾æ­¤å¯¹è±¡ã€‚ä¿ç•™ä¸é‡Šæ”¾æ“ä½œåˆ†åˆ«ä¼šé€’å¢åŠé€’å‡ä¿ç•™è®¡æ•°ã€‚ ä»¥ARCç®€åŒ–å¼•ç”¨è®¡æ•°ä½¿ç”¨ARCè¦è®¡æ•°ï¼Œå¼•ç”¨è®¡æ•°å®é™…ä¸Šè¿˜æ˜¯è¦æ‰§è¡Œçš„ï¼Œåªä¸è¿‡ä¿ç•™ä¸é‡Šæ”¾æ“ä½œç°åœ¨ç”±ARCè‡ªåŠ¨ä¸ºä½ æ·»åŠ ã€‚ç”±äºARCä¼šè‡ªåŠ¨æ‰§è¡Œretainã€releaseã€autoreleaseç­‰æ“ä½œï¼Œæ‰€ä»¥ç›´æ¥åœ¨ARCä¸‹è°ƒç”¨è¿™äº›å†…å­˜ç®¡ç†æ–¹æ³•æ˜¯éæ³•çš„ã€‚ ARCç®¡ç†å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„çš„åŠæ³•åŸºæœ¬å°±æ˜¯ï¼šåœ¨åˆé€‚çš„ä½ç½®æ’å…¥â€œä¿ç•™â€å’Œâ€œé‡Šæ”¾â€æ“ä½œã€‚ ARCåœ¨è°ƒç”¨è¿™äº›æ–¹æ³•æ—¶ï¼Œå¹¶ä¸ç”¨è¿‡æ™®é€šçš„Objective-Cæ¶ˆæ¯æ´¾å‘æœºåˆ¶ï¼Œè€Œæ˜¯ç›´æ¥è°ƒç”¨å…¶åº•å±‚Cè¯­è¨€ç‰ˆæœ¬ï¼Œè¿™æ ·åšæ€§èƒ½æ›´å¥½ï¼Œç›´æ¥è°ƒç”¨åº•å±‚å‡½æ•°èŠ‚çœå¾ˆå¤šCPUå‘¨æœŸã€‚ è™½ç„¶æœ‰äº†ARCä¹‹åæ— éœ€æ‹…å¿ƒå†…å­˜ç®¡ç†é—®é¢˜ï¼Œä½†æ˜¯CoreFoundationå¯¹è±¡ä¸å½’ARCç®¡ç†ï¼Œå¼€å‘è€…å¿…é¡»é€‚æ—¶è°ƒç”¨CFRetain/CFReleaseã€‚ åœ¨deallocæ–¹æ³•ä¸­åªé‡Šæ”¾å¼•ç”¨å¹¶è§£é™¤ç›‘å¬ å½“ä¸€ä¸ªå¯¹è±¡é”€æ¯çš„æ—¶å€™ä¼šè°ƒç”¨deallocæ–¹æ³•ï¼Œä½†æ˜¯å½“å¼€é”€è¾ƒå¤§æˆ–ç³»ç»Ÿå†…ç¨€ç¼ºèµ„æºåˆ™ä¸å†æ­¤åˆ—ï¼Œåƒæ˜¯æ–‡ä»¶æè¿°ã€å¥—æ¥å­—ã€å¤§å—å†…å­˜ç­‰éƒ½å±äºè¿™ç§èµ„æºï¼Œé€šå¸¸å¯¹äºå¼€é”€è¾ƒå¤§çš„èµ„æºå®ç°ä¸€ä¸ªæ–¹æ³•ï¼Œå½“ç¨‹åºç”¨å®Œèµ„æºå¯¹è±¡åï¼Œå°±è°ƒç”¨æ­¤æ–¹æ³•ã€‚è¿™æ ·ä¸€æ¥ï¼Œèµ„æºå¯¹è±¡çš„ç”Ÿå‘½æœŸå°±å˜å¾—æ˜ç¡®äº†ã€‚ æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡çš„æ–¹æ³•ä¸åº”è¯¥åœ¨deallocé‡Œé¢è°ƒç”¨ï¼›åªèƒ½åœ¨æ­£å¸¸çŠ¶æ€ä¸‹è°ƒç”¨çš„é‚£äº›æ–¹æ³•ä¹Ÿä¸åº”è¯¥è°ƒç”¨ï¼Œå› ä¸ºæ­¤æ—¶å¯¹è±¡å·²ç»å¤„äºæ­£åœ¨å›æ”¶çš„çŠ¶æ€äº†ã€‚ ç¼–å†™â€œå¼‚å¸¸å®‰å…¨ä»£ç â€æ—¶ç•™æ„å†…å­˜ç®¡ç†é—®é¢˜ åœ¨ä½¿ç”¨@try çš„æ—¶ä¹Ÿè¦æ³¨æ„ï¼Œåœ¨æ•è·åˆ°å¼‚å¸¸çš„æ—¶å€™@try{}ä¸­çš„è¯­å¥æ‰§è¡Œåˆ°å¼‚å¸¸ä»£ç çš„é‚£ä¸€è¡Œåä¸åœ¨æ‰§è¡Œï¼Œç„¶åæŠŠå¼‚å¸¸æŠ›ç»™@catchã€‚å½“ç„¶@finallyæ˜¯ä¸€å®šè¦æ‰§è¡Œçš„ã€‚ åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒARCä¸ç”Ÿæˆå®‰å…¨å¤„ç†å¼‚å¸¸æ‰€éœ€çš„æ¸…ç†ä»£ç ã€‚å¼€å¯ç¼–è¯‘å™¨æ ‡å¿—åï¼Œå¯ä»¥ç”Ÿæˆè¿™ç§ä»£ç ï¼Œä¸è¿‡ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå˜å¤§ï¼Œè€Œä¸”ä¼šé™ä½è¿è¡Œæ•ˆç‡ã€‚ ä»¥å¼±å¼•ç”¨é¿å…ä¿ç•™ç¯ unsafe_unretained è¯­ä¹‰åŒassignç­‰ä»·ã€‚ç„¶è€Œassigné€šå¸¸ç”¨äºintã€floatã€ç»“æ„ä½“ç­‰ã€‚unsafe_unretainedå¤šç”¨äºå¯¹è±¡ç±»å‹ã€‚ weak ä¸ unsafe_unretained ä½œç”¨ç›¸åŒï¼Œç„¶è€Œåªè¦ç³»ç»ŸæŠŠå±æ€§å›æ”¶ï¼Œå±æ€§å€¼ä¸ºnilã€‚æ¨èä½¿ç”¨weakï¼Œæ¯•ç«Ÿæ˜¯ARCæ—¶ä»£çš„äº§ç‰©ï¼Œè€Œä¸”ç”¨çš„äººä¹Ÿå¾ˆå¤šã€‚ ä»¥â€œè‡ªåŠ¨é‡Šæ”¾æ± å—â€é™ä½å†…å­˜å³°å€¼è‡ªåŠ¨é‡Šæ”¾æ± æ’å¸ƒåœ¨æ ˆä¸­ï¼Œå¯¹è±¡æ”¶åˆ°autoreleaseæ¶ˆæ¯åï¼Œç³»ç»Ÿå°†å…¶æ”¾å…¥æœ€é¡¶ç«¯çš„æ± é‡Œã€‚12345678910111213141516@autoreleasepool &#123;&lt;#statements#&gt;&#125;for (int i = 0; i &lt; 1000000; i++) &#123;@autoreleasepool &#123;NSNumber *num = [NSNumber numberWithInt:i];NSString *str = [NSString stringWithFormat:@&quot;%d &quot;, i];[NSString stringWithFormat:@&quot;%@%@&quot;, num, str];if(lagerNum-1 == i)&#123;NSLog(@&quot;end&quot;);&#125;&#125;&#125; ç”¨â€œåƒµå°¸å¯¹è±¡â€è°ƒè¯•å†…å­˜ç®¡ç†é—®é¢˜åœ¨å·¦ä¸Šè§’æ ‡é¢˜æ æ‰¾åˆ°é¡¹ç›®å•å‡»åé€‰æ‹© Edit scheme å‹¾é€‰å›¾ä¸­æ£€æµ‹åƒµå°¸å¯¹è±¡ã€‚ å¼€å¯åï¼Œç³»ç»Ÿåœ¨å›æ”¶å¯¹è±¡çš„æ—¶å€™ï¼Œå¯ä»¥ä¸çœŸçš„å°†å…¶å›æ”¶ï¼Œè€Œæ˜¯è½¬æˆåƒµå°¸å¯¹è±¡ã€‚ ç³»ç»Ÿä¼šä¿®æ”¹å¯¹è±¡çš„isaæŒ‡é’ˆï¼Œä»¤å…¶æŒ‡å‘ç‰¹æ®Šçš„åƒµå°¸ç±»ï¼Œä»è€Œä½¿è¯¥å¯¹è±¡å˜æˆåƒµå°¸å¯¹è±¡ã€‚åƒµå°¸ç±»èƒ½å“åº”æ‰€æœ‰çš„æ–¹æ³•ï¼Œå“åº”æ–¹å¼ä¸ºï¼šæ‰“å°ä¸€æ¡åŒ…å«æ¶ˆæ¯å†…å®¹åŠå…¶æ¥å—è€…çš„æ¶ˆæ¯ï¼Œç„¶åç»ˆæ­¢åº”ç”¨ç¨‹åºã€‚ ä¸è¦ä½¿ç”¨retainCount ä»»ä½•ç»™å®šæ—¶é—´ç‚¹ä¸Šçš„â€œç»å¯¹ä¿ç•™è®¡æ•°â€éƒ½æ— æ³•ååº”å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„å…¨è²Œã€‚ ARCçš„æ—¶ä»£ï¼Œè°ƒç”¨è¯¥æ–¹æ³•ä¼šç›´æ¥æŠ¥é”™ã€‚ å—ä¸å¤§ä¸­æ¢æ´¾å‘ç†è§£â€å—â€œè¿™ä¸€æ¦‚å¿µè¿™é‡Œå…¶å®å°±æ˜¯åœ¨è¯´blockï¼Œå¤ä¹ ä¸€ä¸‹blockçš„è¯­æ³•ï¼šè¿”å›å€¼ç±»å‹ï¼ˆblockåç§°)(å‚æ•°) éœ€è¦æ³¨æ„çš„æ˜¯å®šä¹‰blockæ—¶å€™ï¼Œå…¶æ‰€å å†…å­˜åŒºåŸŸæ˜¯åˆ†é…åœ¨æ ˆä¸­çš„ï¼Œå—åªåœ¨å®šä¹‰å®ƒçš„é‚£ä¸ªèŒƒå›´å†…æœ‰æ•ˆã€‚ blockæ‰€ä½¿ç”¨çš„æ•´ä¸ªå†…å­˜åŒºåŸŸï¼Œåœ¨ç¼–è¯‘æœŸå·²ç»å®Œå…¨ç¡®å®šï¼Œå› æ­¤ï¼Œå…¨å±€blockå¯ä»¥ç”Ÿå‘½åœ¨å…¨å±€å†…å­˜é‡Œï¼Œè€Œä¸éœ€è¦åœ¨æ¯æ¬¡ç”¨åˆ°çš„æ—¶å€™äºæ ˆä¸­åˆ›å»ºï¼Œå¦å¤–ï¼Œå…¨å±€blockçš„æ‹·è´æ˜¯ä¸ªç©ºæ“ä½œï¼Œå› ä¸ºå…¨å±€blockç»ä¸å¯èƒ½ä¸ºç³»ç»Ÿæ‰€å›æ”¶ï¼Œè¿™ç§blockå®é™…ä¸Šç›¸å½“äºå•ä¾‹ã€‚ å¯ä»¥è°ƒç”¨ copy æ–¹æ³•å°†å—ä»æ ˆæ‹·è´åˆ°å †ï¼Œæ‹·è´ä¹‹åçš„å—å°±å¯ä»¥åœ¨å®šä¹‰å®ƒçš„èŒƒå›´ä¹‹å¤–ä½¿ç”¨äº†ã€‚è€Œä¸”ï¼Œæ‹·è´åˆ°å †ä»¥åï¼Œå—å°±å˜æˆå¸¦å¼•ç”¨è®¡æ•°çš„å¯¹è±¡äº†ï¼Œåç»­çš„copyæ“ä½œä¸ä¼šçœŸçš„æ‰§è¡Œï¼Œåªæ˜¯é€’å¢å¼•ç”¨è®¡æ•°ã€‚ ä¸ºå¸¸ç”¨çš„å—ç±»å‹åˆ›å»ºtypedefå°±æ˜¯ç»™blockèµ·ä¸ªåˆ«å12typedef &lt;#returnType#&gt;(^&lt;#name#&gt;)(&lt;#arguments#&gt;);@property (nonatomic,copy)name nm_blk; ç”¨handlerå—é™ä½ä»£ç åˆ†æ•£ç¨‹åº¦è¯´çš„å°±æ˜¯blockçš„å›è°ƒã€‚åªä¸è¿‡æ˜¯æŠŠblockæ”¾åœ¨æ–¹æ³•ä¸­å»ä½¿ç”¨,ä½¿ä»£ç æ›´åŠ ç´§è‡´ã€‚ 12345678910111213141516171819202122// Person.h#import &lt;Foundation/Foundation.h&gt;typedef void(^Blk)(NSString *name,int age);@interface Person : NSObject-(void)handler:(Blk)blk;@end// Person.m#import &quot;Person.h@implementation Person-(void)handler:(Blk)blk&#123;if(blk)&#123;blk(@&quot;zhangsan&quot; ,28);&#125;&#125;@end// ä½¿ç”¨Person *per =[Person new];[per handler:^(NSString *name, int age) &#123;NSLog(@&quot;%@ %d&quot;,name, age);&#125;]; ç”¨å—å¼•ç”¨å…¶æ‰€å±å¯¹è±¡æ—¶ä¸è¦å‡ºç°ä¿ç•™ç¯æ³¨æ„ç”¨weakï¼Œä¸è¦å‡ºç°å¾ªç¯å¼•ç”¨ã€‚ å¤šç”¨æ´¾å‘é˜Ÿåˆ—ï¼Œå°‘ç”¨åŒæ­¥é”æ´¾å‘é˜Ÿåˆ—å¯ç”¨æ¥è¡¨è¿°åŒæ­¥è¯­ä¹‰ï¼Œè¿™ç§åšæ³•æ¯”ä½¿ç”¨@synchronizeå—æˆ–NSLockå¯¹è±¡æ›´ç®€å•å°†åŒæ­¥ä¸å¼‚æ­¥æ´¾å‘ç»“åˆèµ·æ¥ï¼Œå¯ä»¥å®ç°ä¸æ™®é€šæ·é”æœºåˆ¶ä¸€æ ·çš„åŒæ­¥è¡Œä¸ºï¼Œè€Œè¿™ä¹ˆåšå´ä¸ä¼šé˜»å¡æ‰§è¡Œå¼‚æ­¥æ´¾å‘çš„çº¿ç¨‹ã€‚ ä½¿ç”¨åŒæ­¥é˜Ÿåˆ—åŠæ …æ å—ï¼Œå¯ä»¥ä»¤åŒæ­¥è¡Œä¸ºæ›´åŠ é«˜æ•ˆï¼ˆä¸å¸¸ç”¨ï¼‰ã€‚ å¤šç”¨GCDï¼Œå°‘ç”¨performSelectorç³»åˆ—æ–¹æ³•è¿™ä¸ªæ²¡å•¥å¯è¯´çš„ æŒæ¡GCDåŠæ“ä½œé˜Ÿåˆ—çš„é€‚ç”¨æ—¶æœºè¿™ä¸ªæ²¡å•¥å¯è¯´çš„ è§£å†³å¤šçº¿ç¨‹ä¸ä»»åŠ¡ç®¡ç†é—®é¢˜æ—¶ï¼Œæ´¾å‘é˜Ÿåˆ—å¹¶éå”¯ä¸€æ–¹æ¡ˆ æ“ä½œé˜Ÿåˆ—æä¾›äº†ä¸€å¥—é«˜å±‚çš„Objective-C API èƒ½å®ç°çº¯GCDæ‰€å…·å¤‡çš„ç»å¤§éƒ¨åˆ†åŠŸèƒ½ï¼Œè€Œä¸”è¿˜å®Œæˆä¸€äº›æ›´ä¸ºå¤æ‚çš„æ“ä½œï¼Œé‚£äº›æ“ä½œå¼±æ”¹ç”¨GCDæ¥å®ç°ï¼Œåˆ™éœ€å¦å¤–ç¼–å†™ä»£ç ã€‚ ä½¿ç”¨NSOperationå¯¹çº¿ç¨‹ç®¡ç† é€šè¿‡Dispatch Groupæœºåˆ¶ï¼Œæ ¹æ®ç³»ç»Ÿèµ„æºçŠ¶å†µæ¥æ‰§è¡Œä»»åŠ¡è¿™ä¸ªæ²¡å•¥å¯è¯´çš„ä¸€ç³»åˆ—ä»»åŠ¡å¯å½’å…¥ä¸€ä¸ªdispatch groupä¹‹ä¸­ã€‚å¼€å‘è€…å¯ä»¥åœ¨è¿™ç»„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•æ—¶è·å¾—é€šçŸ¥é€šè¿‡dispatch groupï¼Œå¯ä»¥åœ¨å¹¶å‘å¼æ´¾å‘é˜Ÿåˆ—é‡ŒåŒæ—¶æ‰§è¡Œå¤šé¡¹ä»»åŠ¡ã€‚æ­¤æ—¶GCDä¼šæ ¹æ®ç³»ç»Ÿè¥¿è‹‘çŠ¶å†µæ¥è°ƒåº¦è¿™äº›å¹¶å‘æ‰§è¡Œçš„ä»»åŠ¡ã€‚å¼€å‘è€…è‹¥è‡ªå·±æ¥å®ç°æ­¤åŠŸèƒ½ã€‚åˆ™éœ€è¦ä¾¿æºå¤§é‡ä»£ç ã€‚ ä½¿ç”¨dispatch_onceæ¥æ‰§è¡Œç§©åºè¿è¡Œä¸€æ¬¡çš„çº¿ç¨‹å®‰å…¨ä»£ç 1234static dispatch_once_t onceToken;dispatch_once(&amp;onceToken, ^&#123;&lt;#code to be executed once#&gt;&#125;); ä¸ç”¨ä½¿ç”¨dispatch_get_current_queueè¿™ä¸ªæ²¡å•¥å¯è¯´çš„ã€‚iOSç³»ç»Ÿ6.0ç‰ˆæœ¬èµ·ï¼Œå·²ç»æ­£å¼å¼ƒç”¨æ­¤å‡½æ•°äº†ã€‚ ç³»ç»Ÿæ¡†æ¶ç†Ÿæ‚‰ç³»ç»Ÿæ¡†æ¶æ‰“å¼€Xcode command + shift + 0 é€‰æ‹©æ€§çš„äº†è§£ä¸€äº› Foundationã€UIKitä¹Ÿå¯ä»¥çœ‹çœ‹è¿™ç¯‡åšå®¢ http://www.jianshu.com/p/58bc11c800e4 å¤šç”¨å—æšä¸¾ï¼Œå°‘ç”¨forå¾ªç¯å› ä¸ºæšä¸¾éå†çš„æ—¶å€™ç”¨çš„å¤šçº¿ç¨‹ï¼ˆGCDå¹¶å‘æ‰§è¡Œï¼‰ï¼Œæ‰€ä»¥æ•ˆç‡æ›´å¿«äº›ã€‚æˆ‘è§‰å¾—å…¶å®ç”¨ä»€ä¹ˆéƒ½è¡Œã€‚ 123NSArray *arr = @[@&quot;b&quot;,@&quot;c&quot;,@&quot;s&quot;];[arr enumerateObjectsUsingBlock:^(id _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) &#123;&#125;]; å¯¹è‡ªå®šä¹‰å…¶å†…å­˜ç®¡ç†è¯­ä¹‰çš„collectionä½¿ç”¨æ— ç¼æ¡¥æ¥123NSArray *anNSArray = @[@1,@3,@5,@8];CFArrayRef acFArray = (__bridge CFArrayRef)anNSArray;NSLog(@&quot;%@&quot;,acFArray); é€šè¿‡æ— ç¼æ¡¥æ¥æŠ€æœ¯ï¼Œå¯ä»¥åœ¨Foundationæ¡†æ¶ä¸­Objective-Cå¯¹è±¡ä¸CoreFoundationæ¡†æ¶ä¸­çš„Cè¯­è¨€æ•°æ®ç»“æ„ä¹‹é—´æ¥å›è½¬æ¢ã€‚ åœ¨CoreFoundationå±‚é¢ç©¿ä»¶collectionæ—¶ï¼Œå¯ä»¥æŒ‡å®šè®¸å¤šå›è°ƒå‡½æ•°ï¼Œè¿™äº›å‡½æ•°è¡¨ç¤ºæ­¤collectionåº”å¦‚ä½•å¤„ç†å…¶å…ƒç´ ï¼Œç„¶åå¯è¿ç”¨æ— ç¼æ¡¥æ¥æŠ€æœ¯ï¼Œå°†å…¶è½¬æ¢æˆå…·å¤‡ç‰¹æ®Šå†…å­˜ç®¡ç†è¯­ä¹‰çš„Objective-C collectionã€‚ __bridge:ARCä»ç„¶å…·å¤‡è¿™ä¸ªOCå¯¹è±¡çš„æ‰€æœ‰æƒ bridgeretained:ARCå°†äº¤å‡ºå¯¹è±¡çš„æ‰€æœ‰æƒ æ„å»ºç¼“å­˜æ—¶é€‰ç”¨NSCacheè€ŒéNSDictionary NSCacheèƒœè¿‡NSDictionaryä¹‹å¤„åœ¨äºï¼Œå½“ç³»ç»Ÿèµ„æºè€—å°½æ—¶ï¼Œå®ƒèƒ½è‡ªåŠ¨åˆ å‡ç¼“å­˜ã€‚ NSCacheçº¿ç¨‹å®‰å…¨ ç²¾ç®€Initializeä¸loadçš„å®ç°ä»£ç ç±»åˆå§‹åŒ–çš„æ—¶å€™ä¸€å®šä¼šè°ƒç”¨ä¸¤ä¸ªæ–¹æ³• 12345678+(void)load&#123;&#125;+ (void)initialize&#123;if (self == [&lt;#ClassName#&gt; class]) &#123;&lt;#statements#&gt;&#125;&#125; loadæ–¹æ³•åªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œä¸ç®¡è¯¥ç±»çš„å¤´æ–‡ä»¶æœ‰æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œè¯¥ç±»éƒ½ä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨ï¼Œè€Œä¸”åªè°ƒç”¨ä¸€æ¬¡ã€‚ å½“ç„¶äº†ï¼Œå¦‚æœä¸é‡å†™è¿™ä¸ªæ–¹æ³•çš„è¯ï¼Œæˆ‘ä»¬æ˜¯ä¸çŸ¥é“è¿™ä¸ªæ–¹æ³•æœ‰æ²¡æœ‰è¢«è°ƒç”¨çš„ã€‚å¦‚æœåˆ†ç±»ä¹Ÿé‡å†™äº†loadæ–¹æ³•ï¼Œå…ˆè°ƒç”¨ç±»é‡Œçš„ï¼Œåœ¨è°ƒç”¨åˆ†ç±»ã€‚ loadæ–¹æ³•æ‰§è¡Œæ—¶ï¼Œè¿è¡ŒæœŸç³»ç»Ÿå¤„äºâ€œè„†å¼±çŠ¶æ€â€ï¼Œåœ¨æ‰§è¡Œå­ç±»çš„loadæ–¹æ³•ä¹‹å‰ï¼Œå¿…å®šä¼šå…ˆæ‰§è¡Œæ‰€ä»¥è¶…ç±»çš„loadæ–¹æ³•ï¼Œè€Œå¦‚æœä»£ç è¿˜ä¾èµ–äº†å…¶ä»–çš„åº“ï¼Œé‚£ä¹ˆå…¶ä»–åº“çš„ç›¸å…³ç±»çš„loadæ–¹æ³•ä¸€å®šä¼šå…ˆæ‰§è¡Œï¼Œä½†æ˜¯æ‰§è¡Œçš„é¡ºåºä¸å¥½åˆ¤æ–­ï¼Œæ‰€ä»¥åœ¨loadæ–¹æ³•ä¸­ä½¿ç”¨å…¶ä»–ç±»æ˜¯ä¸å®‰å…¨çš„ã€‚ æ•´ä¸ªç¨‹åºåœ¨æ‰§è¡Œloadæ–¹æ³•æ—¶éƒ½ä¼šé˜»å¡ã€‚ initialize å’Œloadç±»ä¼¼ï¼Œä¸è¿‡åœ¨ç±»è¢«åˆå§‹åŒ–çš„æ—¶å€™æ‰ä¼šè¢«è°ƒç”¨ï¼ˆinitä¹‹å‰ï¼‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ&lt;#ClassName#&gt;å¦‚æœæœ‰å­ç±»ç»§æ‰¿çš„æ—¶å€™è¦åˆ¤æ–­ç±»åã€‚ ä¸¤ä¸ªæ–¹æ³•çš„å®ç°éƒ½åº”è¯¥ç²¾ç®€äº›ï¼Œè¿™æœ‰åŠ©äºä¿æŒåº”ç”¨ç¨‹åºçš„å“åº”èƒ½åŠ›ã€‚ åˆ«å¿˜äº†NSTimerä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡1234567891011121314151617181920212223242526272829303132333435363738394041// Person.h#import &lt;Foundation/Foundation.h&gt;@interface Person : NSObject@property (nonatomic,strong)NSTimer *timer;-(void)start;-(void)stop;@end// Person.m#import &quot;Person.h&quot;@implementation Person-(void)start&#123;self.timer = [NSTimer scheduledTimerWithTimeInterval:1 target:self selector:@selector(run) userInfo:nil repeats:YES];&#125;-(void)run&#123;NSLog(@&quot;%s&quot;,__func__);&#125;-(void)dealloc&#123;NSLog(@&quot;%s&quot;,__func__);&#125;-(void)stop&#123;[self.timer invalidate];&#125;@endè°ƒç”¨@property (nonatomic,strong)Person *person;self.person = [Person new];[self.person start];-(void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event&#123;[self.person stop];&#125; å¥½ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ˜¯ä¸æ˜¯æ²¡æœ‰è°ƒç”¨deallocæ–¹æ³•ï¼Œæ²¡æœ‰è°ƒç”¨deallocæ–¹æ³•å°±è¯´æ˜Personå¯¹è±¡å¹¶æ²¡æœ‰è¢«é”€æ¯ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰è¢«é”€æ¯å› ä¸ºåœ¨æ§åˆ¶å™¨å¼ºå¼•ç”¨äº†self.personï¼Œ[self.person start]å¼ºå¼•ç”¨äº† self.timer; self.timer çš„targetæŒ‡å‘äº†selfï¼ˆself.personï¼‰æ‰€ä»¥å¾ªç¯å¼•ç”¨äº†ã€‚ æ€ä¹ˆè§£å†³ã€‚ NSTimeré”€æ¯çš„æ—¶å€™ï¼ŒæŠŠPersonå¯¹è±¡ä¸ºnilå³å¯ã€‚ 1234-(void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event&#123;[self.person stop];self.person = nil;&#125;","categories":[{"name":"è¯»ä¹¦","slug":"è¯»ä¹¦","permalink":"https://bigporo.github.io/categories/è¯»ä¹¦/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"https://bigporo.github.io/tags/iOS/"},{"name":"è¯»ä¹¦","slug":"è¯»ä¹¦","permalink":"https://bigporo.github.io/tags/è¯»ä¹¦/"}]},{"title":"ã€Šè®¡ç®—æœºç½‘ç»œï¼ˆç¬¬ä¸ƒç‰ˆï¼‰ã€‹è¯»ä¹¦æ€»ç»“","slug":"ã€Šè®¡ç®—æœºç½‘ç»œï¼ˆç¬¬ä¸ƒç‰ˆï¼‰ã€‹è¯»ä¹¦æ€»ç»“","date":"2019-04-23T09:17:43.000Z","updated":"2019-05-16T07:53:02.363Z","comments":true,"path":"2019/04/23/ã€Šè®¡ç®—æœºç½‘ç»œï¼ˆç¬¬ä¸ƒç‰ˆï¼‰ã€‹è¯»ä¹¦æ€»ç»“/","link":"","permalink":"https://bigporo.github.io/2019/04/23/ã€Šè®¡ç®—æœºç½‘ç»œï¼ˆç¬¬ä¸ƒç‰ˆï¼‰ã€‹è¯»ä¹¦æ€»ç»“/","excerpt":"ä¸»è¦æ˜¯æ‘˜å½•ä¹¦ä¸­çš„é‡è¦æ¦‚å¿µã€‚ æ¦‚è¿° è®¡ç®—æœºç½‘ç»œ(å¯ç®€ç§°ä¸ºç½‘ç»œ)æŠŠè®¸å¤šè®¡ç®—æœºè¿æ¥åœ¨ä¸€èµ·ï¼Œè€Œäº’è¿ç½‘åˆ™æŠŠè®¸å¤šç½‘ç»œè¿æ¥åœ¨ä¸€èµ·ï¼Œæ˜¯ç½‘ç»œçš„ç½‘ç»œã€‚","text":"ä¸»è¦æ˜¯æ‘˜å½•ä¹¦ä¸­çš„é‡è¦æ¦‚å¿µã€‚ æ¦‚è¿° è®¡ç®—æœºç½‘ç»œ(å¯ç®€ç§°ä¸ºç½‘ç»œ)æŠŠè®¸å¤šè®¡ç®—æœºè¿æ¥åœ¨ä¸€èµ·ï¼Œè€Œäº’è¿ç½‘åˆ™æŠŠè®¸å¤šç½‘ç»œè¿æ¥åœ¨ä¸€èµ·ï¼Œæ˜¯ç½‘ç»œçš„ç½‘ç»œã€‚ ä»¥å°å†™å­—æ¯iå¼€å§‹çš„ internet(äº’è¿ç½‘)æ˜¯é€šç”¨åè¯ï¼Œå®ƒæ³›æŒ‡ç”±å¤šä¸ªè®¡ç®—æœºç½‘ç»œäº’è¿è€Œæˆçš„ç½‘ç»œã€‚åœ¨è¿™äº›ç½‘ç»œä¹‹é—´çš„é€šä¿¡åè®®(å³é€šä¿¡è§„åˆ™)å¯ä»¥æ˜¯ä»»æ„çš„ã€‚ ä»¥å¤§å†™å­—æ¯Iå¼€å§‹çš„ Internet(äº’è”ç½‘)æ˜¯ä¸“ç”¨åè¯ï¼Œå®ƒæŒ‡å½“å‰å…¨çƒæœ€å¤§çš„ã€å¼€æ”¾çš„ã€ç”±ä¼—å¤šç½‘ç»œç›¸äº’è¿æ¥è€Œæˆçš„ç‰¹å®šäº’è¿ç½‘ï¼Œå¹¶é‡‡ç”¨TCP/IPåè®®æ—ä½œä¸ºé€šä¿¡è§„åˆ™ï¼Œä¸”å…¶å‰èº«æ˜¯ç¾å›½çš„ ARPANETã€‚ Internetçš„æ¨èè¯‘åæ˜¯â€œå› ç‰¹ç½‘â€ï¼Œä½†å¾ˆå°‘è¢«ä½¿ç”¨ã€‚ äº’è”ç½‘ç°åœ¨é‡‡ç”¨å­˜å‚¨è½¬å‘çš„åˆ†ç»„äº¤æ¢æŠ€æœ¯ï¼Œä»¥åŠä¸‰å±‚ISPç»“æ„ã€‚ äº’è”ç½‘æŒ‰å·¥ä½œæ–¹å¼å¯åˆ’åˆ†ä¸ºè¾¹ç¼˜éƒ¨åˆ†ä¸æ ¸å¿ƒéƒ¨åˆ†ã€‚ä¸»æœºåœ¨ç½‘ç»œçš„è¾¹ç¼˜éƒ¨åˆ†ï¼Œå…¶ä½œç”¨æ˜¯è¿›è¡Œä¿¡æ¯å¤„ç†ã€‚è·¯ç”±å™¨åœ¨ç½‘ç»œçš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œå…¶ä½œç”¨æ˜¯æŒ‰å­˜å‚¨è½¬å‘æ–¹å¼è¿›è¡Œåˆ†ç»„äº¤æ¢ã€‚ è®¡ç®—æœºé€šä¿¡æ˜¯è®¡ç®—æœºä¸­çš„è¿›ç¨‹(å³è¿è¡Œç€çš„ç¨‹åº)ä¹‹é—´çš„é€šä¿¡ã€‚è®¡ç®—æœºç½‘ç»œé‡‡ç”¨çš„é€šä¿¡æ–¹å¼æ˜¯å®¢æˆ·ä¸€æœåŠ¡å™¨æ–¹å¼å’Œå¯¹ç­‰è¿æ¥æ–¹å¼(P2Pæ–¹å¼)å®¢æˆ·å’ŒæœåŠ¡å™¨éƒ½æ˜¯æŒ‡é€šä¿¡ä¸­æ‰€æ¶‰åŠçš„åº”ç”¨è¿›ç¨‹ã€‚ å®¢æˆ·æ˜¯æœåŠ¡è¯·æ±‚æ–¹ï¼ŒæœåŠ¡å™¨æ˜¯æœåŠ¡æä¾›æ–¹ã€‚æŒ‰ä½œç”¨èŒƒå›´çš„ä¸åŒï¼Œè®¡ç®—æœºç½‘ç»œåˆ†ä¸ºå¹¿åŸŸç½‘WANã€åŸåŸŸç½‘MANã€å±€åŸŸç½‘LANå’Œä¸ªäººåŒºåŸŸç½‘PANã€‚ è®¡ç®—æœºç½‘ç»œæœ€å¸¸ç”¨çš„æ€§èƒ½æŒ‡æ ‡æ˜¯:é€Ÿç‡ã€å¸¦å®½ã€ååé‡ã€æ—¶å»¶(å‘é€æ—¶å»¶ã€ä¼ æ’­å»¶ã€å¤„ç†æ—¶å»¶ã€æ’é˜Ÿæ—¶å»¶)ã€æ—¶å»¶å¸¦å®½ç§¯ã€å¾€è¿”æ—¶é—´å’Œä¿¡é“(æˆ–ç½‘ç»œ)åˆ©ç”¨ç‡ ç½‘ç»œåè®®å³åè®®ï¼Œæ˜¯ä¸ºè¿›è¡Œç½‘ç»œä¸­çš„æ•°æ®äº¤æ¢è€Œå»ºç«‹çš„è§„åˆ™ã€‚è®¡ç®—æœºç½‘ç»œçš„å„å±‚åŠå…¶åè®®çš„é›†åˆï¼Œç§°ä¸ºç½‘ç»œçš„ä½“ç³»ç»“æ„ã€‚ äº”å±‚åè®®çš„ä½“ç³»ç»“æ„ç”±åº”ç”¨å±‚ã€è¿è¾“å±‚ã€ç½‘ç»œå±‚(æˆ–ç½‘é™…å±‚)ã€æ•°æ®é“¾è·¯å±‚å’Œç‰©ç†å±‚ç»„æˆã€‚è¿è¾“å±‚æœ€é‡è¦çš„åè®®æ˜¯TCPå’ŒUDPåè®®ï¼Œè€Œç½‘ç»œå±‚æœ€é‡è¦çš„åè®®æ˜¯IPåè®®ã€‚ ç‰©ç†å±‚ ç‰©ç†å±‚çš„ä¸»è¦ä»»åŠ¡å°±æ˜¯ç¡®å®šä¸ä¼ è¾“åª’ä½“çš„æ¥å£æœ‰å…³çš„ä¸€äº›ç‰¹æ€§ï¼Œå¦‚æœºæ¢°ç‰¹æ€§ã€ç”µæ°”ç‰¹æ€§ã€åŠŸèƒ½ç‰¹æ€§å’Œè¿‡ç¨‹ç‰¹æ€§ã€‚ ä¸€ä¸ªæ•°æ®é€šä¿¡ç³»ç»Ÿå¯åˆ’åˆ†ä¸ºä¸‰å¤§éƒ¨åˆ†ï¼Œå³æºç³»ç»Ÿã€ä¼ è¾“ç³»ç»Ÿå’Œç›®çš„ç³»ç»Ÿã€‚æºç³»ç»ŸåŒ…æ‹¬æºç‚¹(æˆ–æºç«™ã€ä¿¡æº)å’Œå‘é€å™¨ï¼Œç›®çš„ç³»ç»ŸåŒ…æ‹¬æ¥æ”¶å™¨å’Œç»ˆç‚¹(æˆ–ç›®çš„ç«™ï¼Œæˆ–ä¿¡å®¿)ã€‚ é€šä¿¡çš„ç›®çš„æ˜¯ä¼ é€æ¶ˆæ¯ã€‚å¦‚è¯éŸ³ã€æ–‡å­—ã€å›¾åƒã€è§†é¢‘ç­‰éƒ½æ˜¯æ¶ˆæ¯ã€‚æ•°æ®æ˜¯è¿é€æ¶ˆæ¯çš„å®ä½“ã€‚ä¿¡å·åˆ™æ˜¯æ•°æ®çš„ç”µæ°”æˆ–ç”µç£çš„è¡¨ç°ã€‚ æ ¹æ®ä¿¡å·ä¸­ä»£è¡¨æ¶ˆæ¯çš„å‚æ•°çš„å–å€¼æ–¹å¼ä¸åŒï¼Œä¿¡å·å¯åˆ†ä¸ºæ¨¡æ‹Ÿä¿¡å·(æˆ–è¿ç»­ä¿¡å·)å’Œæ•°å­—ä¿¡å·(æˆ–ç¦»æ•£ä¿¡å·)ã€‚ä»£è¡¨æ•°å­—ä¿¡å·ä¸åŒç¦»æ•£æ•°å€¼çš„åŸºæœ¬æ³¢å½¢ç§°ä¸ºç å…ƒã€‚æ ¹æ®åŒæ–¹ä¿¡æ¯äº¤äº’çš„æ–¹å¼ï¼Œé€šä¿¡å¯ä»¥åˆ’åˆ†ä¸ºå•å‘é€šä¿¡(æˆ–å•å·¥é€šä¿¡)ã€åŒå‘äº¤æ›¿é€šä¿¡(æˆ–åŠåŒå·¥é€šä¿¡)å’ŒåŒå‘åŒæ—¶é€šä¿¡(æˆ–å…¨åŒå·¥é€šä¿¡)ã€‚ æ¥è‡ªä¿¡æºçš„ä¿¡å·å«åšåŸºå¸¦ä¿¡å·ã€‚ä¿¡å·è¦åœ¨ä¿¡é“ä¸Šä¼ è¾“å°±è¦ç»è¿‡è°ƒåˆ¶ã€‚è°ƒåˆ¶æœ‰åŸºå¸¦è°ƒåˆ¶å’Œå¸¦é€šè°ƒåˆ¶ä¹‹åˆ†ã€‚æœ€åŸºæœ¬çš„å¸¦é€šè°ƒåˆ¶æ–¹æ³•æœ‰è°ƒå¹…ã€è°ƒé¢‘å’Œè°ƒç›¸ã€‚è¿˜æœ‰æ›´å¤æ‚çš„è°ƒåˆ¶æ–¹æ³•ï¼Œå¦‚æ­£äº¤æŒ¯å¹…è°ƒåˆ¶ã€‚ è¦æé«˜æ•°æ®åœ¨ä¿¡é“ä¸Šçš„ä¼ è¾“é€Ÿç‡ï¼Œå¯ä»¥ä½¿ç”¨æ›´å¥½çš„ä¼ è¾“åª’ä½“ï¼Œæˆ–ä½¿ç”¨å…ˆè¿›çš„è°ƒåˆ¶æŠ€å‹ä¼ è¾“åª’ä½“(æ— çº¿æˆ–çº¢å¤–æˆ–å¤§æ°”æ¿€å…‰)ã€‚ä½†æ•°æ®ä¼ è¾“é€Ÿç‡ä¸å¯èƒ½è¢«ä»»æ„åœ°æé«˜ã€‚ ä¼ è¾“åª’ä½“å¯åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œå³å¯¼å¼•å‹ä¼ è¾“åª’ä½“(åŒç»çº¿ã€åŒè½´ç”µç¼†æˆ–å…‰çº¤)å’Œéå¯¼å¼•å‹ä¼ è¾“åª’ä½“(æ— çº¿æˆ–çº¢å¤–æˆ–å¤§æ°”æ¿€å…‰)ã€‚ å¸¸ç”¨çš„ä¿¡é“å¤ç”¨æŠ€æœ¯æœ‰é¢‘åˆ†å¤ç”¨ã€æ—¶åˆ†å¤ç”¨ã€ç»Ÿè®¡æ—¶åˆ†å¤ç”¨ã€ç åˆ†å¤ç”¨å’Œæ³¢åˆ†å¤ç”¨ï¼ˆå…‰çš„é¢‘åˆ†å¤ç”¨ï¼‰ã€‚ æœ€åˆåœ¨æ•°å­—ä¼ è¾“ç³»ç»Ÿä¸­ä½¿ç”¨çš„ä¼ è¾“æ ‡å‡†æ˜¯è„‰å†²ç¼–ç è°ƒåˆ¶PCMã€‚ç°åœ¨é«˜é€Ÿçš„æ•°å­—ä¼ è¾“ç³»ç»Ÿä½¿ç”¨åŒæ­¥å…‰çº¤ç½‘ SONET(ç¾å›½æ ‡å‡†)æˆ–åŒæ­¥æ•°å­—ç³»åˆ—SDH(å›½é™…æ ‡å‡†)ã€‚ ç”¨æˆ·åˆ°äº’è”ç½‘çš„å®½å¸¦æ¥å…¥æ–¹æ³•æœ‰éå¯¹ç§°æ•°å­—ç”¨æˆ·çº¿ADSL(ç”¨æ•°å­—æŠ€æœ¯å¯¹ç°æœ‰çš„æ¨¡æ‹Ÿç”µè¯ç”¨æˆ·çº¿è¿›è¡Œæ”¹é€ )ã€å…‰çº¤åŒè½´æ··åˆç½‘HFC(åœ¨æœ‰çº¿ç”µè§†ç½‘çš„åŸºç¡€ä¸Šå¼€å‘çš„)å’ŒFTTx(å³å…‰çº¤åˆ°æˆ·)ã€‚ ä¸ºäº†æœ‰æ•ˆåœ°åˆ©ç”¨å…‰çº¤èµ„æºï¼Œåœ¨å…‰çº¤å¹²çº¿å’Œç”¨æˆ·ä¹‹é—´å¹¿æ³›ä½¿ç”¨æ— æºå…‰ç½‘ç»œPONã€‚æ— æºå…‰ç½‘ç»œæ— é¡»é…å¤‡ç”µæºï¼Œå…¶é•¿æœŸè¿è¥æˆæœ¬å’Œç®¡ç†æˆæœ¬éƒ½å¾ˆä½ã€‚æœ€æµè¡Œçš„æ— æºå…‰ç½‘ç»æ˜¯ä»¥å¤ªç½‘æ— æºå…‰ç½‘ç»œEPONå’Œå‰æ¯”ç‰¹æ— æºå…‰ç½‘ç»œGPONã€‚ æ•°æ®é“¾è·¯å±‚ é“¾è·¯æ˜¯ä»ä¸€ä¸ªç»“ç‚¹åˆ°ç›¸éƒ¨ç»“ç‚¹çš„ä¸€æ®µç‰©ç†çº¿è·¯ï¼Œæ•°æ®é“¾è·¯åˆ™æ˜¯åœ¨é“¾è·¯çš„åŸºç¡€ä¸Šå¢åŠ äº†ä¸€äº›å¿…è¦çš„ç¡¬ä»¶(å¦‚ç½‘ç»œé€‚é…å™¨)å’Œè½¯ä»¶(å¦‚åè®®çš„å®ç°)ã€‚ æ•°æ®é“¾è·¯å±‚ä½¿ç”¨çš„ä¿¡é“ä¸»è¦æœ‰ç‚¹å¯¹ç‚¹ä¿¡é“å’Œå¹¿æ’­ä¿¡é“ä¸¤ç§ã€‚æ•°æ®é“¾è·¯å±‚ä¼ é€çš„åè®®æ•°æ®å•å…ƒæ˜¯å¸§ã€‚æ•°æ®é“¾è·¯å±‚çš„ä¸‰ä¸ªåŸºæœ¬é—®é¢˜åˆ™æ˜¯:å°è£…æˆå¸§ã€é€æ˜ä¼ è¾“å’Œå·®é”™æ£€æµ‹ã€‚ å¾ªç¯å†—ä½™æ£€éªŒCRCæ˜¯ä¸€ç§æ£€é”™æ–¹æ³•ï¼Œè€Œæ£€éªŒåºåˆ—FCSæ˜¯æ·»åŠ åœ¨æ•°æ®åé¢çš„å†—ä½™ç ã€‚ ç‚¹å¯¹ç‚¹åè®®PPPæ˜¯æ•°æ®é“¾è·¯å±‚ä½¿ç”¨æœ€å¤šçš„ä¸€ç§åè®®ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯:ç®€å•ï¼›åªæ£€æµ‹å·®é”™ï¼Œè€Œä¸æ˜¯çº æ­£å·®é”™:ä¸ä½¿ç”¨åºå·ï¼Œä¹Ÿä¸è¿›è¡Œæµé‡æ§åˆ¶:å¯åŒæ—¶æ”¯æŒå¤šç§ç½‘ç»œå±‚åè®®ã€‚ PPPOEæ˜¯ä¸ºå®½å¸¦ä¸Šç½‘çš„ä¸»æœºä½¿ç”¨çš„é“¾è·¯å±‚åè®®ã€‚ å±€åŸŸç½‘çš„ä¼˜ç‚¹æ˜¯:å…·æœ‰å¹¿æ’­åŠŸèƒ½ï¼Œä»ä¸€ä¸ªç«™ç‚¹å¯å¾ˆæ–¹ä¾¿åœ°è®¿é—®å…¨ç½‘:ä¾¿äºç³»ç»Ÿçš„æ‰©å±•å’Œé€æ¸æ¼”å˜ï¼›æé«˜äº†ç³»ç»Ÿçš„å¯é æ€§ã€å¯ç”¨æ€§å’Œç”Ÿå­˜æ€§ã€‚ å…±äº«é€šä¿¡åª’ä½“èµ„æºçš„æ–¹æ³•æœ‰äºŒ:ä¸€æ˜¯é™æ€åˆ’åˆ†ä¿¡é“(å„ç§å¤ç”¨æŠ€æœ¯)ï¼ŒäºŒæ˜¯åŠ¨æ€åª’ä½“æ¥å…¥æ§åˆ¶ï¼Œåˆç§°ä¸ºå¤šç‚¹æ¥å…¥(éšæœºæ¥å…¥æˆ–å—æ§æ¥å…¥)ã€‚ IEE802å§”å‘˜ä¼šæ›¾æŠŠå±€åŸŸç½‘çš„æ•°æ®é“¾è·¯å±‚æ‹†æˆä¸¤ä¸ªå­å±‚ï¼Œå³é€»è¾‘é“¾è·¯æ§åˆ¶(LC)å­å±‚(ä¸ä¼ è¾“åª’ä½“æ— å…³)å’Œåª’ä½“æ¥å…¥æ§åˆ¶MAC)å­å±‚(ä¸ä¼ è¾“åª’ä½“æœ‰å…³)ã€‚ä½†ç°åœ¨LCå­å±‚å·²æˆä¸ºå†å²ã€‚ è®¡ç®—æœºä¸å¤„ç•Œå±€åŸŸç½‘çš„é€šä¿¡è¦é€šè¿‡é€šä¿¡é€‚é…å™¨(æˆ–ç½‘ç»œé€‚é…å™¨)ï¼Œå®ƒåˆç§°ä¸ºç½‘ç»œæ¥å£å¡æˆ–ç½‘å¡ï¼Œä¸»è¦åŠŸèƒ½æ˜¯è¿›è¡Œæ•°æ®ä¸²è¡Œä¼ è¾“å’Œå¹¶è¡Œä¼ è¾“çš„è½¬æ¢ã€‚è®¡ç®—æœºçš„ç¡¬ä»¶åœ°å€å°±åœ¨é€‚é…å™¨ROMä¸­ã€‚ ä»¥å¤ªç½‘é‡‡ç”¨æ— è¿æ¥çš„å·¥ä½œæ–¹å¼ï¼Œå¯¹å‘é€çš„æ•°æ®ä¸è¿›è¡Œç¼–å·ï¼Œä¹Ÿä¸è¦æ±‚å¯¹æ–¹å‘å›ç¡®è®¤ã€‚ç›®çš„ç«™æ”¶åˆ°æœ‰å·®é”™å¸§å°±æŠŠå®ƒä¸¢å¼ƒï¼Œå…¶ä»–ä»€ä¹ˆä¹Ÿä¸åšã€‚ ä»¥å¤ªç½‘é‡‡ç”¨çš„åè®®æ˜¯å…·æœ‰å†²çªæ£€æµ‹çš„è¼‰æ³¢ç›‘å¬å¤šç‚¹æ¥å…¥ CSMA/CDã€‚åè®®çš„è¦ç‚¹æ˜¯:å‘é€å‰å…ˆç›‘å¬ï¼Œè¾¹å‘é€è¾¹ç›‘å¬ï¼Œä¸€æ—¦å‘ç°æ€»çº¿ä¸Šå‡ºç°äº†ç¢°æ’ï¼Œå°±ç«‹å³åœæ­¢å‘é€ã€‚ç„¶åæŒ‰ç…§é€€é¿ç®—æ³•ç­‰å¾…ä¸€æ®µéšæœºæ—¶é—´åå†æ¬¡å‘é€ã€‚å› æ­¤ï¼Œæ¯ä¸€ä¸ªç«™åœ¨è‡ªå·±å‘é€æ•°æ®ä¹‹åçš„ä¸€å°æ®µæ—¶é—´å†…ï¼Œå­˜åœ¨ç€é­é‡ç¢°æ’çš„å¯èƒ½æ€§ã€‚ä»¥å¤ªç½‘ä¸Šå„ç«™ç‚¹éƒ½å¹³ç­‰åœ°äº‰ç”¨ä»¥å¤ªç½‘ä¿¡é“ã€‚ ä¼ ç»Ÿçš„æ€»çº¿ä»¥å¤ªç½‘åŸºæœ¬ä¸Šéƒ½æ˜¯ä½¿ç”¨é›†çº¿å™¨çš„åŒç»çº¿ä»¥å¤ªç½‘ã€‚è¿™ç§ä»¥å¤ªç½‘åœ¨ç‰©ç†ä¸Šæ˜¯æ˜Ÿå½¢ç½‘ï¼Œä½†åœ¨é€»è¾‘ä¸Šåˆ™æ˜¯æ€»çº¿å½¢ç½‘ã€‚é›†çº¿å™¨å·¥ä½œåœ¨ç‰©ç†å±‚ï¼Œå®ƒçš„æ¯ä¸ªæ¥å£ä»…ä»…ç®€å•åœ°è½¬å‘æ¯”ç‰¹ä¸è¿›è¡Œç¢°æ’æ£€æµ‹ã€‚ ä»¥å¤ªç½‘çš„ç¡¬ä»¶åœ°å€ï¼Œå³MACåœ°å€äº‹å®ä¸Šå°±æ˜¯é€‚é…å™¨åœ°å€æˆ–é€‚é…å™¨æ ‡è¯†ç¬¦ï¼Œä¸ä¸»æœºæ‰€åœ¨çš„åœ°ç‚¹æ— å…³ã€‚æºåœ°å€å’Œç›®çš„åœ°å€éƒ½æ˜¯48ä½é•¿ã€‚ ä»¥å¤ªç½‘çš„é€‚é…å™¨æœ‰è¿‡æ»¤åŠŸèƒ½ï¼Œå®ƒåªæ¥æ”¶å•æ’­å¸§ã€å¹¿æ’­å¸§æˆ–å¤šæ’­å¸§ã€‚ ä½¿ç”¨é›†çº¿å™¨å¯ä»¥åœ¨ç‰©ç†å±‚æ‰©å±•ä»¥å¤ªç½‘(æ‰©å±•åçš„ä»¥å¤ªç½‘ä»ç„¶æ˜¯ä¸€ä¸ªç½‘ç»œ)ã€‚ äº¤æ¢å¼é›†çº¿å™¨å¸¸ç§°ä¸ºä»¥å¤ªç½‘äº¤æ›æœºæˆ–ç¬¬äºŒå±‚äº¤æ¢æœº(å·¥ä½œåœ¨æ•°æ®é“¾è·¯å®ƒå°±æ˜¯ä¸ªå¤šæ¥å£çš„ç½‘æ¡¥ï¼‰ï¼Œè€Œæ¯ä¸ªæ¥å£éƒ½ç›´æ¥ä¸æŸå°å•ä¸»æœºæˆ–å¦ä¸€ä¸ªé›†çº¿å™¨ç›¸è¿ï¼Œä¸”å·¥ä½œåœ¨å…¨åŒå·¥æ–¹å¼ã€‚ ä»¥å¤ªç½‘äº¤æ¢æœºå…¶å®å°±æ˜¯ä¸ªå¤šæ¥å£çš„ç½‘æ¡¥ï¼Œèƒ½åŒæ—¶è¿é€šè®¸å¤šå¯¹çš„æ¥å£ï¼Œä½¿æ¯ä¸€å¯¹ç›¸äº’é€šä¿¡çš„ä¸»æœºéƒ½èƒ½åƒç‹¬å é€šä¿¡åª’ä½“é‚£æ ·ï¼Œæ— ç¢°æ’åœ°ä¼ è¾“æ•°æ®ã€‚ é«˜é€Ÿä»¥å¤ªç½‘æœ‰100Mitsçš„å¿«é€Ÿä»¥å¤ªç½‘ã€å‰æ¯”ç‰¹ä»¥å¤ªç½‘å’Œ10 Gbit/sçš„10å‰æ¯”ç‰¹ä»¥å¤ªç½‘ã€‚æœ€è¿‘è¿˜å‘å±•åˆ°100å‰æ¯”ç‰¹ä»¥å¤ªç½‘ã€‚åœ¨å®½å¸¦æ¥å…¥æŠ€æœ¯ä¸­ï¼Œä¹Ÿå¸¸ä½¿ç”¨é«˜é€Ÿä»¥å¤ªç½‘è¿›è¡Œæ¥å…¥ã€‚ ç½‘ç»œå±‚ TCP/IPä½“ç³»ä¸­çš„ç½‘ç»œå±‚å‘ä¸Šåªæä¾›ç®€å•çµæ´»çš„ã€æ— è¿æ¥çš„ã€å°½æœ€å¤§åŠªåŠ›äº¤ä»˜çš„æ•°æ®æŠ¥æœåŠ¡ã€‚ç½‘ç»œå±‚ä¸æä¾›æœåŠ¡è´¨é‡çš„æ‰¿è¯ºï¼Œä¸ä¿è¯åˆ†ç»„äº¤ä»˜çš„æ—¶é™ï¼Œæ‰€ä¼ é€çš„åˆ†ç»„å¯èƒ½å‡ºé”™ã€ä¸¢å¤±ã€é‡å¤å’Œå¤±åºã€‚è¿›ç¨‹ä¹‹é—´é€šä¿¡çš„å¯é æ€§ç”±è¿è¾“å±‚è´Ÿè´£ã€‚ IPç½‘æ˜¯è™šæ‹Ÿçš„ï¼Œå› ä¸ºä»ç½‘ç»œå±‚ä¸Šçœ‹ï¼ŒIPç½‘å°±æ˜¯ä¸€ä¸ªç»Ÿä¸€çš„ã€æŠ½è±¡çš„ç½‘ç»œ(å®é™…ä¸Šæ˜¯å¼‚æ„çš„)ã€‚IPå±‚æŠ½è±¡çš„äº’è”ç½‘å±è”½äº†ä¸‹å±‚ç½‘ç»œå¾ˆå¤æ‚çš„ç»†èŠ‚ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ç»Ÿä¸€çš„ã€æŠ½è±¡çš„IPåœ°å€å¤„ç†ä¸»æœºä¹‹é—´çš„é€šä¿¡é—®é¢˜ã€‚ åœ¨äº’è”ç½‘ä¸Šçš„äº¤ä»˜æœ‰ä¸¤ç§:åœ¨æœ¬ç½‘ç»œä¸Šçš„ç›´æ¥äº¤ä»˜(ä¸ç»è¿‡è·¯ç”±å™¨)å’Œåˆ°å…¶ä»–ç½‘ç»œçš„é—´æ¥äº¤ä»˜(ç»è¿‡è‡³å°‘ä¸€ä¸ªè·¯ç”±å™¨ï¼Œä½†æœ€åä¸€æ¬¡ä¸€å®šæ˜¯ç›´æ¥äº¤ä»˜)ã€‚ ä¸€ä¸ªIPåœ°å€åœ¨æ•´ä¸ªäº’è”ç½‘èŒƒå›´å†…æ˜¯å”¯ä¸€çš„ã€‚åˆ†ç±»çš„IPåœ°å€åŒ…æ‹¬Aç±»ã€Bç±»å’ŒCç±»åœ°å€(å•æ’­åœ°å€)ï¼Œä»¥åŠDç±»åœ°å€(å¤šæ’­åœ°å€)ã€‚Eç±»åœ°å€æœªä½¿ç”¨ã€‚ åˆ†ç±»çš„IPåœ°å€ç”±ç½‘ç»œå·å­—æ®µ(æŒ‡æ˜ç½‘ç»œ)å’Œä¸»æœºå·å­—æ®µ(æŒ‡æ˜ä¸»æœº)ç»„æˆã€‚ç½‘ç»œå·å­—æ®µæœ€å‰é¢çš„ç±»åˆ«ä½æŒ‡æ˜IPåœ°å€çš„ç±»åˆ«ã€‚ IPåœ°å€æ˜¯ä¸€ç§åˆ†ç­‰çº§çš„åœ°å€ç»“æ„ã€‚IPåœ°å€ç®¡ç†æœºæ„åœ¨åˆ†é…IPåœ°å€æ—¶åªåˆ†é…ç½‘ç»œå·ï¼Œè€Œä¸»æœºå·åˆ™ç”±å¾—åˆ°è¯¥ç½‘ç»œå·çš„å•ä½è‡ªè¡Œåˆ†é…ã€‚è·¯ç”±å™¨ä»…æ ¹æ®ç›®çš„ä¸»æœºæ‰€è¿æ¥çš„ç½‘ç»œå·æ¥è½¬å‘åˆ†ç»„ã€‚ IPåœ°å€æ ‡å¿—ä¸€å°ä¸»æœº(æˆ–è·¯ç”±å™¨)å’Œä¸€æ¡é“¾è·¯çš„æ¥å£ã€‚å¤šå½’å±ä¸»æœºåŒæ—¶è¿æ¥åˆ°ä¸¤ä¸ªæˆ–æ›´å¤šçš„ç½‘ç»œä¸Šã€‚è¿™æ ·çš„ä¸»æœºåŒæ—¶å…·æœ‰ä¸¤ä¸ªæˆ–æ›´å¤šçš„IPåœ°å€ï¼Œå…¶ç½‘ç»œå·å¿…é¡»ä¸åŒçš„ã€‚ç”±äºä¸€ä¸ªè·¯ç”±å™¨è‡³å°‘åº”å½“è¿æ¥åˆ°ä¸¤ä¸ªç½‘ç»œï¼Œå› æ­¤ä¸€ä¸ªè·¯ç”±å™¨è‡³å°‘åº”å½“æœ‰2ä¸ªä¸åŒçš„IPåœ°å€ã€‚ æŒ‰ç…§äº’è”ç½‘çš„è§‚ç‚¹ï¼Œç”¨è½¬å‘å™¨æˆ–ç½‘æ¡¥è¿æ¥èµ·æ¥çš„è‹¥å¹²ä¸ªå±€åŸŸç½‘ä»ä¸ºä¸€ä¸ªç½‘ç»œã€‚æ‰€åˆ†é…åˆ°ç½‘ç»œå·çš„ç½‘ç»œ(ä¸ç®¡æ˜¯èŒƒå›´å¾ˆå°çš„å±€åŸŸç½‘ï¼Œè¿˜æ˜¯å¯èƒ½è¦†ç›–å¾ˆå¤§åœ°ç†èŒƒå›´çš„åŸŸç½‘)éƒ½æ˜¯å¹³ç­‰çš„ã€‚ ç‰©ç†åœ°å€(å³ç¡¬ä»¶åœ°å€)æ˜¯æ•°æ®é“¾è·¯å±‚å’Œç‰©ç†å±‚ä½¿ç”¨çš„åœ°å€ï¼Œè€ŒPåœ°å€æ˜¯ç½‘ç»œå’Œä»¥ä¸Šå„å±‚ä½¿ç”¨çš„åœ°å€ï¼Œæ˜¯ä¸€ç§é€»è¾‘åœ°å€(ç”¨è½¯ä»¶å®ç°çš„)ï¼Œåœ¨æ•°æ®è·¯å±‚çœ‹ä¸è§æ•°æ®æŠ¥çš„IPåœ°å€ã€‚ IPæ•°æ®æŠ¥åˆ†ä¸ºé¦–éƒ¨å’Œæ•°æ®ä¸¤éƒ¨åˆ†ã€‚é¦–éƒ¨çš„å‰ä¸€éƒ¨åˆ†æ˜¯å›ºå®šé•¿åº¦ï¼Œå…±20å­—èŠ‚ï¼Œæ˜¯æ‰€æœ‰IPæ•°æ®æŠ¥å¿…é¡»å…·æœ‰çš„(æºåœ°å€ã€ç›®çš„åœ°å€ã€æ€»é•¿åº¦ç­‰é‡è¦å­—æ®µéƒ¨åœ¨å®šé¦–éƒ¨ä¸­)ã€‚ä¸€äº›é•¿åº¦å¯å˜çš„å¯é€‰å­—æ®µæ”¾åœ¨å›ºå®šé¦–éƒ¨çš„åé¢ã€‚ IPé¦–éƒ¨ä¸­çš„ç”Ÿå­˜æ—¶é—´å­—æ®µç»™å‡ºäº†IPæ•°æ®æŠ¥åœ¨äº’è”ç½‘ä¸­æ‰€èƒ½ç»è¿‡çš„æœ€å¤§è·¯ç”±å™¨æ•°ï¼Œå¯é˜²æ­¢IPæ•°æ®æŠ¥åœ¨äº’è”ç½‘ä¸­æ— é™åˆ¶åœ°å…œåœˆå­ã€‚ åœ°å€è§£æåè®®ARPæŠŠIPåœ°å€è§£æä¸ºç¡¬ä»¶åœ°å€ï¼Œå®ƒè§£å†³åŒä¸€ä¸ªå±€åŸŸç½‘ä¸Šçš„ä¸»æœºæˆ–è·¯ç”±å™¨çš„IPåœ°å€å’Œç¡¬ä»¶åœ°å€çš„æ˜ å°„é—®é¢˜ã€‚ARPçš„é«˜é€Ÿç¼“å­˜å¯ä»¥å¤§å¤§å‡å°‘ç½‘ç»œä¸Šçš„é€šä¿¡é‡ã€‚ åœ¨äº’è”ç½‘ä¸­ï¼Œæˆ‘ä»¬æ— æ³•ä»…æ ¹æ®ç¡¬ä»¶åœ°å€å¯»æ‰¾åˆ°åœ¨æŸä¸ªç½‘ç»œä¸Šçš„æŸå°ä¸»æœºã€‚å› æ­¤ï¼Œä»IPåœ°å€åˆ°ç¡¬ä»¶åœ°å€çš„è§£ææ˜¯éå¸¸å¿…è¦çš„ã€‚ æ— åˆ†ç±»åŸŸé—´è·¯ç”±é€‰æ‹©CIDRæ˜¯è§£æ±ºç›®å‰IPåœ°å€ç´§ç¼ºçš„ä¸€ä¸ªå¥½æ–¹æ³•ã€‚CIDRè®°æ³•æŠŠIPåœ°å€åé¢åŠ ä¸Šæ–œçº¿â€/â€œï¼Œç„¶åå†™ä¸Šå‰ç¼€æ‰€å çš„ä½æ•°ã€‚å‰(æˆ–ç½‘ç»œå‰çº§)ç”¨æ¥æŒ‡ æ˜ç½‘ç»œï¼Œå‰ç¼€åé¢çš„éƒ¨åˆ†æ˜¯åç¼€ï¼Œç”¨æ¥æŒ‡æ˜ä¸»æœºã€‚CIDRæŠŠå‰ç»¶éƒ½ç›¸åŒçš„è¿ç»­çš„IPåœ°å€ç»„æˆä¸€ä¸ªâ€œCIDRåœ°å€å—â€ã€‚IPåœ°å€çš„åˆ†é…éƒ½ä»¥CIDRåœ°å€å—ä¸ºå•ä½ã€‚ CIDRçš„32ä½åœ°å€æ©ç (æˆ–å­ç½‘æ©ç )ç”±ä¸€ä¸²1å’Œä¸€ä¸²0ç»„æˆï¼Œè€Œ1çš„ä¸ªæ•°å°±æ˜¯å‰ç¼€çš„é•¿åº¦ã€‚åªè¦æŠŠIPåœ°å€å’Œåœ°å€æ©ç é€ä½è¿›è¡Œâ€œé€»è¾‘ä¸(AND)â€è¿ç®—ï¼Œå°±å¾ˆå®¹æ˜“å¾—å‡ºç½‘ç»œåœ°å€Aç±»åœ°å€çš„é»˜è®¤åœ°å€æ©ç æ˜¯25500ã€‚Bç±»åœ°å€çš„é»˜è®¤åœ°å€ç æ˜¯255250.0ã€‚Cç±»åœ°å€çš„é»˜è®¤åœ°å€æ©ç æ˜¯255.2552550. è·¯ç”±èšåˆ(æŠŠè®¸å¤šå‰ç¼€ç›¸åŒçš„åœ°å€ç”¨ä¸€ä¸ªæ¥ä»£æ›¿)æœ‰åˆ©äºå‡å°‘è·¯ç”±è¡¨ä¸­çš„é¡¹ç›®ï¼Œå‡å°‘è·¯ç”±å™¨ä¹‹é—´çš„è·¯ç”±é€‰æ‹©ä¿¡æ¯çš„äº¤æ¢ï¼Œä»è€Œæé«˜äº†æ•´ä¸ªäº’è”ç½‘çš„æ€§èƒ½ã€‚ â€œè½¬å‘â€å’Œâ€œè·¯ç”±é€‰æ‹©â€æœ‰åŒºåˆ«ã€‚â€œè½¬å‘â€æ˜¯å•ä¸ªè·¯ç”±å™¨çš„åŠ¨ä½œã€‚â€œè·¯ç”±é€‰æ‹©â€æ˜¯è®¸ å¤šç”±ç½®å…±åŒé¼“ä½œçš„è¿‡ç¨‹ï¼Œè¿™äº›è·¯ç”±å™¨ç›¸ç«‹äº¤æ¢ä¿¡æ¯ï¼Œç›®çš„æ˜¯ç”Ÿæˆè·¯ç”±è¡¨ï¼Œå†ä»è·¯ç”±è¡¨å¯¼å‡ºè½¬å‘è¡¨ã€‚è‹¥é‡‡ç”¨è‡ªé€‚åº”è·¯ç”±é€‰æ‹©ç®—æ³•ï¼Œåˆ™å½“ç½‘ç»œæ‹“æ‰‘å˜åŒ–æ—¶ï¼Œè·¯ç”±è¡¨å’Œè½¬å‘è¡¨éƒ½èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œå¯ä»¥ä¸è€ƒè™‘è½¬å‘è¡¨å’Œè·¯ç”±è¡¨çš„åŒºåˆ«ï¼Œè€Œéƒ½ä½¿ç”¨è·¯ç”±è¡¨è¿™ä¸€åè¯ã€‚ è‡ªæ²»ç³»ç»Ÿ(AS)å°±æ˜¯åœ¨å•ä¸€çš„æŠ€æœ¯ç®¡ç†ä¸‹çš„ä¸€ç»„è·¯ç”±å™¨ã€‚ä¸€ä¸ªè‡ªæ²»ç³»ç»Ÿå¯¹å…¶ä»–å®ƒè‡ªæ²»ç³»ç»Ÿè¡¨ç°å‡ºçš„æ˜¯ä¸€ä¸ªå•ä¸€çš„å’Œä¸€è‡´çš„è·¯ç”±é€‰æ‹©ç­–ç•¥ã€‚ è·¯ç”±é€‰æ‹©åè®®æœ‰ä¸¤å¤§ç±»:å†…éƒ¨ç½‘å…³åè®®(æˆ–è‡ªæ²»ç³»ç»Ÿå†…éƒ¨çš„è·¯ç”±é€‰æ‹©åè®®)ï¼Œå¦‚RIPå’ŒOSPï¼›å¤–éƒ¨ç½‘å…³åè®®(æˆ–è‡ªæ²»ç³»ç»Ÿä¹‹é—´çš„è·¯ç”±é€‰æ‹©åè®®)ï¼Œå¦‚BGP-4ã€‚ RIPæ˜¯åˆ†å¸ƒå¼çš„åŸºäºè·ç¦»å‘é‡çš„è·¯ç”±é€‰æ‹©åè®®ï¼Œåªé€‚ç”¨äºå°å‹äº’è”ç½‘ã€‚RIPæŒ‰å›ºå®šçš„æ—¶é—´é—´éš”ä¸ç›¸é‚»è·¯ç”±å™¨äº¤æ¢ä¿¡æ¯ã€‚äº¤æ¢çš„ä¿¡æ¯æ˜¯è‡ªå·±å½“å‰çš„è·¯ç”±è¡¨ï¼Œå³åˆ°è¾¾æœ¬è‡ªæ²»ç³»ç»Ÿä¸­æ‰€æœ‰ç½‘ç»œçš„(æœ€çŸ­)è·ç¦»ï¼Œä»¥åŠåˆ°æ¯ä¸ªç½‘ç»œåº”ç»è¿‡çš„ä¸‹ä¸€è·³è·¯ç”±å™¨ã€‚ OSPFæ˜¯åˆ†å¸ƒå¼çš„é“¾è·¯çŠ¶æ€åè®®ï¼Œé€‚ç”¨äºå¤§å‹äº’è”ç½‘ã€‚OSPFåªåœ¨é“¾è·¯çŠ¶æ€å‘ç”Ÿ åŒ–æ—¶ï¼Œæ‰å‘æœ¬è‡ªæ²»ç³»ç»Ÿä¸­çš„æ‰€æœ‰è·¯ç”±å™¨ï¼Œç”¨æ´ªæ³›æ³•å‘é€ä¸æœ¬è·¯ç”±å™¨ç›¸é‚»çš„æ‰€æœ‰è·¯ç”±å™¨çš„é“¾è·¯çŠ¶æ€ä¿¡æ¯ã€‚â€œé“¾è·¯çŠ¶æ€â€æŒ‡æ˜æœ¬è·¯ç”±å™¨éƒ½å’Œå“ªäº›è·¯ç”±å™¨ç›¸é‚»ï¼Œä»¥åŠè¯¥é“¾è·¯çš„â€œåº¦é‡â€ã€‚â€œåº¦é‡â€å¯è¡¨ç¤ºè´¹ç”¨ã€è·ç¦»ã€æ—¶å»¶ã€å¸¦å®½ç­‰ï¼Œå¯ç»Ÿç§°ä¸ºâ€œä»£ä»·â€ã€‚æ‰€æœ‰çš„è·¯ç”±å™¨æœ€ç»ˆéƒ½èƒ½å»ºç«‹ä¸€ä¸ªå…¨ç½‘çš„æ‹“æ‰‘ç»“æ„å›¾ã€‚ BGP4æ˜¯ä¸åŒASçš„è·¯ç”±å™¨ä¹‹é—´äº¤æ¢è·¯ç”±ä¿¡æ¯çš„åè®®ï¼Œæ˜¯ä¸€ç§è·¯å¾„å‘é‡è·¯ç”±é€‰æ‹©åè®®ã€‚BGPåŠ›æ±‚å¯»æ‰¾ä¸€æ¡èƒ½å¤Ÿåˆ°è¾¾ç›®çš„ç½‘ç»œ(å¯è¾¾)ä¸”æ¯”è¾ƒå¥½çš„è·¯ç”±(ä¸å…œåœˆå­)ï¼Œè€Œå¹¶éè¦å¯»æ‰¾ä¸€æ¡æœ€ä½³è·¯ç”±ã€‚ ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMPæ˜¯IPå±‚çš„åè®®ã€‚ICMPæŠ¥æ–‡ä½œä¸ºIPæ•°æ®æŠ¥çš„æ•°æ®ï¼ŒåŠ ä¸Šé¦–éƒ¨åç»„æˆIPæ•°æ®æŠ¥å‘é€å‡ºå»ã€‚ä½¿ç”¨ICMPå¹¶éä¸ºäº†å®ç°å¯é ä¼ è¾“ã€‚ICMPå…è®¸ä¸»æœºæˆ–è·¯ç”±å™¨æŠ¥å‘Šå·®é”™æƒ…å†µå’Œæä¾›æœ‰å…³å¼‚å¸¸æƒ…å†µçš„æŠ¥å‘Šã€‚ICMPæŠ¥æ–‡çš„ç§ç±»æœ‰ä¸¤ç§ï¼Œå³ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡å’ŒICMPè¯¢é—®æŠ¥æ–‡ã€‚ ICMPçš„ä¸€ä¸ªé‡è¦åº”ç”¨å°±æ˜¯åˆ†ç»„ç½‘é—´æ¢æµ‹PINGï¼Œç”¨æ¥æµ‹è¯•ä¸¤å°ä¸»æœºä¹‹é—´çš„è¿é€šæ€§ã€‚PINGä½¿ç”¨äº†ICMPå›é€è¯·æ±‚ä¸å›é€å›ç­”æŠ¥æ–‡ã€‚ è¦è§£å†³IPåœ°å€è€—å°½çš„é—®é¢˜ï¼Œæœ€æ ¹æœ¬çš„åŠæ³•å°±æ˜¯é‡‡ç”¨å…·æœ‰æ›´å¤§åœ°å€ç©ºé—´çš„æ–°ç‰ˆæœ¬çš„IPåè®®ï¼Œå³IPv6ã€‚ IPV6æ‰€å¸¦æ¥çš„ä¸»è¦å˜åŒ–æ˜¯:(1)æ›´å¤§çš„åœ°å€ç©ºé—´(é‡‡ç”¨128ä½çš„åœ°å€):(2)çµæ´»çš„é¦–éƒ¨æ ¼å¼:(3)æ”¹è¿›çš„é€‰é¡¹:(4)æ”¯æŒå³æ’å³ç”¨:(5)æ”¯æŒèµ„æºçš„é¢„åˆ†é…:(6)IPv6çš„é¦–éƒ¨æ”¹ä¸º8å­—èŠ‚å¯¹é½ã€‚ IPv6æ•°æ®æŠ¥åœ¨åŸºæœ¬é¦–éƒ¨çš„åé¢å…è®¸æœ‰é›¶ä¸ªæˆ–å¤šä¸ªæ‰©å±•é¦–éƒ¨ï¼Œå†åé¢æ˜¯æ•°æ®ã€‚æ‰€æœ‰çš„æ‰©å±•é¦–éƒ¨å’Œæ•°æ®åˆèµ·æ¥å«åšæ•°æ®æŠ¥çš„æœ‰æ•ˆè½½è·æˆ–å‡€è´Ÿè·ã€‚ IPv6æ•°æ®æŠ¥çš„ç›®çš„åœ°å€å¯ä»¥æ˜¯ä»¥ä¸‹ä¸‰ç§åŸºæœ¬ç±»å‹åœ°å€ä¹‹ä¸€:å•æ’­ã€å¤šæ’­å’Œä»»æ’­ã€‚ IPv6çš„åœ°å€ä½¿ç”¨å†’å·åå…­è¿›åˆ¶è®°æ³•ã€‚ å‘IPV6è¿‡æ¸¡åªèƒ½é‡‡ç”¨é€æ­¥æ¼”è¿›çš„åŠæ³•ï¼Œå¿…é¡»ä½¿æ–°å®‰è£…çš„IPv6ç³»ç»Ÿèƒ½å¤Ÿå‘åå…¼å®¹å‘IPw6è¿‡æ¸¡å¯ä»¥ä½¿ç”¨åŒåè®®æ ˆæˆ–ä½¿ç”¨éš§é“æŠ€æœ¯ã€‚ ä¸å•æ’­ç›¸æ¯”ï¼Œåœ¨ä¸€å¯¹å¤šçš„é€šä¿¡ä¸­ï¼ŒIPå¤šæ’­å¯å¤§å¤§èŠ‚çº¦ç½‘ç»œèµ„æºã€‚IPå¤šæ’­ä½¿ç”¨Dç±»IPåœ°å€ã€‚IPå¤šæ’­éœ€è¦ä½¿ç”¨ç½‘é™…ç»„ç®¡ç†åè®®IGMPå’Œå¤šæ’­è·¯ç”±é€‰æ‹©åè®®ã€‚ è™šæ‹Ÿä¸“ç”¨ç½‘VPNåˆ©ç”¨å…¬ç”¨çš„äº’è”ç½‘ä½œä¸ºæœ¬æœºæ„å„ä¸“ç”¨ç½‘ä¹‹é—´çš„é€šä¿¡è½½ä½“ã€‚VPNå†…éƒ¨ä½¿ç”¨äº’è”ç½‘çš„ä¸“ç”¨åœ°å€ã€‚ãƒ¼ä¸ªVPNè‡³å°‘è¦æœ‰ä¸€ä¸ªè·¯ç”±å™¨å…·æœ‰åˆæ³•çš„å…¨çƒIPåœ°å€ï¼Œè¿™æ ·ã‚ªèƒ½å’Œæœ¬ç³»ç»Ÿçš„å¦ãƒ¼ä¸ªVPNé€šè¿‡äº’è”ç½‘è¿›è¡Œé€šä¿¡ã€‚æ‰€æœ‰é€šè¿‡äº’è”ç½‘ä¼ é€çš„æ•°æ®éƒ½å¿…é¡»åŠ å¯†ã€‚ ä½¿ç”¨ç½‘ç»œåœ°å€è½¬æ¢NATæŠ€æœ¯ï¼Œå¯ä»¥åœ¨ä¸“ç”¨ç½‘ç»œå†…éƒ¨ä½¿ç”¨ä¸“ç”¨IPåœ°å€ï¼Œè€Œä»…åœ¨è¿æ¥åˆ°äº’è”ç½‘çš„è·¯ç”±å™¨ä½¿ç”¨å…¨çƒPåœ°å€ã€‚è¿™æ ·å°±å¤§å¤§èŠ‚çº¦äº†å®è´µçš„IPåœ°å€ã€‚ MPLSçš„ç‰¹ç‚¹:(1)æ”¯æŒé¢å‘è¿æ¥çš„æœåŠ¡è´¨é‡ï¼›(2)æ”¯æŒæµé‡å·¥ç¨‹ï¼Œå¹³è¡¡ç½‘ç»œè´Ÿè½½:(3)æœ‰æ•ˆåœ°æ”¯æŒè™šæ‹Ÿä¸“ç”¨ç½‘VPNã€‚ MPLSåœ¨å…¥å£ç»“ç‚¹ç»™æ¯ä¸€ä¸ªIPæ•°æ®æŠ¥æ‰“ä¸Šå›ºå®šé•¿åº¦çš„â€œæ ‡è®°â€ï¼Œç„¶åæ ¹æ®æ ‡è®°åœ¨ç¬¬äºŒå±‚(é“¾è·¯å±‚)ç”¨ç¡¬ä»¶è¿›è¡Œè½¬å‘(åœ¨æ ‡è®°äº¤æ¢è·¯ç”±å™¨ä¸­è¿›è¡Œæ ‡è®°å¯¹æ¢)ï¼Œå› è€Œè½¬å‘é€Ÿç‡å¤§å¤§åŠ å¿«ã€‚ è¿è¾“å±‚ è¿è¾“å±‚æä¾›åº”ç”¨è¿›ç¨‹é—´çš„é€»è¾‘é€šä¿¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿è¾“å±‚ä¹‹é—´çš„é€šä¿¡å¹¶ä¸æ˜¯çœŸæ­£åœ¨ä¸¤ ä¸ªè¿è¾“å±‚ä¹‹é—´ç›´æ¥ä¼ é€æ•°æ®ã€‚è¿è¾“å±‚å‘åº”ç”¨å±‚å±è”½äº†ä¸‹é¢ç½‘ç»œçš„ç»†èŠ‚(å¦‚ç½‘ç»œæ‹“æ‰‘ã€æ‰€é‡‡ç”¨çš„è·¯ç”±é€‰æ‹©åè®®ç­‰)ï¼Œå®ƒä½¿åº”ç”¨è¿›ç¨‹çœ‹è§çš„å°±æ˜¯å¥½åƒåœ¨ä¸¤ä¸ªè¿è¾“å±‚å®ä½“ä¹‹é—´æœ‰ä¸€æ¡ç«¯åˆ°ç«¯çš„é€»è¾‘é€šä¿¡ä¿¡é“ã€‚ ç½‘ç»œå±‚ä¸ºä¸»æœºä¹‹é—´æä¾›é€»è¾‘é€šä¿¡ï¼Œè€Œè¿è¾“å±‚ä¸ºåº”ç”¨è¿›ç¨‹ä¹‹é—´æä¾›ç«¯åˆ°ç«¯çš„é€»è¾‘é€šä¿¡ã€‚ è¿è¾“å±‚æœ‰ä¸¤ä¸ªä¸»è¦çš„åè®®:TCPå’ŒUDPã€‚å®ƒä»¬éƒ½æœ‰å¤ç”¨å’Œåˆ†ç”¨ï¼Œä»¥åŠæ£€é”™çš„åŠŸèƒ½ã€‚å½“è¿è¾“å±‚é‡‡ç”¨é¢å‘è¿æ¥çš„TCPåè®®æ—¶ï¼Œå°½ç®¡ä¸‹é¢çš„ç½‘ç»œæ˜¯ä¸å¯é çš„(åªæä¾›å°½æœ€å¤§åŠªåŠ›æœåŠ¡)ï¼Œä½†è¿™ç§é€»è¾‘é€šä¿¡ä¿¡é“å°±ç›¸å½“äºä¸€æ¡å…¨åŒå·¥é€šä¿¡çš„å¯é ä¿¡é“ã€‚å½“è¿è¾“å±‚é‡‡ç”¨æ— è¿æ¥çš„UDPåè®®æ—¶ï¼Œè¿™ç§é€»è¾‘é€šä¿¡ä¿¡é“ä»ç„¶æ˜¯ä¸€æ¡ä¸å¯é ä¿¡é“ã€‚ è¿è¾“å±‚ç”¨ä¸€ä¸ª16ä½ç«¯å£å·æ¥æ ‡å¿—ä¸€ä¸ªç«¯å£ã€‚ç«¯å£å·åªå…·æœ‰æœ¬åœ°æ„ä¹‰ï¼Œå®ƒåªæ˜¯ä¸ºäº†æ ‡å¿—æœ¬è®¡ç®—æœºåº”ç”¨å±‚ä¸­çš„å„ä¸ªè¿›ç¨‹åœ¨å’Œè¿è¾“å±‚äº¤äº’æ—¶çš„å±‚é—´æ¥å£ã€‚åœ¨äº’è”ç½‘çš„ä¸åŒè®¡ç®—æœºä¸­ï¼Œç›¸åŒçš„ç«¯å£å·æ˜¯æ²¡æœ‰å…³è”çš„ã€‚ ä¸¤å°è®¡ç®—æœºä¸­çš„è¿›ç¨‹è¦äº’ç›¸é€šä¿¡ï¼Œä¸ä»…è¦çŸ¥é“å¯¹æ–¹çš„IPåœ°å€(ä¸ºäº†æ‰¾åˆ°å¯¹æ–¹çš„è®¡ç®—æœº)ï¼Œè€Œä¸”è¿˜è¦çŸ¥é“å¯¹æ–¹çš„ç«¯å£å·(ä¸ºäº†æ‰¾åˆ°å¯¹æ–¹è®¡ç®—æœºä¸­çš„åº”ç”¨è¿›ç¨‹)ã€‚ è¿è¾“å±‚çš„ç«¯å£å·åˆ†ä¸ºæœåŠ¡å™¨ç«¯ä½¿ç”¨çš„ç«¯å£å·(0~1023æŒ‡æ´¾ç»™ç†ŸçŸ¥ç«¯å£ï¼Œ1024~49151æ˜¯ç™»è®°ç«¯å£å·)å’Œå®¢æˆ·ç«¯æš«æ—¶ä½¿ç”¨çš„ç«¯å£å·(49152~65535)ã€‚ UDPçš„ä¸»è¦ç‰¹ç‚¹æ˜¯:(1)æ— è¿æ¥:(2)å°½æœ€å¤§åŠªåŠ›äº¤ä»˜:(3)é¢å‘æŠ¥æ–‡ï¼›(4)æ— æ‹¥å¡æ§åˆ¶:(5)æ”¯æŒä¸€å¯¹å¯¹å¤šã€å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„äº¤äº’é€šä¿¡ï¼›(6)é¦–éƒ¨å¼€é”€å°(åªæœ‰å››ä¸ªå­—æ®µ:æºç«¯å£ã€ç›®çš„ç«¯å£ã€é•¿åº¦ã€æ£€éªŒå’Œ) TCPçš„ä¸»è¦ç‰¹ç‚¹æ˜¯:(1)é¢å‘è¿æ¥ï¼›(2)æ¯ä¸€æ¡TCPè¿æ¥åªèƒ½æ˜¯ç‚¹å¯¹ç‚¹çš„(ä¸€å¯¹ä¸€):(3)æä¾›å¯é äº¤ä»˜çš„æœåŠ¡:(4)æä¾›å…¨åŒå·¥é€šä¿¡:(5)é¢å‘å­—èŠ‚æµã€‚ TCPç”¨ä¸»æœºçš„IPåœ°å€åŠ ä¸Šä¸»æœºä¸Šçš„ç«¯å£å·ä½œä¸ºTCPè¿æ¥çš„ç«¯ç‚¹ã€‚è¿™æ ·çš„ç«¯ç‚¹å°±å«åšå¥—æ¥å­—( socket)æˆ–æ’å£ã€‚å¥—æ¥å­—ç”¨(IPåœ°å€:ç«¯å£å·)æ¥è¡¨ç¤ºã€‚ åœæ­¢ç­‰å¾…åè®®èƒ½å¤Ÿåœ¨ä¸å¯é çš„ä¼ è¾“ç½‘ç»œä¸Šå®ç°å¯é çš„é€šä¿¡ã€‚æ¯å‘é€å®Œä¸€ä¸ªåˆ†ç»„å°±åœæ­¢å‘é€ï¼Œç­‰å¾…å¯¹æ–¹çš„ç¡®è®¤ã€‚åœ¨æ”¶åˆ°ç¡®è®¤åå†å‘é€ä¸‹ä¸€ä¸ªåˆ†ç»„ã€‚åˆ†ç»„éœ€è¦è¿›è¡Œç¼–å·ã€‚ è¶…æ—¶é‡ä¼ æ˜¯æŒ‡åªè¦è¶…è¿‡äº†ä¸€æ®µæ—¶é—´ä»ç„¶æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œå°±é‡ä¼ å‰é¢å‘é€è¿‡çš„åˆ†ç»„(è®¤ä¸ºåˆšã‚ªå‘é€çš„åˆ†ç»„ä¸¢å¤±äº†)ã€‚å› æ­¤æ¯å‘é€å®Œä¸€ä¸ªåˆ†ç»„éœ€è¦è®¾ç½®ä¸€ä¸ªè¶…æ—¶è®¡æ—¶å™¨ï¼Œå…¶é‡ä¼ æ—¶é—´åº”æ¯”æ•°æ®åœ¨åˆ†ç»„ä¼ è¾“çš„å¹³å‡å¾€è¿”æ—¶é—´æ›´é•¿ä¸€äº›ã€‚è¿™ç§è‡ªåŠ¨é‡ä¼ æ–¹å¼å¸¸ç§°ä¸ºè‡ªåŠ¨é‡ä¼ è¯·æ±‚ARQã€‚ åœ¨åœæ­¢ç­‰å¾…åè®®ä¸­ï¼Œè‹¥æ¥æ”¶æ–¹æ”¶åˆ°é‡å¤åˆ†ç»„ï¼Œå°±ä¸¢å¼ƒè¯¥åˆ†ç»„ï¼Œä½†åŒæ—¶è¿˜è¦å‘é€ç¡®è®¤ã€‚ è¿ç»­ARQåè®®å¯æé«˜ä¿¡é“åˆ©ç”¨ç‡ã€‚å‘é€æ–¹ç»´æŒä¸€ä¸ªå‘é€çª—å£ï¼Œå‡¡ä½äºå‘é€çª—å£å†…çš„åˆ†ç»„éƒ½å¯è¿ç»­å‘é€å‡ºå»ï¼Œè€Œä¸éœ€è¦ç­‰å¾…å¯¹æ–¹çš„ç¡®è®¤ã€‚æ¥æ”¶æ–¹ä¸€èˆ¬é‡‡ç”¨ç´¯ç§¯ç¡®è®¤ï¼Œå¯¹æŒ‰åºåˆ°è¾¾çš„æœ€åä¸€ä¸ªåˆ†ç»„å‘é€ç¡®è®¤ï¼Œè¡¨æ˜åˆ°è¿™ä¸ªåˆ†ç»„ä¸ºæ­¢çš„æ‰€æœ‰åˆ†ç»„éƒ½å·±æ­£ç¡®æ”¶åˆ°äº†ã€‚ TCPæŠ¥æ–‡æ®µé¦–éƒ¨çš„å‰20ä¸ªå­—èŠ‚æ˜¯å›ºå®šçš„ï¼Œåé¢æœ‰4Nå­—èŠ‚æ˜¯æ ¹æ®éœ€è¦è€Œå¢åŠ çš„é€‰é¡¹(Næ˜¯æ•´æ•°)ã€‚åœ¨ä¸€ä¸ªTCPè¿æ¥ä¸­ä¼ é€çš„å­—èŠ‚æµä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚éƒ½æŒ‰é¡ºåºç¼–å·ã€‚é¦–éƒ¨ä¸­çš„åºå·å­—æ®µå€¼åˆ™æŒ‡çš„æ˜¯æœ¬æŠ¥æ–‡æ®µæ‰€å‘é€çš„æ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·ã€‚ TCPé¦–éƒ¨ä¸­çš„ç¡®è®¤å·æ˜¯æœŸæœ›æ”¶åˆ°å¯¹æ–¹ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„ç¬¬ä¸€ä¸ªæ•°æ®å­—èŠ‚çš„åºå·ã€‚è‹¥ç¡®è®¤å·ä¸ºNï¼Œåˆ™è¡¨æ˜:åˆ°åºå·N-1ä¸ºæ­¢çš„æ‰€æœ‰æ•°æ®éƒ½å·²æ­£ç¡®æ”¶åˆ°ã€‚ TCPé¦–éƒ¨ä¸­çš„çª—å£å­—æ®µæŒ‡å‡ºäº†ç°åœ¨å…è®¸å¯¹æ–¹å‘é€çš„æ•°æ®é‡ã€‚çª—å£å€¼æ˜¯ç»å¸¸åœ¨åŠ¨æ€å˜åŒ–ç€çš„ã€‚ TCPä½¿ç”¨æ»‘åŠ¨çª—å£æœºåˆ¶ã€‚å‘é€çª—å£é‡Œé¢çš„åºå·è¡¨ç¤ºå…è®¸å‘é€çš„åºå·ã€‚å‘é€çª—å£åæ²¿çš„åé¢éƒ¨åˆ†è¡¨ç¤ºå·²å‘é€ä¸”å·²æ”¶åˆ°äº†ç¡®è®¤ï¼Œè€Œå‘é€çª—å£å‰æ²¿çš„å‰é¢éƒ¨åˆ†è¡¨ç¤ºä¸å…è®¸å‘é€ã€‚å‘é€çª—å£åæ²¿çš„å˜åŒ–æƒ…å†µæœ‰ä¸¤ç§å¯èƒ½ï¼Œå³ä¸åŠ¨(æ²¡æœ‰æ”¶åˆ°æ–°çš„ç¡®è®¤)å’Œå‰ç§»(æ”¶åˆ°äº†æ–°çš„ç¡®è®¤) å‘é€çª—å£å‰æ²¿é€šå¸¸æ˜¯ä¸æ–­å‘å‰ç§»åŠ¨çš„ã€‚ æµé‡æ§åˆ¶å°±æ˜¯è®©å‘é€æ–¹çš„å‘é€é€Ÿç‡ä¸è¦å¤ªå¿«ï¼Œè¦è®©æ¥æ”¶æ–¹æ¥å¾—åŠæ¥æ”¶ã€‚ åœ¨æŸæ®µæ—¶é—´ï¼Œè‹¥å¯¹ç½‘ç»œä¸­æŸä¸€èµ„æºçš„éœ€æ±‚è¶…è¿‡äº†è¯¥èµ„æºæ‰€èƒ½æä¾›çš„å¯ç”¨éƒ¨åˆ†ï¼Œç½‘ç»œçš„æ€§èƒ½å°±è¦å˜åã€‚è¿™ç§æƒ…å†µå°±å«åšæ‹¥å¡ã€‚æ‹¥å¡æ§åˆ¶å°±æ˜¯é˜²æ­¢è¿‡å¤šçš„æ•°æ®æ³¨å…¥åˆ°ç½‘ç»œä¸­ï¼Œè¿™æ ·å¯ä»¥ä½¿ç½‘ç»œä¸­çš„è·¯ç”±å™¨æˆ–é“¾è·¯ä¸è‡´è¿‡è½½ã€‚ æµé‡æ§åˆ¶æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„é—®é¢˜ï¼Œæ˜¯æ¥æ”¶ç«¯æŠ‘åˆ¶å‘é€ç«¯å‘é€æ•°æ®çš„é€Ÿç‡ï¼Œä»¥ä¾¿ä½¿æ¥æ”¶ç«¯æ¥å¾—åŠæ¥æ”¶ã€‚æ‹¥å¡æ§åˆ¶æ˜¯ä¸€ä¸ªå…¨å±€æ€§çš„è¿‡ç¨‹ï¼Œæ¶‰åŠåˆ°æ‰€æœ‰çš„ä¸»æœºã€æ‰€æœ‰çš„è·¯ç”±å™¨ï¼Œä»¥åŠä¸é™ä½ç½‘ç»œä¼ è¾“æ€§èƒ½æœ‰å…³çš„æ‰€æœ‰å› ç´ ã€‚ ä¸ºäº†è¿›è¡Œæ‹¥å¡æ§åˆ¶ã€TCPçš„å‘é€æ–¹è¦æ¨æŒä¸€ä¸ªæ‹¥å¡çª—å£cwndçš„çŠ¶æ€å˜é‡ã€‚æ‹¥å¡çª—å£çš„å¤§å°å–æ±ºäºç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ï¼Œå¹¶ä¸”åŠ¨æ€åœ°åœ¨å˜åŒ–ã€‚å‘é€æ–¹è®©è‡ªå·±çš„å‘é€çª—å£å–ä¸ºæ‹¥å¡çª—å£å’Œæ¥æ”¶æ–¹çš„æ¥æ”¶çª—å£ä¸­è¾ƒå°çš„ä¸€ä¸ªã€‚ TCPçš„æ‹¥å¡æ§åˆ¶é‡‡ç”¨äº†å››ç§ç®—æ³•ï¼Œå³æ…¢å¼€å§‹ã€æ‹¥å¡é¿å…ã€å¿«é‡ä¼ å’Œå¿«æ¢å¤ã€‚åœ¨ç½‘ç»ˆå±‚ï¼Œä¹Ÿå¯ä»¥ä½¿è·¯ç”±å™¨é‡‡ç”¨é€‚å½“çš„åˆ†ç»„ä¸¢å¼ƒç­–ç•¥(å¦‚ä¸»åŠ¨é˜Ÿåˆ—ç®¡ç†AQM)ï¼Œä»¥å‡å°‘ç½‘ç»œæ‹¥å¡çš„å‘ç”Ÿ è¿è¾“è¿æ¥æœ‰ä¸‰ä¸ªé˜¶æ®µï¼Œå³:è¿æ¥å»ºç«‹ã€æ•°æ®ä¼ é€å’Œè¿æ¥é‡Šæ”¾ã€‚ ä¸»åŠ¨å‘èµ·TCPè¿æ¥å»ºç«‹çš„åº”ç”¨è¿›ç¨‹å«åšå®¢æˆ·ï¼Œè€Œè¢«åŠ¨ç­‰å¾…è¿æ¥å»ºç«‹çš„åº”ç”¨è¿›ç¨‹åšçœ¼åŠ¡å™¨ã€‚TCPçš„è¿æ¥å»ºç«‹é‡‡ç”¨ä¸‰æŠ¥æ–‡æ¡æ‰‹æœºåˆ¶ã€‚æœåŠ¡å™¨è¦ç¡®è®¤å®¢æˆ·çš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå®¢æˆ·è¦å¯¹æœåŠ¡å™¨çš„ç¡®è®¤è¿›è¡Œç¡®è®¤ã€‚ TCPçš„è¿æ¥é‡Šæ”¾é‡‡ç”¨å››æŠ¥æ–‡æ¡æ‰‹æœºåˆ¶ã€‚ä»»ä½•ä¸€æ–¹éƒ½å¯ä»¥åœ¨æ•°æ®ä¼ é€ç»“æŸåå‘é€è¿æ¥é‡Šæ”¾çš„é€šçŸ¥ï¼Œå¾…å¯¹æ–¹ç¡®è®¤åå°±è¿›å…¥åŠå…³é—­çŠ¶æ€ã€‚å½“å¦ä¸€æ–¹ä¹Ÿæ²¡æœ‰æ•°æ®å†å‘é€æ—¶ï¼Œåˆ™å‘é€é“¾æ¥é‡Šæ”¾é€šçŸ¥ï¼Œå¯¹æ–¹ç¡®è®¤åå°±å®Œå…¨å…³é—­äº†TCPè¿æ¥æ¥é‡Šæ”¾çš„é€šçŸ¥ã€‚ åº”ç”¨å±‚ åº”ç”¨å±‚åè®®æ˜¯ä¸ºäº†è§£å†³æŸä¸€ç±»åº”ç”¨é—®é¢˜ï¼Œè€Œé—®é¢˜çš„è§£å†³åˆæ˜¯é€šè¿‡ä½äºå¤šä¸ªåº”ç”¨è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡å’ŒååŒå·¥ä½œæ¥å®Œæˆçš„ã€‚åº”ç”¨å±‚è§„å®šäº†åº”ç”¨è¿›ç¨‹åœ¨é€šä¿¡æ—¶æ‰€éµå¾ªçš„åè®®ã€‚ åº”ç”¨å±‚çš„è®¸å¤šåè®®éƒ½æ˜¯åŸºäºå®¢æˆ·æœåŠ¡å™¨æ–¹å¼çš„ã€‚å®¢æˆ·æ˜¯æœåŠ¡è¯·æ±‚æ–¹ï¼ŒæœåŠ¡å™¨æ˜¯æœåŠ¡æä¾›æ–¹ã€‚ åŸŸåç³»ç»ŸDNSæ˜¯äº’è”ç½‘ä½¿ç”¨çš„å‘½åç³»ç»Ÿï¼Œç”¨æ¥æŠŠä¾¿äºäººä»¬ä½¿ç”¨çš„æœºå™¨åå­—è½¬æ¢ä¸ºIPåœ°å€ã€‚DNSæ˜¯ä¸€ä¸ªè”æœºåˆ†å¸ƒå¼æ•°æ®åº“ç³»ç»Ÿï¼Œå¹¶é‡‡ç”¨å®¢æˆ·æœåŠ¡å™¨æ–¹å¼ã€‚ åŸŸååˆ°IPåœ°å€çš„è§£ææ˜¯ç”±åˆ†å¸ƒåœ¨äº’è”ç½‘ä¸Šçš„è®¸å¤šåŸŸåæœåŠ¡å™¨ç¨‹åº(å³åŸŸåæœåŠ¡å™¨)å…±åŒå®Œæˆçš„ã€‚ äº’è”ç½‘é‡‡ç”¨å±‚æ¬¡æ ‘çŠ¶ç»“æ„çš„å‘½åæ–¹æ³•ï¼Œä»»ä½•ä¸€å°è¿æ¥åœ¨äº’è”ç½‘ä¸Šçš„ä¸»æœºæˆ–è·¯ç”±å™¨ï¼Œéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„å±‚æ¬¡ç»“æ„çš„åå­—ï¼Œå³åŸŸåã€‚åŸŸåä¸­çš„ç‚¹å’Œç‚¹åˆ†åè¿›åˆ¶IPåœ°å€ä¸­çš„ç‚¹æ²¡æœ‰å…³ç³»ã€‚ åŸŸåæœåŠ¡å™¨åˆ†ä¸ºæ ¹åŸŸåæœåŠ¡å™¨ã€é¡¶çº§åŸŸåæœåŠ¡å™¨ã€æƒé™åŸŸåæœåŠ¡å™¨å’Œæœ¬åœ°åŸŸåæœåŠ¡å™¨ã€‚ æ–‡ä»¶ä¼ é€åè®®FTPä½¿ç”¨TCPå¯é çš„è¿è¾“æœåŠ¡ã€‚FTPä½¿ç”¨å®¢æˆ·æœåŠ¡å™¨æ–¹å¼ã€‚ä¸€ä¸ªFTPæœåŠ¡å™¨è¿›ç¨‹å¯åŒæ—¶ä¸ºå¤šä¸ªå®¢æˆ·è¿›ç¨‹æä¾›æœåŠ¡ã€‚åœ¨è¿›è¡Œæ–‡ä»¶ä¼ è¾“æ—¶ï¼ŒFTP çš„å®¢æˆ·å’ŒæœåŠ¡å™¨ä¹‹é—´è¦å»ºç«‹ä¸¤ä¸ªå¹¶è¡Œçš„TCPè¿æ¥:æ§åˆ¶è¿æ¥å’Œæ•°æ®è¿æ¥ã€‚å®é™…ç”¨äºä¼ è¾“æ–‡ä»¶çš„æ˜¯æ•°æ®è¿æ¥ã€‚ ä¸‡ç»´ç½‘wwwæ˜¯ä¸€ä¸ªå¤§è§„æ¨¡çš„ã€è”æœºå¼çš„ä¿¡æ¯å‚¨è—æ‰€ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿åœ°ä»äº’è”ç½‘ä¸Šçš„ä¸€ä¸ªç«™ç‚¹é“¾æ¥åˆ°å¦ä¸€ä¸ªç«™ç‚¹ã€‚ ä¸‡ç»´ç½‘çš„å®¢æˆ·ç¨‹åºå‘äº’è”ç½‘ä¸­çš„æœåŠ¡å™¨ç¨‹åºå‘å‡ºè¯·æ±‚ï¼ŒæœåŠ¡å™¨ç¨‹åºå‘å®¢æˆ·ç¨‹åºé€å›å®¢æˆ·æ‰€è¦çš„ä¸‡ç»´ç½‘æ–‡æ¡£ã€‚ åœ¨å®¢æˆ·ç¨‹åºä¸Šæ˜¾ç¤ºå‡ºçš„ä¸‡ç»´ç½‘æ–‡æ¡£ç§°ä¸ºé¡µé¢ã€‚ ä¸‡ç»´ç½‘ä½¿ç”¨ç»Ÿèµ„æºå®šä½ç¬¦URLæ¥æ ‡å¿—ä¸‡ç»´ç½‘ä¸Šçš„å„ç§æ–‡æ¡£ï¼Œå¹¶ä½¿æ¯ä¸€ä¸ªæ–‡æ¡£åœ¨æ•´ä¸ªäº’è”ç½‘çš„èŒƒå›´å†…å…·æœ‰å”¯ä¸€çš„æ ‡è¯†ç¬¦URLã€‚ ä¸‡ç»´ç½‘å®¢æˆ·ç¨‹åºä¸æœåŠ¡å™¨ç¨‹åºä¹‹é—´è¿›è¡Œäº¤äº’æ‰€ä½¿ç”¨çš„åè®®æ˜¯è¶…æ–‡æœ¬ä¼ é€åè®®HTTPã€‚HTTPä½¿ç”¨TCPè¿æ¥è¿›è¡Œå¯é çš„ä¼ é€ã€‚ä½†HTTPåè®®æœ¬èº«æ˜¯æ— è¿æ¥ã€æ— çŠ¶æ€çš„ã€‚HTTP/1.1 åè®®ä½¿ç”¨äº†æŒç»­è¿æ¥(åˆ†ä¸ºéæµæ°´çº¿æ–¹å¼å’Œæµæ°´çº¿æ–¹å¼)ã€‚ ä¸‡ç»´ç½‘ä½¿ç”¨è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€HTMLæ¥æ˜¾ç¤ºå„ç§ä¸‡ç»´ç½‘é¡µé¢ã€‚ ä¸‡ç»´ç½‘é™æ€æ–‡æ¡£æ˜¯æŒ‡åœ¨æ–‡æ¡£åˆ›ä½œå®Œæ¯•åå°±å­˜æ”¾åœ¨ä¸‡ç»´ç½‘æœåŠ¡å™¨ä¸­ï¼Œåœ¨è¢«ç”¨æˆ·æµè§ˆçš„æ‰ç”±åº”ç”¨ç¨‹åºåŠ¨æ€åˆ›å»ºçš„ã€‚è¿‡ç¨‹ä¸­ï¼Œå†…å®¹ä¸ä¼šæ”¹å˜ã€‚åŠ¨æ€æ–‡æ¡£æ˜¯æŒ‡æ–‡æ¡£çš„å†…å®¹æ˜¯åœ¨æµè§ˆå™¨è®¿é—®ä¸‡ç»´ç½‘æœåŠ¡å™¨æ—¶æ‰ç”±åº”ç”¨ç¨‹åºåŠ¨æ€åˆ›å»ºçš„ã€‚ æ´»åŠ¨æ–‡æ¡£æŠ€æœ¯å¯ä»¥ä½¿æµè§ˆå™¨å±å¹•è¿ç»­æ›´æ–°ã€‚æ´»åŠ¨æ–‡æ¡£ç¨‹åºå¯ä¸ç”¨æˆ·ç›´æ¥äº¤äº’ï¼Œå¹¶å¯è¿ç»­åœ°æ”¹å˜å±å¹•çš„æ˜¾ç¤ºã€‚ åœ¨ä¸‡ç»´ç½‘ä¸­ç”¨æ¥è¿›è¡Œæœç´¢çš„å·¥å…·å«åšæœç´¢å¼•æ“ã€‚æœç´¢å¼•æ“å¤§ä½“ä¸Šå¯åˆ’åˆ†ä¸ºå…¨æ–‡æ£€ç´¢æœç´¢å¼•æ“å’Œåˆ†ç±»ç›®å½•æœç´¢å¼•æ“ä¸¤å¤§ç±»ã€‚ ç”µå­é‚®ä»¶æ˜¯äº’è”ç½‘ä¸Šä½¿ç”¨æœ€å¤šçš„å’Œæœ€å—ç”¨æˆ·æ¬¢è¿çš„ä¸€ç§åº”ç”¨ã€‚ç”µå­é‚®ä»¶æŠŠé‚®ä»¶å‘åˆ°æ”¶ä»¶äººä½¿ç”¨çš„é‚®ä»¶æœåŠ¡å™¨ï¼Œå¹¶æ”¾åœ¨å…¶ä¸­çš„æ”¶ä»¶äººé‚®ç®±ä¸­ï¼Œæ”¶ä»¶äººå¯éšæ—¶ä¸Šç½‘åˆ°è‡ª é€å·±ä½¿ç”¨çš„é‚®ä»¶æœåŠ¡å™¨è¿›è¡Œè¯»å–ï¼Œç›¸å½“äºâ€œç”µå­ä¿¡ç®±â€ã€‚ è¿™ä¸ªç”µå­é‚®ä»¶ç³»ç»Ÿæœ‰ä¸‰ä¸ªä¸»è¦ç»„æˆæ„ä»¶å³ç”¨æˆ·ä»£ç†ã€é‚®ä»¶æœåŠ¡å™¨ï¼Œä»¥åŠé‚®ä»¶åè®®(åŒ…æ‹¬é‚®ä»¶å‘é€åè®®ï¼Œå¦‚SMTPï¼Œå’Œé‚®ä»¶è¯»å–åè®®ï¼Œå¦‚PPOP3å’ŒIMAP)ã€‚ç”¨æˆ·ä»£ç†å’Œé‚®ä»¶æœåŠ¡å™¨éƒ½è¦è¿è¡Œè¿™äº›åè®®ã€‚ ç”µå­é‚®ä»¶çš„ç”¨æˆ·ä»£ç†å°±æ˜¯ç”¨æˆ·ä¸ç”µå­é‚®ä»¶ç³»ç»Ÿçš„æ¥å£ï¼Œå®ƒå‘ç”¨æˆ·æä¾›ä¸€ä¸ªå¾ˆå‹å¥½çš„è§†çª—ç•Œé¢æ¥å‘é€å’Œæ¥æ”¶é‚®ä»¶ã€‚ ä»ç”¨æˆ·ä»£ç†æŠŠé‚®ä»¶ä¼ é€åˆ°é‚®ä»¶æœåŠ¡å™¨ï¼Œä¸€çº§åœ¨é‚®ä»¶æœåŠ¡å™¨ä¹‹é—´çš„ä¼ é€ï¼Œéƒ½è¦ä½¿ç”¨SMTPåè®®ã€‚ä½†ç”¨æˆ·ä»£ç†ä»é‚®ä»¶æœåŠ¡å™¨è¯»å–é‚®ä»¶æ—¶ï¼Œåˆ™è¦ä½¿ç”¨POP3ï¼ˆæˆ–IMAPï¼‰åè®®ã€‚ åŸºäºä¸‡ç»´ç½‘çš„ç”µå­é‚®ä»¶ä½¿ç”¨æˆ·èƒ½å¤Ÿåˆ©ç”¨æµè§ˆå™¨æ”¶å‘ç”µå­é‚®ä»¶ã€‚ç”¨æˆ·æµ æµè§ˆå™¨å’Œé‚®ä»¶æœåŠ¡å™¨ä¹‹é—´çš„é‚®ä»¶ä¼ é€ä½¿ç”¨HTTPåè®®ï¼Œè€Œåœ¨é‚® ä»¶æœåŠ¡å™¨ä¹‹é—´é‚®ä»¶çš„ä¼ é€ä»ç„¶ä½¿ç”¨SMTPåè®®ã€‚ ç®€å•ç½‘ç»œç®¡ç†åè®®SNMPç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå³(1)SNMPæœ¬èº«ï¼Œè´Ÿè´£è¯»å–å’Œæ”¹å˜å„ä»£ç†ä¸­çš„å¯¹è±¡ååŠå…¶çŠ¶æ€æ•°å€¼: (2)ç®¡ç†ä¿¡æ¯ç»“æ„SMIï¼Œå®šä¹‰å‘½åå¯¹è±¡å’Œå®šä¹‰å¯¹è±¡ç±»å‹(åŒ…æ‹¬èŒƒå›´å’Œé•¿åº¦)çš„é€šç”¨è§„åˆ™ï¼Œä»¥åŠæŠŠå¯¹è±¡å’Œå¯¹è±¡çš„å€¼è¿›è¡Œç¼–ç çš„åŸºæœ¬ç¼–ç è§„åˆ™BERï¼› (3) ç®¡ç†ä¿¡æ¯åº“MIBï¼Œåœ¨è¢«ç®¡ç†çš„å®ä½“ä¸­åˆ›å»ºäº†å‘½åå¯¹è±¡ï¼Œå¹¶è§„å®šäº†å…¶ç±»å‹ã€‚ ç³»ç»Ÿè°ƒç”¨æ¥å£æ˜¯åº”ç”¨è¿›ç¨‹çš„æ§åˆ¶æƒå’Œæ“ä½œç³»ç»Ÿçš„æ§åˆ¶æƒè¿›è¡Œè½¬æ¢çš„ä¸€ä¸ªæ¥å£ï¼Œåˆç§°ä¸ºåº”ç”¨ç¼–ç¨‹æ¥å£APIã€‚API å°±æ˜¯åº”ç”¨ç¨‹åºå’Œæ“ä½œç³»ç»Ÿä¹‹é—´çš„æ¥å£ã€‚ å¥—æ¥å­—æ˜¯åº”ç”¨è¿›ç¨‹å’Œè¿è¾“å±‚åè®®ä¹‹é—´çš„æ¥å£ï¼Œæ˜¯åº”ç”¨è¿›ç¨‹ä¸ºäº†è·å¾—ç½‘ç»œé€šä¿¡æœåŠ¡è€Œä¸æ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’æ—¶ä½¿ç”¨çš„ä¸€ç§æœºåˆ¶ã€‚ ç›®å‰P2På·¥ä½œæ–¹å¼ä¸‹çš„æ–‡ä»¶å…±äº«åœ¨äº’è”ç½‘æµé‡ä¸­å·²å æ®æœ€å¤§çš„ä»½é¢ï¼Œæ¯”ä¸‡ç»´ç½‘åº”ç”¨æ‰€å çš„æ¯”ä¾‹å¤§å¾—å¤šã€‚ BTæ˜¯å¾ˆæµè¡Œçš„ç§P2Påº”ç”¨ã€‚BTé‡‡ç”¨â€œæ˜¯ç¨€æœ‰çš„ä¼˜å…ˆâ€çš„æŠ€æœ¯ï¼Œå¯ä»¥å°½æ—©æŠŠå–ç¨€æœ‰çš„æ–‡ä»¶å—æ”¶é›†åˆ°ã€‚æ­¤å¤–ï¼Œå‡¡æœ‰å½“å‰ä»¥æœ€é«˜æ•°æ®ç‡å‘æŸä¸ªå¯¹ç­‰æ–¹ä¼ é€æ–‡ä»¶å—çš„ç›¸é‚»å¯¹ç­‰æ–¹ï¼Œè¯¥å¯¹ç­‰æ–¹å°±ä¼˜å…ˆæŠŠæ‰€è¯·æ±‚çš„æ–‡ä»¶å—ä¼ é€ç»™è¿™äº›ç›¸é‚»å¯¹ç­‰æ–¹ã€‚è¿™æ ·åšçš„ç»“æœæ˜¯ï¼Œè¿™äº›å¯¹ç­‰æ–¹ç›¸äº’ä¹‹é—´éƒ½èƒ½å¤Ÿä»¥ä»¤äººæ»¡æ„çš„é€Ÿç‡äº¤æ¢æ–‡ä»¶å—ã€‚ å½“å¯¹ç­‰æ–¹çš„æ•°é‡å¾ˆå¤§æ—¶ï¼Œé‡‡ç”¨P2Pæ–¹å¼ä¸‹è½½å¤§æ–‡ä»¶ï¼Œè¦æ¯”ä¼ ç»Ÿçš„å®¢æˆ·-æœåŠ¡å™¨æ–¹å¼å¿«å¾—å¤šã€‚ åœ¨P2Påº”ç”¨ä¸­ï¼Œå¹¿æ³›ä½¿ç”¨çš„ç´¢å¼•å’ŒæŸ¥æ‰¾æŠ€æœ¯æ˜¯åˆ†å¸ƒå¼æ•£åˆ—è¡¨DHTã€‚ ç½‘ç»œå®‰å…¨ è®¡ç®—æœºç½‘ç»œä¸Šçš„é€šä¿¡é¢ä¸´çš„å¨èƒå¯åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œ å³è¢«åŠ¨æ”»å‡»(å¦‚æˆªè·)å’Œä¸»åŠ¨æ”»å‡» (å¦‚ä¸­æ–­ã€ç®—æ”¹ã€ä¼ªé€ )ã€‚ä¸»åŠ¨æ”»å‡»çš„ç±»å‹æœ‰æ›´æ”¹æŠ¥æ–‡æµã€æ‹’ç»æœåŠ¡ã€ä¼ªé€ åˆå§‹ åŒ–ã€æ¶æ„ç¨‹åº(ç—…æ¯’ã€è •è™«ã€æœ¨é©¬ã€é€»è¾‘ç‚¸å¼¹ã€åé—¨å…¥ä¾µã€æµæ°“è½¯ä»¶)ç­‰ã€‚ è®¡ç®—æœºç½‘ç»œå®‰å…¨ä¸»è¦æœ‰ä»¥ä¸‹ä¸€äº›å†…å®¹:ä¿å¯†æ€§ã€å®‰å…¨åè®®çš„è®¾è®¡å’Œè®¿é—®æ§åˆ¶ã€‚ å¯†ç ç¼–ç å­¦æ˜¯å¯†ç ä½“åˆ¶çš„è®¾è®¡å­¦ï¼Œè€Œå¯†ç åˆ†æå­¦åˆ™æ˜¯åœ¨æœªçŸ¥å¯†é’¥çš„æƒ…å†µä¸‹ä»å¯†æ–‡æ¨æ¼”å‡ºæ˜æ–‡æˆ–å¯†é’¥çš„æŠ€æœ¯ã€‚å¯†ç ç¼–ç å­¦ä¸å¯†ç åˆ†æå­¦åˆèµ·æ¥å³ä¸ºå¯†ç å­¦ã€‚ å¦‚æœä¸è®ºæˆªå–è€…è·å¾—äº†å¤šå°‘å¯†æ–‡ï¼Œéƒ½æ— æ³•å”¯ä¸€åœ°ç¡®å®šå‡ºå¯¹åº”çš„æ˜æ–‡ï¼Œåˆ™è¿™ä¸€å¯†ç ä½“åˆ¶ç§°ä¸ºæ— æ¡ä»¶å®‰å…¨çš„(æˆ–ç†è®ºä¸Šæ˜¯ä¸å¯ç ´çš„)ã€‚åœ¨æ— ä»»ä½•é™åˆ¶çš„æ¡ä»¶ä¸‹ï¼Œç›®å‰å‡ ä¹æ‰€æœ‰å®ç”¨çš„å¯†ç ä½“åˆ¶å‡æ˜¯å¯ç ´çš„ã€‚å¦‚æœä¸€ä¸ªå¯†ç ä½“åˆ¶ä¸­çš„å¯†ç ä¸èƒ½åœ¨ä¸€å®šæ—¶é—´å†…è¢«å¯ä»¥ä½¿ç”¨çš„è®¡ç®—èµ„æºç ´è¯‘ï¼Œåˆ™è¿™å¯†ç ä½“åˆ¶ç§°ä¸ºåœ¨è®¡ç®—ä¸Šæ˜¯å®‰å…¨çš„ã€‚ å¯¹ç§°å¯†é’¥å¯†ç ä½“åˆ¶æ˜¯åŠ å¯†å¯†é’¥ä¸è§£å¯†å¯†é’¥ç›¸åŒçš„å¯†ç ä½“åˆ¶(å¦‚æ•°æ®åŠ å¯†æ ‡å‡†DESå’Œé«˜çº§åŠ å¯†æ ‡å‡†AES)ã€‚è¿™ç§åŠ å¯†çš„ä¿å¯†æ€§ä»…å–å†³äºå¯¹å¯†é’¥çš„ä¿å¯†ï¼Œè€Œç®—æ³•æ˜¯å…¬å¼€çš„ã€‚ å…¬é’¥å¯†ç ä½“åˆ¶(åˆç§°ä¸ºå…¬å¼€å¯†é’¥å¯†ç ä½“åˆ¶)ä½¿ç”¨ä¸åŒçš„åŠ å¯†å¯†é’¥ä¸è§£å¯†å¯†é’¥ã€‚åŠ å¯†ç®—æ³•å’Œè§£å¯†ç®—æ³•ä¹Ÿéƒ½æ˜¯å…¬å¼€çš„ã€‚åŠ å¯†å¯†é’¥(å³å…¬é’¥)æ˜¯å‘å…¬ä¼—å…¬å¼€çš„ï¼Œè€Œè§£å¯†å¯†é’¥(å³ç§é’¥æˆ–ç§˜é’¥)åˆ™æ˜¯éœ€è¦ä¿å¯†çš„ã€‚ ç›®å‰æœ€è‘—åçš„å…¬é’¥å¯†ç ä½“åˆ¶æ˜¯RSAä½“åˆ¶ï¼Œå®ƒæ˜¯åŸºäºæ•°è®ºä¸­çš„å¤§æ•°åˆ†è§£é—®é¢˜çš„ä½“åˆ¶ã€‚ä»»ä½•åŠ å¯†æ–¹æ³•çš„å®‰å…¨æ€§å–å†³äºå¯†é’¥çš„é•¿åº¦ï¼Œä»¥åŠæ”»ç ´å¯†æ–‡æ‰€éœ€çš„è®¡ç®—é‡ï¼Œè€Œä¸æ˜¯ç®€å•åœ°å–å†³äºåŠ å¯†çš„ä½“åˆ¶(å…¬é’¥å¯†ç ä½“åˆ¶æˆ–ä¼ ç»ŸåŠ å¯†ä½“åˆ¶)ã€‚ æ•°å­—ç­¾åå¿…é¡»ä¿è¯èƒ½å¤Ÿå®ç°ä»¥ä¸‰ç‚¹åŠŸèƒ½(1)æŠ¥æ–‡é‰´åˆ«ï¼Œå³æ¥æ”¶è€…èƒ½å¤Ÿæ ¸å®å‘é€è€…å¯¹æŠ¥æ–‡çš„ç­¾å(2)æŠ¥æ–‡çš„å®Œæ•´æ€§ï¼Œå³æ¥æ”¶è€…ç¡®ä¿¡æ‰€æ”¶åˆ°çš„æ•°æ®å®Œå…¨å’Œå‘é€è€…å‘é€çš„å®Œå…¨ä¸€æ ·è€Œæ²¡æœ‰è¢«ç¯¡æ”¹è¿‡ï¼›(3)ä¸å¯å¦è®¤ï¼Œå³å‘é€è€…äº‹åä¸èƒ½æŠµèµ–å¯¹æŠ¥æ–‡çš„ç­¾åã€‚ é‰´åˆ«æ˜¯è¦éªŒè¯é€šä¿¡çš„å¯¹æ–¹çš„ç¡®æ˜¯è‡ªå·±æ‰€è¦é€šä¿¡çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯å…¶ä»–çš„å†’å……è€…ã€‚é‰´åˆ«ä¸æˆæƒæ˜¯ä¸åŒçš„æ¦‚å¿µã€‚ å¯†é’¥ç®¡ç†åŒ…æ‹¬:å¯†é’¥çš„äº§ç”Ÿã€åˆ†é…ã€æ³¨å…¥ã€éªŒè¯å’Œä½¿ç”¨ã€‚å¯†é’¥åˆ†é…(æˆ–å¯†é’¥åˆ†å‘)æ˜¯å¯†é’¥ç®¡ç†ä¸­æœ€å¤§çš„é—®é¢˜ã€‚å¯†é’¥å¿…é¡»é€šè¿‡æœ€å®‰å…¨çš„é€šè·¯è¿›è¡Œåˆ†é…ã€‚ç›®å‰å¸¸ç”¨çš„å¯†é’¥åˆ†é…æ–¹å¼æ˜¯è®¾ç«‹å¯†é’¥åˆ†é…ä¸­å¿ƒKDCã€‚ è®¤è¯ä¸­å¿ƒCAæ˜¯ä¸€ä¸ªå€¼å¾—ä¿¡èµ–çš„æœºæ„ï¼Œç”¨æ¥å°†å…¬é’¥ä¸å…¶å¯¹åº”çš„å®ä½“(äººæˆ–æœºå™¨)è¿›è¡Œç»‘å®šã€‚æ¯ä¸ªå®ä½“éƒ½æœ‰CAå‘æ¥çš„è¯ä¹¦ï¼Œé‡Œé¢æœ‰å…¬é’¥åŠå…¶æ‹¥æœ‰è€…çš„æ ‡è¯†ä¿¡æ¯(äººåæˆ–IPåœ°å€)ã€‚æ­¤è¯ä¹¦è¢«CAè¿›è¡Œäº†æ•°å­—ç­¾åã€‚ä»»ä½•ç”¨æˆ·éƒ½å¯ä»å¯ä¿¡çš„åœ°æ–¹è·å¾—è®¤è¯ä¸­å¿ƒCAçš„å…¬é’¥ã€‚ åœ¨ç½‘ç»œå±‚å¯ä½¿ç”¨IPsecåè®®æ—ï¼ŒIPsecåŒ…æ‹¬é‰´åˆ«é¦–éƒ¨åè®®AHå’Œå°è£…å®‰å…¨æœ‰æ•ˆè½½è·åè®®ESPã€‚AHåè®®æä¾›æºç‚¹é‰´åˆ«å’Œæ•°æ®å®Œæ•´æ€§ï¼Œä½†ä¸èƒ½ä¿å¯†ã€‚è€ŒESPåè®®æä¾›æºç‚¹é‰´åˆ«ã€æ•°æ®å®Œæ•´æ€§å’Œä¿å¯†ã€‚IPsec æ”¯æŒIPv4å’ŒIPV6ã€‚åœ¨IPv6ä¸­ï¼ŒAHå’ŒESPéƒ½æ˜¯æ‰©å±•é¦–éƒ¨çš„ä¸€éƒ¨åˆ†ã€‚IPsee æ•°æ®æŠ¥çš„å·¥ä½œæ–¹å¼æœ‰è¿è¾“æ–¹å¼å’Œéš§é“æ–¹å¼ä¸¤ç§ã€‚ è¿è¾“å±‚çš„å®‰å…¨åè®®æœ‰SSL (å®‰å…¨å¥—æ¥å­—å±‚)å’ŒTLS (è¿è¾“å±‚å®‰å…¨)ã€‚SSLæœ€æ–°çš„ç‰ˆæœ¬æ˜¯SSL 3.0ï¼Œ å®ƒæ˜¯ä¿æŠ¤ä¸‡ç»´ç½‘HTTPé€šä¿¡é‡æ‰€å…¬è®¤çš„äº‹å®ä¸Šçš„æ ‡å‡†ã€‚SSLä¸ä»…è¢«æ‰€æœ‰å¸¸ç”¨çš„æµè§ˆå™¨å’Œä¸‡ç»´ç½‘æœåŠ¡å™¨æ‰€æ”¯æŒï¼Œè€Œä¸”ä¹Ÿæ˜¯TLSçš„åŸºç¡€ã€‚ PGPæ˜¯ä¸€ä¸ªå®Œæ•´çš„ç”µå­é‚®ä»¶å®‰å…¨è½¯ä»¶åŒ…ï¼ŒåŒ…æ‹¬åŠ å¯†ã€é‰´åˆ«ã€ç”µå­ç­¾åå’Œå‹ç¼©ç­‰æŠ€æœ¯ã€‚PGPå¹¶æ²¡æœ‰ä½¿ç”¨ä»€ä¹ˆæ–°çš„æ¦‚å¿µï¼Œå®ƒåªæ˜¯æŠŠç°æœ‰çš„ä¸€äº›åŠ å¯†ç®—æ³•(å¦‚RSAå…¬é’¥åŠ å¯†ç®—æ³•æˆ–MDSæŠ¥æ–‡æ‘˜è¦ç®—æ³•)ç»¼åˆåœ¨ä¸€èµ·è€Œå·²ã€‚ é˜²ç«å¢™æ˜¯ç§ç‰¹æ®Šç¼–ç¨‹çš„è·¯ç”±å™¨ï¼Œå®‰è£…åœ¨ä¸€ä¸ªç½‘ç‚¹å’Œç½‘ç»œçš„å…¶ä½™éƒ¨åˆ†ä¹‹é—´ï¼Œç›®çš„æ˜¯å®æ–½è®¿é—®æ§åˆ¶ç­–ç•¥ã€‚é˜²ç«å¢™é‡Œé¢çš„ç½‘ç»œç§°ä¸ºâ€œå¯ä¿¡çš„ç½‘ç»œâ€ï¼Œè€ŒæŠŠé˜²ç«å¢™å¤–é¢çš„ç½‘ç»œç§°ä¸ºâ€œä¸å¯ä¿¡çš„ç½‘ç»œâ€ã€‚é˜²ç«å¢™çš„åŠŸèƒ½æœ‰ä¸¤ä¸ª:ä¸€ä¸ªæ˜¯é˜»æ­¢(ä¸»è¦çš„)ï¼Œå¦ä¸€ä¸ªæ˜¯å…è®¸ã€‚ é˜²ç«å¢™æŠ€æœ¯åˆ†ä¸º:ç½‘ç»œçº§é˜²ç«å¢™ï¼Œç”¨æ¥é˜²æ­¢æ•´ä¸ªç½‘ç»œå‡ºç°å¤–æ¥éæ³•çš„å…¥ä¾µ(å±äºè¿™ç±»çš„æœ‰åˆ†ç»„è¿‡æ»¤å’ŒæˆæƒæœåŠ¡å™¨)ï¼›åº”ç”¨çº§é˜²ç«å¢™ï¼Œç”¨æ¥è¿›è¡Œè®¿é—®æ§åˆ¶(ç”¨åº”ç”¨ç½‘å…³æˆ–ä»£ç†æœåŠ¡å™¨æ¥åŒºåˆ†å„ç§åº”ç”¨)ã€‚ å…¥ä¾µæ£€æµ‹ç³»ç»ŸIDSæ˜¯åœ¨å…¥ä¾µå·²ç»å¼€å§‹ï¼Œä½†è¿˜æ²¡æœ‰é€ æˆå±å®³æˆ–åœ¨é€ æˆæ›´å¤§å±å®³å‰ï¼ŒåŠæ—¶æ£€æµ‹åˆ°å…¥ä¾µï¼Œä»¥ä¾¿å°½å¿«é˜»æ­¢å…¥ä¾µï¼ŒæŠŠå±å®³é™ä½åˆ°æœ€å°ã€‚ ç½‘ç»œä¸Šçš„éŸ³è§†é¢‘æœåŠ¡ å¤šåª’ä½“ä¿¡æ¯æœ‰ä¸¤ä¸ªé‡è¦ç‰¹ç‚¹:(1)å¤šåª’ä½“ä¿¡æ¯çš„ä¿¡æ¯é‡å¾€å¾€å¾ˆå¤§1(2)åœ¨ä¼ è¾“å¤šåª’ä½“æ•°æ®æ—¶ï¼Œå¯¹æ—¶å»¶å’Œæ—¶å»¶æŠ–åŠ¨å‡æœ‰è¾ƒé«˜çš„è¦æ±‚ã€‚åœ¨äº’è”ç½‘ä¸Šä¼ è¾“å¤šåª’ä½“æ•°æ®æ—¶ï¼Œæˆ‘ä»¬éƒ½æ˜¯æŒ‡å«æœ‰â€œè¾¹ä¼ è¾“ã€è¾¹æ’­æ”¾â€çš„ç‰¹ç‚¹ã€‚ ç”±å¤šåª’ä½“ä¿¡æ¯æ„æˆçš„åˆ†ç»„åœ¨å‘é€æ—¶æ˜¯ç­‰æ—¶çš„ã€‚è¿™äº›åˆ†ç»„åœ¨åˆ°è¾¾æ¥æ”¶ç«¯æ—¶å°±å˜æˆä¸ºéç­‰æ—¶çš„ã€‚å½“æ¥æ”¶ç«¯å­˜ä¸­çš„åˆ†ç»„æ•°è¾¾åˆ°ä¸€å®šçš„æ•°é‡åï¼Œå†ä»¥æ’å®šé€Ÿç‡æŒ‰é¡ºåºå°†è¿™äº›åˆ†ç»„è¿›è¡Œè¿˜åŸæ’­æ”¾ã€‚è¿™æ ·å°±äº§ç”Ÿäº†æ’­æ”¾æ—¶å»¶ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ¶ˆé™¤æ—¶å»¶çš„æŠ–åŠ¨ã€‚ åœ¨ä¼ é€æ—¶å»¶æ•æ„Ÿçš„å®æ—¶æ•°æ®æ—¶ï¼Œä¼ è¾“æ—¶å»¶å’Œæ—¶å»¶æŠ–åŠ¨éƒ½å¿…é¡»å—åˆ°é™ã€‚é€šå¸¸å®å¯ä¸¢å¤±å°‘é‡åˆ†ç»„ï¼Œä¹Ÿä¸è¦æ¥æ”¶å¤ªæ™šåˆ°è¾¾çš„åˆ†ç»„ã€‚ ç›®å‰äº’è”ç½‘æä¾›çš„éŸ³é¢‘è§†é¢‘æœåŠ¡æœ‰ä¸‰ç§ç±»å‹:(1)æµå¼å­˜å‚¨éŸ³é¢‘è§†é¢‘ï¼Œç”¨æˆ·é€šè¿‡äº’è”ç½‘è¾¹ä¸‹è½½ã€è¾¹æ’­æ”¾ã€‚(2)æµå¼å®å†µéŸ³/è§†é¢‘ï¼Œå…¶ç‰¹ç‚¹æ˜¯åœ¨å‘é€æ–¹è¾¹å½•ä¾‹ã€è¾¹å‘é€ï¼Œåœ¨æ¥æ”¶æ—¶ä¹Ÿæ˜¯è¦æ±‚èƒ½å¤Ÿè¿°ç»­æ’­æ”¾ã€‚(3)äº¤äº’å¼éŸ³é¢‘è§†é¢‘ï¼Œå¦‚äº’è”ç½‘ç”µè¯æˆ–äº’è”ç½‘ç”µè§†ä¼šè®®ã€‚ æµåª’ä½“( streaming media)å°±æ˜¯æµå¼éŸ³é¢‘/è§†é¢‘ï¼Œå…¶ç‰¹ç‚¹æ˜¯è¾¹ä¸‹è½½ã€è¾¹æ’­æ”¾ï¼Œä½†ä¸èƒ½å­˜å‚¨åœ¨ç¡¬ç›˜ä¸Šæˆä¸ºç”¨æˆ·çš„æ–‡ä»¶ã€‚ åª’ä½“æœåŠ¡å™¨(æˆ–ç§°ä¸ºæµå¼æœåŠ¡å™¨)å¯ä»¥æ›´å¥½åœ°æ”¯æŒæµå¼éŸ³é¢‘å’Œè§†é¢‘çš„ä¼ é€ã€‚TCPèƒ½å¤Ÿä¿è¯æµå¼éŸ³é¢‘/è§†é¢‘æ–‡ä»¶çš„æ’­æ”¾è´¨é‡ï¼Œä½†å¼€å§‹æ’­æ”¾çš„æ—¶é—´è¦æ¯”è¯·æ±‚æ’­æ”¾çš„æ—¶é—´æ»åä¸€äº›(å¿…é¡»å…ˆåœ¨ç¼“å­˜ä¸­å­˜å‚¨ä¸€å®šæ•°é‡çš„åˆ†ç»„)ã€‚å¯¹äºå®æ—¶æµå¼éŸ³é¢‘è§†é¢‘æ–‡ä»¶çš„ä¼ é€åˆ™åº”å½“é€‰ç”¨UDPã€‚ å®æ—¶æµå¼åè®®RTSPæ˜¯ä¸ºäº†ç»™æµå¼è¿‡ç¨‹å¢åŠ æ›´å¤šåŠŸèƒ½è€Œè®¾è®¡çš„åè®®ã€‚RTSPæœ¬èº«å¹¶ä¸ä¼ é€æ•°æ®ï¼Œè€Œä»…ä»…æ˜¯ä½¿åª’ä½“æ”¾å™¨èƒ½å¤Ÿæ§åˆ¶å¤šåª’ä½“æµçš„ä¼ é€ã€‚RTSPåˆç§°ä¸ºâ€œäº’è”ç½‘å½•åƒæœºé¥æ§åè®®â€ ã€‚ ç‹­ä¹‰çš„IPç”µè¯æ˜¯æŒ‡åœ¨IPç½‘ç»œä¸Šæ‰“ç”µè¯ã€‚å¹¿ä¹‰çš„IPç”µè¯åˆ™ä¸ä»…æ˜¯ç”µè¯é€šä¿¡ï¼Œè€Œä¸”è¿˜å¯ä»¥åœ¨IPç½‘ç»œä¸Šè¿›è¡Œäº¤äº’å¼å¤šåª’ä½“å®æ—¶é€šä¿¡(åŒ…æ‹¬è¯éŸ³ã€è§†åƒç­‰),ç”šè‡³è¿˜åŒ…æ‹¬å³æ—¶ä¼ ä¿¡IM(å¦‚QQå’Œssypç­‰)ã€‚ IPç”µè¯çš„é€šè¯è´¨é‡ä¸»è¦ç”±ä¸¤ä¸ªå› ç´ å†³å®š:(1)é€šè¯åŒæ–¹ç«¯åˆ°ç«¯çš„æ—¶å»¶å’Œæ—¶å»¶æŠ–åŠ¨ï¼›(2)è¯éŸ³åˆ†ç»„çš„ä¸¢å¤±ç‡ã€‚ä½†è¿™ä¸¤ä¸ªå› ç´ éƒ½æ˜¯ä¸ç¡®å®šçš„ï¼Œè€Œæ˜¯å–å†³äºå½“æ—¶ç½‘ç»œä¸Šçš„é€šä¿¡é‡ã€‚ å®æ—¶è¿è¾“åè®®RTPä¸ºå®æ—¶åº”ç”¨æä¾›ç«¯åˆ°ç«¯çš„è¿è¾“ï¼Œä½†ä¸æä¾›ä»»ä½•æœåŠ¡è´¨é‡çš„ä¿è¯ã€‚éœ€è¦å‘é€çš„å¤šåª’ä½“æ•°æ®å—(éŸ³é¢‘/è§†é¢‘)ç»è¿‡å‹ç¼©ç¼–ç å¤„ç†åï¼Œå…ˆé€ç»™RTPå°è£…æˆä¸ºRTPåˆ†ç»„ï¼Œè£…å…¥è¿è¾“å±‚çš„UDPç”¨æˆ·æ•°æ®æŠ¥åï¼Œå†å‘ä¸‹é€’äº¤ç»™IPå±‚ã€‚å¯ä»¥æŠŠRTPçœ‹æˆæ˜¯åœ¨UDPä¹‹ä¸Šçš„ä¸€ä¸ªè¿è¾“å±‚å­å±‚çš„åè®®ã€‚ å®æ—¶è¿è¾“æ§åˆ¶åè®®RTCPæ˜¯ä¸RTPé…åˆä½¿ç”¨çš„åè®®ã€‚RTCPåè®®çš„ä¸»è¦åŠŸèƒ½æ˜¯:æœåŠ¡è´¨é‡çš„ç›‘è§†ä¸åé¦ˆï¼Œåª’ä½“é—´çš„åŒæ­¥ï¼Œä»¥åŠå¤šæ’­ç»„ä¸­æˆå‘˜çš„æ ‡å¿—ã€‚RTCPåˆ†ç»„ä¹Ÿä½¿ç”¨UDPæ¥ä¼ é€ï¼Œä½†RTCPå¹¶ä¸å¯¹éŸ³é¢‘è§†é¢‘åˆ†ç»„è¿›è¡Œå°è£…ã€‚ ç°åœ¨IPç”µè¯æœ‰ä¸¤å¥—ä¿¡ä»¤æ ‡å‡†ã€‚ä¸€å¥—æ˜¯ITU-Tå®šä¹‰çš„H323åè®®ï¼Œå¦ä¸€å¥—æ˜¯ETFæå‡ºçš„ä¼šè¯å‘èµ·åè®®SIPã€‚ H323ä¸æ˜¯ä¸€ä¸ªå•ç‹¬çš„åè®®è€Œæ˜¯ä¸€ç»„åè®®ã€‚H323åŒ…æ‹¬ç³»ç»Ÿå’Œæ„ä»¶çš„æè¿°ã€å‘¼å«æ¨¡å‹çš„æè¿°ã€å‘¼å«ä¿¡ä»¤è¿‡ç¨‹ã€æ§åˆ¶æŠ¥æ–‡ã€å¤ç”¨ã€è¯éŸ³ç¼–è§£ç å™¨ã€è§†åƒç¼–è§£ç å™¨ï¼Œä»¥åŠæ•°æ®åè®®ç­‰ã€‚H323æ ‡å‡†çš„å››ä¸ªæ„ä»¶æ˜¯:(1)H323ç»ˆç«¯:(2)ç½‘å…³ï¼›(3)ç½‘é—´(4)å¤šç‚¹æ§åˆ¶å•å…ƒMCU . ä¼šè¯å‘èµ·åè®®SIPåªæ¶‰åŠåˆ°Pç”µè¯æ‰€éœ€çš„ä¿¡ä»¤å’Œæœ‰å…³æœåŠ¡è´¨é‡çš„é—´é¢˜ã€‚SIPä½¿ç”¨æ–‡æœ¬æ–¹å¼çš„å®¢æˆ·æœåŠ¡å™¨åè®®ã€‚SPç³»ç»Ÿåªæœ‰ä¸¤ç§æ„ä»¶ï¼Œå³ç”¨æˆ·ä»£ç†(åŒ…æ‹¬ç”¨æˆ·ä»£ç†å®¢æˆ·å’Œç”¨æˆ·ä»£ç†æœåŠ¡å™¨)å’Œç½‘ç»œæœåŠ¡å™¨(åŒ…æ‹¬ä»£ç†æœåŠ¡å™¨å’Œé‡å®šå‘æœåŠ¡å™¨)ã€‚SIPçš„åœ°å€ååˆ†çµæ´»ï¼Œå®ƒå¯ä»¥æ˜¯ç”µè¯å·ç ï¼Œä¹Ÿå¯ä»¥æ˜¯ç”µå­é‚®ä»¶åœ°å€ã€IPåœ°å€æˆ–å…¶ä»–ç±»å‹çš„åœ°å€ã€‚ æœåŠ¡è´¨é‡QoSæ˜¯æœåŠ¡æ€§èƒ½çš„æ€»æ•ˆæœï¼Œæ­¤æ•ˆæœå†³å®šäº†ä¸€ä¸ªç”¨æˆ·å¯¹æœåŠ¡çš„æ»¡æ„ç¨‹åº¦ã€‚å› æ­¤ï¼Œæœ‰æœåŠ¡è´¨é‡çš„æœåŠ¡å°±æ˜¯èƒ½å¤Ÿæ»¡è¶³ç”¨æˆ·çš„åº”ç”¨éœ€æ±‚çš„æœåŠ¡ã€‚æˆ–è€…è¯´ï¼Œå¯æä¾›è‡´çš„ã€å¯é¢„è®¡çš„æ•°æ®äº¤ä»˜æœåŠ¡ã€‚ æœåŠ¡è´¨é‡å¯ç”¨è‹¥å¹²åŸºæœ¬çš„æ€§èƒ½æŒ‡æ ‡æ¥æè¿°ï¼ŒåŒ…æ‹¬å¯ç”¨æ€§ã€å·®é”™ç‡ã€å“åº”æ—¶é—´ã€ååé‡ã€åˆ†ç»„ä¸¢å¤±ç‡ã€è¿æ¥å»ºç«‹æ—¶é—´ã€æ•…éšœæ£€æµ‹å’Œæ”¹æ­£æ—¶é—´ç­‰ã€‚æœåŠ¡æä¾›è€…å¯å‘å…¶ç”¨æˆ·ä¿è¯æŸä¸€ç§ç­‰çº§çš„æœåŠ¡è´¨é‡ã€‚ ä¸ºäº†ä½¿äº’è”ç½‘å…·æœ‰ä¸€å®šçš„æœåŠ¡è´¨é‡ï¼Œå¯é‡‡å–ä»¥ä¸‹ä¸€äº›æªæ–½:(1)åˆ†ç±»ï¼Œå¦‚åŒºåˆ†æœåŠ¡ï¼›(2)ç®¡åˆ¶ï¼›(3)è°ƒåº¦ï¼›(4)å‘¼å«æ¥çº³ï¼›(5)åŠ æƒå…¬å¹³æ’é˜Ÿç­‰ã€‚ ç»¼åˆæœåŠ¡ Intservå¯å¯¹å•ä¸ªçš„åº”ç”¨ä¼šè¯æä¾›æœåŠ¡è´¨é‡çš„ä¿è¯ï¼Œå®ƒå®šä¹‰äº†ä¸¤ç±»æœåŠ¡ï¼Œå³æœ‰ä¿è¯çš„æœåŠ¡å’Œå—æ§è´Ÿè¼‰çš„æœåŠ¡ã€‚Intservå…±æœ‰ä»¥ä¸‹å››ä¸ªç»„æˆéƒ¨åˆ†ï¼Œå³(1)èµ„æºé¢„ç•™åè®®RSVPï¼›(2)æ¥çº³æ§åˆ¶ï¼›(3)åˆ†ç±»å™¨ï¼›(4)è°ƒåº¦å™¨ã€‚ åŒºåˆ†æœåŠ¡ Diffservåœ¨è·¯ç”±å™¨ä¸­å¢åŠ åŒºåˆ†æœåŠ¡çš„åŠŸèƒ½ï¼ŒæŠŠIPåè®®ä¸­åŸæœ‰çš„æœåŠ¡ç±»å‹å­—æ®µé‡æ–°å®šä¹‰ä¸ºåŒºåˆ†æœåŠ¡DSï¼Œåˆ©ç”¨DSå­—æ®µçš„ä¸åŒæ•°å€¼æä¾›ä¸åŒç­‰çº§çš„æœåŠ¡è´¨é‡ã€‚Diffservå°†æ‰€æœ‰çš„å¤æ‚æ€§æ”¾åœ¨DSåŸŸçš„è¾¹ç•Œç»“ç‚¹ä¸­ï¼Œè€Œä½¿DSåŸŸå†…éƒ¨è·¯ç”±å™¨å·¥ä½œå¾—å°½å¯èƒ½åœ°ç®€å•ã€‚Diffservå®šä¹‰äº†åœ¨è½¬å‘åˆ†ç»„æ—¶ä½“ç°æœåŠ¡æ°´å¹³çš„æ¯è·³è¡Œä¸ºPHBï¼ŒåŒ…æ‹¬EFå’ŒAFï¼Œå³è¿…é€Ÿè½¬å‘PHBå’Œç¡®ä¿è½¬å‘PHBã€‚ æ— çº¿ç½‘ç»œå’Œç§»åŠ¨ç½‘ç»œ æ— çº¿å±€åŸŸç½‘å¯åˆ†ä¸ºä¸¤å¤§ç±»ã€‚ç¬¬ä¸€ç±»æ˜¯æœ‰å›ºå®šåŸºç¡€è®¾æ–½çš„ï¼Œç¬¬äºŒç±»æ˜¯æ— å›ºå®šåŸºç¡€è®¾æ–½çš„ æ— çº¿å±€åŸŸç½‘çš„æ ‡å‡†æ˜¯IEçš„802.11ç³»åˆ—ã€‚ä½¿ç”¨802.11ç³»åˆ—åè®®çš„å±€åŸŸç½‘åˆç§°ä¸ºWi-Fiã€‚ 802.11æ— çº¿ä»¥å¤ªç½‘æ ‡å‡†ä½¿ç”¨æ˜Ÿå½¢æ‹“æ‰‘ï¼Œå…¶ä¸­å¿ƒå«åšæ¥å…¥ç‚¹APï¼Œå®ƒå°±æ˜¯åŸºæœ¬æœåŠ¡é›†å†…çš„åŸºç«™ã€‚ åº”å½“å¼„æ¸…å‡ ç§ä¸åŒçš„æ¥å…¥:å›ºå®šæ¥å…¥ã€ç§»åŠ¨æ¥å…¥ã€ä¾¿æºæ¥å…¥å’Œæ¸¸ç‰§æ¥å…¥ã€‚ 802.11æ— çº¿ä»¥å¤ªç½‘åœ¨MACå±‚ä½¿ç”¨CSMA/CAåè®®ã€‚ä¸èƒ½ä½¿ç”¨CSMA/CDçš„åŸå› æ˜¯:åœ¨æ— çº¿å±€åŸŸç½‘ä¸­ï¼Œå¹¶éæ‰€æœ‰çš„ç«™ç‚¹éƒ½èƒ½å¤Ÿå¬è§å¯¹æ–¹(ä¾‹å¦‚ï¼Œå½“æœ‰éšœç¢ç‰©å‡ºç°åœ¨ç«™ç‚¹ä¹‹é—´æ—¶)ï¼Œå› æ­¤æ— æ³•å®ç°ç¢°æ’æ£€æµ‹ã€‚ä½¿ç”¨ CSMA/CAåè®®æ˜¯ä¸ºäº†å°½é‡å‡å°ç¢°æ’å‘ç”Ÿçš„æ¦‚ç‡ã€‚ 802.11æ— çº¿å±€åŸŸç½‘åœ¨ä½¿ç”¨ CSMA/CAçš„åŒæ—¶ï¼Œè¿˜ä½¿ç”¨åœæ­¢ç­‰å¾…åè®®ã€‚ 8021æ ‡å‡†è§„å®šï¼Œæ‰€æœ‰çš„ç«™åœ¨å®Œæˆå‘é€åï¼Œå¿…é¡»å†ç­‰å¾…ä¸€æ®µå¸§é—´é—´éš”æ—¶é—´æ‰èƒ½å‘é€ä¸‹ä¸€å¸§ã€‚å¸§é—´é—´éš”çš„é•¿çŸ­å–å†³äºè¯¥ç«™è¦å‘é€çš„å¸§çš„ä¼˜å…ˆçº§ã€‚ åœ¨802.11æ— çº¿å±€åŸŸç½‘çš„MACå¸§é¦–éƒ¨ä¸­æœ‰ä¸€ä¸ªæŒç»­æœŸå­—æ®µï¼Œç”¨æ¥å¡«å…¥åœ¨æœ¬å¸§ç»“æŸåè¿˜è¦å ç”¨ä¿¡é“å¤šå°‘æ—¶é—´(ä»¥å¾®ç§’ä¸ºå•ä½)ã€‚ 802.11æ ‡å‡†å…è®¸è¦å‘é€æ•°æ®çš„ç«™å¯¹ä¿¡é“è¿›è¡Œé¢„çº¦ï¼Œå³åœ¨å‘é€æ•°æ®å¸§ä¹‹å‰å…ˆå‘é€RTSå¸§è¯·æ±‚å‘é€ã€‚åœ¨æ”¶åˆ°å“åº”å…è®¸å‘é€çš„CTSå¸§åï¼Œå°±å¯å‘é€æ•°æ®å¸§ã€‚ 802.1çš„MACå¸§å…±æœ‰ä¸‰ç§ç±»å‹ï¼Œå³æ§åˆ¶å¸§ã€æ•°æ®å¸§å’Œç®¡ç†å¸§ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ°å€å­—æ®µï¼Œå³æºåœ°å€ã€ç›®çš„åœ°å€å’ŒAPåœ°å€ã€‚MACå¸§æœ‰å››ä¸ªåœ°å€å­—æ®µã€‚åœ¨æœ‰å›ºå®šåŸºç¡€è®¾æ–½çš„æ— çº¿å±€åŸŸç½‘ä¸­ï¼Œåªä½¿ç”¨å…¶ä¸­çš„ä¸‰ä¸ª å‡ ç§æ— çº¿ç½‘ç»œç®€ä»‹:æ— çº¿ä¸ªäººåŒºåŸŸç½‘(è“ç‰™ç³»ç»Ÿã€ Zigbeeå’Œè¶…é«˜é€ŸWPAN)ã€‚æ— çº¿åŸåŸŸç½‘ WIMAXã€‚ å½“è®¡ç®—æœºç§»åŠ¨åˆ°å¤–åœ°æ—¶ï¼Œç§»åŠ¨IPæŠ€æœ¯å…è®¸è¯¥è®¡ç®—æœºä»ç„¶ä¿ç•™å…¶åŸæ¥çš„IPåœ°å€ã€‚ç§»åŠ¨IPä½¿ç”¨äº†ä¸€äº›æ–°æ¦‚å¿µï¼Œå¦‚æ°¸ä¹…åœ°å€ã€å½’å±åœ°å€ã€å½’å±ç½‘ç»œã€è¢«è®¿ç½‘ç»œæˆ–å¤–åœ°ç½‘ç»œã€å½’å±ä»£ç†ã€å¤–åœ°ä»£ç†ã€è½¬äº¤åœ°å€ã€åŒå€è½¬äº¤åœ°å€ç­‰ã€‚ ç§»åŠ¨IPä½¿ç”¨äº†å‡ ç§åè®®ï¼Œå¦‚ç§»åŠ¨ç«™åˆ°å¤–åœ°ä»£ç†çš„åè®®ï¼Œå¤–åœ°ä»£ç†åˆ°å½’å±ä»£ç†çš„ç™»è®°åè®®ï¼Œå½’å±ä»£ç†æ•°æ®æŠ¥å°è£…åè®®ï¼Œå¤–åœ°ä»£ç†æ‹†å°åè®®ç­‰ã€‚ ç§»åŠ¨IPçš„è·¯ç”±é€‰æ‹©æœ‰é—´æ¥è·¯ç”±é€‰æ‹©å’Œç›´æ¥è·¯ç”±é€‰æ‹©ï¼Œåè€…éœ€è¦ä½¿ç”¨é€šä¿¡è€…ä»£ç†å’Œé”šå¤–åœ°ä»£ç†ã€‚ èœ‚çªç§»åŠ¨é€šä¿¡ç½‘ä¸­å¯¹ç§»åŠ¨ç”¨æˆ·çš„è·¯ç”±é€‰æ‹©éœ€è¦å¼„æ¸…ä¸€äº›æ¦‚å¿µ:å½’å±ä½ç½®å¯„å­˜å™¨HLRå’Œæ¥è®¿ç”¨æˆ·ä½ç½®å¯„å­˜å™¨VLRï¼Œç§»åŠ¨ç«™æ¼«æ¸¸å·ç MSRNï¼Œå½’å±ç½‘ç»œäº¤æ¢ä¸­å¿ƒï¼Œå½’å±MSCï¼Œé”šMSCï¼Œè¢«è®¿ç½‘ç»œçš„MSCã€‚","categories":[{"name":"è¯»ä¹¦","slug":"è¯»ä¹¦","permalink":"https://bigporo.github.io/categories/è¯»ä¹¦/"}],"tags":[{"name":"åŸºæœ¬åŠŸ","slug":"åŸºæœ¬åŠŸ","permalink":"https://bigporo.github.io/tags/åŸºæœ¬åŠŸ/"},{"name":"è¯»ä¹¦","slug":"è¯»ä¹¦","permalink":"https://bigporo.github.io/tags/è¯»ä¹¦/"}]}]}